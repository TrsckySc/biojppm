/*!
 * 参照jeesite平台(https://gitee.com/thinkgem/jeesite4)
 * J2eeFAST 二次修改
 * @version v1.0.2
 */
if(typeof jQuery==="undefined"){throw new Error("fastJS JavaScript requires jQuery")}(function(d){var c=function(R,H){var u=d.extend({},d.fn.webUploadex.defaults,H||{});var o=u.id,z="image"==u.uploadType,l=d("#"+o+"_Uploader"),t=l.find("#"+o+"_fileLists"),k=function(w){if(d.i18n==="undefined"){return w}return d.i18n.prop(w)};if(z){t.appendTo(l.find(".queueList"))}else{var n=u.tipTitle;var D='<thead id="'+o+'_thead" style="display: none">'+(n!=""?('<tr style="background-color: white"><th colspan="5">'+n+"</th></tr>"):"")+'<tr style="border-top: 1px solid rgb(221, 221, 221);">'+'<th style="width: 300px;max-width: 400px; text-align: left;">'+k("\u6587\u4EF6\u540D\u79F0")+"</th>"+'<th style="width: 100px;text-align: center">'+k("\u6587\u4EF6\u5927\u5C0F")+"</th>"+'<th style="text-align: center">'+k("\u4E0A\u4F20\u8FDB\u5EA6")+"</th>"+'<th style="text-align: center">'+k("\u4FE1\u606F")+"</th>"+'<th style="text-align: center; width: 300px;">'+k("\u64CD\u4F5C")+"</th>"+"</tr>"+"</thead>";t.before(D)}var E=l.find(".statusBar"),h=E.find(".info"),y=l.find(".uploadBtn"),T=l.find(".placeholder"),O=E.find(".progress").hide(),j=d("#"+o+"_thead"),G=0,s=0,C=window.devicePixelRatio||1,e=110*C,B=110*C,M="pedding",S={};C=function(){try{var A=navigator.plugins["Shockwave Flash"];A=A.description}catch(x){try{A=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(w){A="0.0"}}A=A.match(/\d+/g);return parseFloat(A[0]+"."+A[1],10)}();var q=function(){var w=document.createElement("p").style;return"transition" in w||"WebkitTransition" in w||"MozTransition" in w||"msTransition" in w||"OTransition" in w}(),K=[],m=[],J=[],r=[];if("false"===u.preview){u.preview=""}if(WebUploader.browser.ie&&!WebUploader.Uploader.support("flash")){C?function(w){window.expressinstallcallback=function(P){switch(P){case"Download.Cancelled":alert(f("\u5B89\u88C5\u5931\u8D25!"));break;case"Download.Failed":alert(f("\u5B89\u88C5\u5931\u8D25!"));break;default:alert(f("\u5B89\u88C5\u5DF2\u6210\u529F\uFF0C\u8BF7\u5237\u65B0!"))}delete window.expressinstallcallback};var x=baseURL+"/static/plugins/webuploader/0.1.5/expressInstall.swf",A='<object type="application/x-shockwave-flash" data="'+x+'" ';WebUploader.browser.ie&&(A+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');w.html(A+('width="100%" height="100%" style="outline:0"><param name="movie" value="'+x+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>'))}(l):l.html('<a href="http://www.adobe.com/go/getflashplayer" target="_blank" border="0">'+'<img alt="get flash player" src="http://www.adobe.com/macromedia/style_guide/images/160x41_Get_Flash_Player.jpg" /></a>')}else{if(typeof WebUploader==="undefined"){throw new Error("WebUploader \u5BF9\u8C61\u4E3A\u7A7A,\u8BF7\u68C0\u67E5\u662F\u5426\u5F15\u5165!")}if(WebUploader.Uploader.support()){R={disableGlobalDnd:true,swf:baseURL+"/static/plugins/webuploader/0.1.5/Uploader.swf",server:u.service.upload,id:o,imageFlag:z,formData:{bizId:u.bizId,bizType:u.bizType,uploadType:u.uploadType,imageMaxWidth:u.imageMaxWidth,imageMaxHeight:u.imageMaxHeight,chunkSize:u.chunkSize,__ajax:"json"},chunked:u.chunked,chunkSize:u.chunkSize,threads:u.threads,fileNumLimit:u.maxUploadNum,fileSingleSizeLimit:u.maxFileSize,compress:false};d.each(u.extendParams,function(w,x){H.formData["extend["+w+"]"]=x});u.readonly||(H=d.extend(true,{},{pick:{id:"#"+o+"_filePicker",label:k("\u70B9\u51FB\u9009\u62E9\u6587\u4EF6"),multiple:1<u.maxUploadNum},dnd:"#"+o+"_Uploader .queueList",paste:"#"+o+"_Uploader .queueList"},R),"image"==u.uploadType?(H.pick.label=k("\u70B9\u51FB\u9009\u62E9\u56FE\u7247"),H.accept={title:"Images",extensions:u.imageAllowSuffixes.replace(/\./g,""),mimeTypes:"image/*"}):"media"==u.uploadType?(H.pick.label=k("\u70B9\u51FB\u9009\u62E9\u89C6\u9891"),H.accept={title:"Medias",extensions:u.mediaAllowSuffixes.replace(/\./g,""),mimeTypes:"*/*"}):H.accept="file"==u.uploadType?{title:"Files",extensions:u.fileAllowSuffixes.replace(/\./g,""),mimeTypes:"*/*"}:{title:"All",extensions:(u.imageAllowSuffixes+","+u.mediaAllowSuffixes+","+u.fileAllowSuffixes).replace(/\./g,""),mimeTypes:"*/*"});R.uploaderOptions=H;if("function"==typeof u.callback){u.callback(u.id,"create",R)}console.log("\u6570\u636E:"+R.uploaderOptions);var v=WebUploader.create(R.uploaderOptions);window.webuploader||(window.webuploader=[]);window.webuploader.push(v);R.uploader=v;R.options=u;window.webuploaderRefresh||(window.webuploaderRefresh=function(){setTimeout(function(){window.webuploader||(window.webuploader=[]);for(var w in window.webuploader){window.webuploader[w].refresh()}},200)});v.addButton({id:"#"+o+"_filePicker2",label:k("\u7EE7\u7EED\u6DFB\u52A0")});if(u.isLazy){y.hide()}v.on("uploadBeforeSend",function(w,x,A){if(d('meta[name="csrf-token"]').attr("content")){A["X-CSRF-Token"]=d('meta[name="csrf-token"]').attr("content")}});v.on("uploadProgress",function(P,w){if(z){var A=d("#"+o+P.id);var x=A.find(".progress span");x.css("width",100*w+"%")}else{var A=d("#"+o+P.id).find(".prog_bar");var x=A.find(".progress-bar");x.css("width",Math.round(100*w)+"%"),x.text(Math.round(100*w)+"%")}if("undefined"==typeof S[P.id]){S[P.id]=[P.size,0]}S[P.id][1]=w;p()});v.on("beforeFileQueued",function(w){if(G>u.maxUploadNum){opt.error(k("\u60A8\u53EA\u80FD\u4E0A\u4F20"+u.maxUploadNum+"\u4E2A\u6587\u4EF6"));
    return false}});v.on("fileDequeued",function(w){L(w)});v.on("uploadAccept",function(U,w,V){U=d("#"+o+U.file.id);try{var A=JSON.parse(w._raw||w);opt.variable.web_status.SUCCESS!=A.code&&V(A.code);if(z){d('<p class="'+(opt.variable.web_status.SUCCESS!=A.code?"error":"success")+'" title="'+A.msg+'">'+A.msg+"</p>").appendTo(U)}else{var x=opt.variable.web_status.SUCCESS==A.code?"success":"danger";U.find(".msg").html('<span class="label label-sm label-'+x+'" title="'+A.msg+'">'+A.msg+"</span>")}}catch(P){z?d('<p class="error">'+k("\u670D\u52A1\u5668\u8FD4\u56DE\u51FA\u9519")+"</p>").appendTo(U):U.find(".msg").html('<span class="label label-sm label-danger">'+k("\u670D\u52A1\u5668\u8FD4\u56DE\u51FA\u9519")+"</span>")}});v.on("uploadError",function(w,x){console.log(w.fileUpload);w.fileUpload&&(0<t.find("[fileMd5="+w.md5+"]").length?z?t.find("#"+o+w.id+" .error").html(k("\u4E0D\u8981\u9009\u62E9\u91CD\u590D\u6587\u4EF6")):t.find("#"+o+w.id+" .msg .label").html(k("\u4E0D\u8981\u9009\u62E9\u91CD\u590D\u6587\u4EF6")):(v.removeFile(w),R.refreshFileList([w.fileUpload],false)))});v.on("fileQueued",function(U){G++;s+=U.size;console.log(G);if(0!==G||u.readonly){E.show()}var Y="";if(z){Y=d('<li id="'+o+U.id+'"><p class="title">'+U.name+'</p><p class="imgWrap"></p><p class="progress"><span></span></p><p class="error"></p><div class="file-panel"><span class="cancel">'+k("\u5220\u9664")+"</span></div></li>");var w=Y.find("div.file-panel"),W=Y.find("p.progress-bar"),X=Y.find("p.imgWrap"),x=Y.find("p.error");if("invalid"===U.getStatus()){F(x,U.statusText)}else{x.text(k("\u7B49\u5F85\u4E0A\u4F20"));X.text(k("\u9884\u89C8\u751F\u6210\u4E2D"));v.makeThumb(U,function(aa,Z){if(aa){X.text(k("\u4E0D\u80FD\u9884\u89C8"))}else{aa=d('<img src="'+Z+'">');X.empty().append(aa)}});S[U.id]=[U.size,0];U.rotation=0}U.on("statuschange",function(Z,aa){"progress"===aa&&W.hide().width(0);"error"===Z||"invalid"===Z?(F(x,U.statusText),S[U.id][1]=1):"interrupt"===Z?F(x,"interrupt"):"queued"===Z?S[U.id][1]=0:"progress"===Z&&(x.text(k("\u6B63\u5728\u4E0A\u4F20")+"..."),W.css("display","block"));Y.removeClass("state-"+aa).addClass("state-"+Z)});Y.on("mouseenter",function(){w.stop().animate({height:30})});Y.on("mouseleave",function(){w.stop().animate({height:0})});w.on("click","span",function(){switch(d(this).index()){case 0:var Z=d(this);opt.modal.confirm(k("\u786E\u5B9A\u5220\u9664\u8BE5\u56FE\u7247\u5417\uFF1F"),function(){i(Z);v.removeFile(U)});return;case 1:U.rotation+=90;break;case 2:U.rotation-=90}if(q){var aa="rotate("+U.rotation+"deg)";X.css({"-webkit-transform":aa,"-mos-transform":aa,"-o-transform":aa,transform:aa})}else{X.css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(U.rotation/90%4+4)%4+")")}})}else{j.show();Y=d('<tr id="'+o+U.id+'" class="template-upload">'+'<td class="name"><i class="fa fa-file-text-o"></i>'+U.name+"</td>"+'<td class="size">'+WebUploader.formatSize(U.size)+"</td>"+'<td class="prog_bar"><p class="progress"><span class="progress-bar">0%</span></p></td>'+'<td class="msg"></td><td class="btncancel"><a class="btn btn-default btn-xs yellow delete"><i class="fa fa-ban"></i> '+k("\u5220\u9664")+" </a></td>"+"</tr>");var A=Y.find("td.btncancel");var V=Y.find("td.progress-bar");var P=Y.find("td.msg");"invalid"===U.getStatus()?F(P,U.statusText):(P.text(k("\u7B49\u5F85\u4E0A\u4F20")),S[U.id]=[U.size,0],U.rotation=0);Y.on("statuschange",function(Z,aa){"error"===Z||"invalid"===Z?(F(P,U.statusText),S[b.id][1]=1,V.text("0%").css("width","0%")):"interrupt"===Z?(F(P,"interrupt"),V.text("0%").css("width","0%")):"progress"===Z&&(P.text(f("\u6B63\u5728\u4E0A\u4F20")+"..."),V.css("display","block"));Y.removeClass("state-"+aa).addClass("state-"+Z)}),A.on("click","a.delete",function(){var Z=d(this);opt.modal.confirm(k("\u786E\u5B9A\u5220\u9664\u8BE5\u6587\u4EF6\u5417?"),function(){i(Z);v.removeFile(U)})})}Y.appendTo(t);N("ready");p();if(u.isLazy){v.upload()}});v.on("uploadSuccess",function(U,A){var x=d("#"+o+U.id);var P=x.find(".progress-bar");try{var A=JSON.parse(A._raw||A);if(opt.variable.web_status.SUCCESS==A.code){var X=u.service.download+"?fileId="+A.id,w=u.returnPath?"":u.service.download+"?fileId="+A.id,W=baseURL+"/sys/comm/fileUploadView"+"?fileId="+A.id;z?(x.find(".imgWrap img").attr("src",X),x.find(".file-panel .cancel").attr("fileUploadId",A.id).attr("fUrl",W).attr("fileUrl",X).attr("fileName",A.fileName).attr("fileSize",A.fileSize).attr("fileMd5",A.fileMd5)):(""!=u.preview?x.find(".name").html('<i class="fa fa-file-text-o"></i><a class="preview" href="javascript:">'+A.fileName+"</a>"):x.find(".name").html('<i class="fa fa-file-text-o"></i><a target="_blank" href="'+w+'">'+A.fileName+"</a>"),x.find(".btncancel").empty().append((""!=u.preview?'<a class="btn btn-default btn-xs preview" href="javascript:"><i class="fa fa-eye"></i> '+k("\u9884\u89C8")+"</a> &nbsp;":"")+'<a class="btn btn-danger btn-xs delete" fileUploadId="'+A.id+'" fileUrl="'+""+'" fileName="'+A.fileName+'" fileSize="'+U.size+'" fUrl="'+W+'" fileMd5="'+A.fileMd5+'"><i class="fa fa-trash-o"></i> '+k("\u5220\u9664")+'</a> &nbsp;<a class="btn btn-info btn-xs" target="_blank" href="'+w+'" ><i class="fa fa-download"></i> '+k("\u4E0B\u8F7D")+"</a>"));g(A.id,A.path,A.fileName)}else{P.css("width","0%").text("0%")}}catch(V){P.css("width","0%").text("0%");console.log(V)}I()});v.on("error",function(w){console.log("ERROR:"+w);switch(w){case"Q_TYPE_DENIED":w=k("\u6587\u4EF6\u7C7B\u578B\u4E0D\u5BF9");
    break;case"F_EXCEED_SIZE":w=k("\u6587\u4EF6\u5927\u5C0F\u8D85\u51FA");break;case"F_DUPLICATE":w=k("\u4E0D\u8981\u9009\u62E9\u91CD\u590D\u6587\u4EF6");break;case"Q_EXCEED_NUM_LIMIT":w=k("\u60A8\u53EA\u80FD\u4E0A\u4F20"+u.maxUploadNum+"\u4E2A\u6587\u4EF6");break;case"Q_EXCEED_SIZE_LIMIT":w=k("\u6587\u4EF6\u5927\u5C0F\u8D85\u51FA");break;default:w=k("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}opt.modal.error(w)});v.on("all",function(x,w){switch(x){case"uploadFinished":N("confirm");break;case"startUpload":N("uploading");break;case"stopUpload":N("paused")}});y.on("click",function(){if(d(this).hasClass("disabled")){return false}"ready"===M?v.upload():"paused"===M?v.upload():"uploading"===M&&v.stop()});h.on("click",".retry",function(){v.retry();return false});h.on("click",".ignore",function(){var x,A=v.getFiles("error");for(var w=0;x=A[w++];){v.removeFile(x)}N("finish");p();return false});t.sortable&&(z?t.sortable({connectWith:"li",handle:".imgWrap img",placeholder:"sort-highlight",forcePlaceholderSize:!0,zIndex:999999,update:function(w,x){Q(t.find("li .file-panel .cancel"))}}):t.sortable({connectWith:"tr",handle:".name i",placeholder:"sort-highlight",forcePlaceholderSize:!0,zIndex:999999,update:function(w,x){Q(t.find("tr .btncancel .delete"))}}));if("true"==u.preview){t.on("click",".imgWrap img, a.preview",function(){var x=d(this);x="IMG"==x.prop("tagName")?x.closest("li").find(".file-panel .cancel"):x.closest("tr").find(".btncancel .delete");var w=baseURL+"sys/component/fileViwe?fileName="+opt.common.encodeUrl(x.attr("fileName"))+"&fileUrl="+opt.common.encodeUrl(x.attr("fUrl"));opt.layer?opt.layer.open({type:2,maxmin:false,shadeClose:true,title:false,area:[d(top.window).width()-200+"px",d(top.window).height()-50+"px"],content:w}):opt.modal.windowOpen(w)})}else{if(z){t.on("click",".imgWrap img",function(){var w=d(this).attr("src");0==d("#outerdiv").length&&d('<div id="outerdiv" style="position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:99999;width:100%;height:100%;display:none;"><div id="innerdiv" style="position:fixed;"><img id="bigimg" style="border:2px solid #fff;" src="" /></div></div>').appendTo(document.body);d("#bigimg").attr("src",w);d("<img/>").attr("src",w).load(function(){var x=d(window).width(),W=d(window).height(),V=this.width,P=this.height;if(P>0.8*W){var U=0.8*W;var A=U/P*V;A>0.8*x&&(A=0.8*x)}else{V>0.8*x?(A=0.8*x,U=A/V*P):(A=V,U=P)}d("#bigimg").css("width",A);x=(x-A)/2;W=(W-U)/2;d("#innerdiv").css({top:W,left:x});d("#outerdiv").fadeIn("fast")});d("#outerdiv").click(function(){d(this).fadeOut("fast")})})}}R.refreshFileList=function(A,V){V&&(t.empty(),s=G=0,K=[],J=[],r=[]);if(A&&0<A.length){for(V=0;V<A.length;V++){var x=A[V],w=x.filePath,P=u.returnPath?w:u.service.download+"?fileId="+x.id,U=baseURL+"sys/comm/fileUploadView"+"?fileId="+x.id;if(z){var W=d('<li id="'+x.id+'"><p class="title"><a target="_blank" href="'+P+'">'+x.fileName+'</a></p><p class="imgWrap"><img src="'+P+'"/></p><p class="progress"><span></span></p><div class="file-panel"><span class="cancel '+(u.readonly?"hide":"")+'" fileUploadId="'+x.id+'" fileUrl="'+w+'" fUrl="'+U+'" fileName="'+x.fileName+'" fileSize="'+x.fileSize+'" fileMd5="'+x.fileMd5+'">'+k("\u5220\u9664")+"</span></div>"+(x.message?x.message:"")+"</li>");W.on("mouseenter",function(){var X=d(this).index();t.find(".file-panel").eq(X).stop().animate({height:30})});W.on("mouseleave",function(){var X=d(this).index();t.find(".file-panel").eq(X).stop().animate({height:0})});W.on("click","span",function(){var X=d(this),ab=d(this).closest("li"),aa=d(this).parent().data("fileRotation");aa||(aa=0);switch(X.index()){case 0:if(!u.readonly){var Z=d(this);opt.modal.confirm(k("\u786E\u5B9A\u5220\u9664\u8BE5\u56FE\u7247\u5417\uFF1F"),function(ac){i(Z);u.returnPath?L({id:0,size:0}):(ac=Z.attr("fileSize"),L({id:0,size:ac}));ab.remove()})}return;case 1:aa+=90;break;case 2:aa-=90}X=d(this).parent().parent().index();X=t.find(".imgWrap :eq("+X+")");if(q){var Y="rotate("+aa+"deg)";X.css({"-webkit-transform":Y,"-mos-transform":Y,"-o-transform":Y,transform:Y})}else{X.css("filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(aa/90%4+4)%4+")")}d(this).parent().data("fileRotation",aa)})}else{var W=d('<tr id="'+x.id+'" class="template-upload"><td class="name"><i class="fa fa-file-text-o"></i>'+x.fileName+'</td><td class="size">'+(u.returnPath?"":WebUploader.formatSize(x.fileSize))+'</td><td class="prog_bar">'+(x.progress?x.progress:x.createBy?x.createBy:"")+'</td><td class="msg">'+(x.message?x.message:x.createTime?x.createTime:"")+'</td><td class="btncancel">'+(""!=u.preview?'<a class="btn btn-default btn-xs preview" href="javascript:"><i class="fa fa-eye"></i> '+k("\u9884\u89C8")+"</a> &nbsp;":"")+'<a class="btn btn-danger btn-xs delete'+(u.readonly?" hide":"")+'" fileUploadId="'+x.id+'" fileUrl="'+w+'" fUrl="'+U+'" fileName="'+x.fileName+'" fileSize="'+x.fileSize+'" fileMd5="'+x.fileMd5+'"><i class="fa fa-trash-o"></i> '+k("\u5220\u9664")+" </a>"+(u.readonly?"":" &nbsp;")+'<a class="btn btn-info btn-xs blue" onclick="opt.common.downLoadFile(\''+P+'\')" href="javascript:"><i class="fa fa-download"></i> '+k("\u4E0B\u8F7D")+" </a></td></tr>");""!=u.preview?W.find(".name").html('<i class="fa fa-file-text-o"></i><a class="preview" href="javascript:">'+x.fileName+"</a>"):W.find(".name").html('<i class="fa fa-file-text-o"></i><a  onclick="opt.common.downLoadFile(\''+P+'\')" href="javascript:">'+x.fileName+"</a>");
    W.on("click","a.delete",function(){var X=d(this),Y=d(this).closest("tr");opt.modal.confirm(k("\u786E\u5B9A\u5220\u9664\u8BE5\u6587\u4EF6\u5417\uFF1F"),function(Z){i(X);u.returnPath?L({id:0,size:0}):(Z=X.attr("fileSize"),L({id:0,size:Z}));Y.remove()})})}G++;s+=x.fileSize;t.append(W);g(x.id,w,x.fileName)}}if(0<K.length||0<J.length){u.readonly||E.show(),N("ready")}p();"function"==typeof u.callback&&u.callback(u.id,"ready",R)};R.refreshFileListByBizData=function(){console.log("--URL:"+u.service.fileList+(-1==u.service.fileList.indexOf("?")?"?":"&")+"__t="+(new Date).getTime());d.ajax({url:u.service.fileList+(-1==u.service.fileList.indexOf("?")?"?":"&")+"__t="+(new Date).getTime(),data:{bizId:u.bizId,bizType:u.bizType},xhrFields:{withCredentials:!0},dataType:"json",success:function(w){opt.variable.web_status.SUCCESS===w.code&&R.refreshFileList(w.fileList,true)}})};""!=u.bizId&&""!=u.bizType?R.refreshFileListByBizData():u.returnPath&&R.refreshFileListByPath();return R}else{opt.modal.error(k("\u6587\u4EF6\u4E0A\u4F20\u7EC4\u4EF6\u4E0D\u652F\u6301\u60A8\u7684\u6D4F\u89C8\u5668\uFF0C\u8BF7\u4F7F\u7528\u9AD8\u7248\u672C\u6D4F\u89C8\u5668!"))}function I(){var x=v.getStats();var w="";if("confirm"===M&&x.uploadFailNum){w=x.uploadFailNum+k(z?"\u5F20\u56FE\u7247":"\u4E2A\u6587\u4EF6")+k("\u4E0A\u4F20\u5931\u8D25")+', <a class="retry" href="#">'+k("\u91CD\u65B0\u4E0A\u4F20")+"</a>"+k("\u6216")+'<a class="ignore" href="#">'+k("\u5FFD\u7565")+"</a>"}else{"confirm"===M||"ready"===M?w=z?d.i18n.prop("\u603B\u5171{0}\u5F20\u56FE\u7247",G):d.i18n.prop("\u603B\u5171{0}\u4E2A\u6587\u4EF6",G)+(0>=s?"":"\uFF08"+WebUploader.formatSize(s)+"\uFF09"):(w=z?d.i18n.prop("\u5DF2\u4E0A\u4F20{0}\u5F20\u56FE\u7247",G):d.i18n.prop("\u5DF2\u4E0A\u4F20{0}\u4E2A\u6587\u4EF6",G)+(0>=s?"":"\uFF08"+WebUploader.formatSize(s)+"\uFF09"),x.uploadFailNum&&(w+=", "+k("\u5931\u8D25"+x.uploadFailNum+"\u4E2A")))}h.html(w);G<u.maxUploadNum?d("#"+o+"_filePicker2").show():d("#"+o+"_filePicker2").hide();window.webuploaderRefresh()}function N(w){if(w!==M){y.removeClass("state-"+M);y.addClass("state-"+w);M=w;switch(M){case"pedding":T.removeClass("element-invisible");t.hide();j.hide();E.addClass("element-invisible");break;case"ready":T.addClass("element-invisible");d("#"+o+"_filePicker2").removeClass("element-invisible");t.show();j.show();E.removeClass("element-invisible");break;case"uploading":d("#"+o+"_filePicker2").addClass("element-invisible");O.show();y.text(k("\u6682\u505C\u4E0A\u4F20"));break;case"paused":O.show();y.text(k("\u7EE7\u7EED\u4E0A\u4F20"));break;case"confirm":O.hide();d("#"+o+"_filePicker2").removeClass("element-invisible");y.text(k("\u5F00\u59CB\u4E0A\u4F20"));w=v.getStats();if(w.successNum&&!w.uploadFailNum){N("finish");return}break;case"finish":w=v.getStats(),w.successNum||(M="done")}I()}}function g(P,x,A){if(""!=u.bizType){K.push(P);d("#"+o).val(K.join(",")).change();try{d("#"+o).resetValid()}catch(w){}}if(u.returnPath){J.push(P);r.push(A);d("#"+u.filePathInputId).val(J.join("|")).change();d("#"+u.fileNameInputId).val(r.join("|")).change();try{d("#"+u.filePathInputId).resetValid()}catch(w){}try{d("#"+u.fileNameInputId).resetValid()}catch(w){}}"function"==typeof u.callback&&u.callback(u.id,"addFile",R,P,x,A)}function p(){var w=0,A=0,x=0,P=O.children();d.each(S,function(U,V){x+=V[0];w+=V[0]*V[1]});A=x?w/x:0;P.eq(0).text(Math.round(100*A)+"%");P.eq(1).css("width",Math.round(100*A)+"%");I()}function i(P){var w=P.attr("fileUploadId"),A=P.attr("fileUrl");P=P.attr("fileName");if(w&&null!=w){if(""!=u.bizType){K.splice(d.inArray(w,K),1);m.push(w);d("#"+o).val(K.join(","));d("#"+o+"__del").val(m.join(","));try{d("#"+o).resetValid()}catch(x){}try{d("#"+o+"__del").resetValid()}catch(x){}}if(u.returnPath){J.splice(d.inArray(A,J),1);r.splice(d.inArray(P,r),1);d("#"+u.filePathInputId).val(J.join("|"));d("#"+u.fileNameInputId).val(r.join("|"));try{d("#"+u.filePathInputId).resetValid()}catch(x){}try{d("#"+u.fileNameInputId).resetValid()}catch(x){}}}"function"==typeof u.callback&&u.callback(u.id,"delFile",R,w,A,P)}function Q(w){if(""!=u.bizType){K=[];w.each(function(){K.push(a(this).attr("fileUploadId"))});d("#"+o).val(K.join(",")).change();try{d("#"+o).resetValid()}catch(x){}}if(u.returnPath){J=[];r=[];w.each(function(){J.push(a(this).attr("fileUrl"));r.push(a(this).attr("fileName"))});d("#"+u.filePathInputId).val(J.join("|")).change();d("#"+u.fileNameInputId).val(r.join("|")).change();try{a("#"+u.filePathInputId).resetValid()}catch(x){}try{a("#"+u.fileNameInputId).resetValid()}catch(x){}}}function L(w){G--;G||N("pedding");s-=w.size;delete S[w.id];p();z?d("#"+o+w.id).off().find(".file-panel").off().end().remove():d("#"+o+w.id).off().find(".btncancel").off().end().remove()}function F(x,w){switch(w){case"exceed_size":w=k("\u6587\u4EF6\u5927\u5C0F\u8D85\u51FA");break;case"interrupt":w=k("\u6587\u4EF6\u4F20\u8F93\u4E2D\u65AD");break;case"http":w=k("HTTP\u8BF7\u6C42\u9519\u8BEF");break;case"not_allow_type":w=k("\u6587\u4EF6\u683C\u5F0F\u4E0D\u5141\u8BB8");break;default:w=k("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}if(w!=null){z?x.text(w):x.html('<span class="label label-sm label-danger">'+a+"</span>")}}}};window.webuploaderRegister||(window.webuploaderRegister=!0,WebUploader.Uploader.register({name:"fileupload","before-send-file":"beforeSendFile","before-send":"beforeSend","after-send-file":"afterSendFile"},{beforeSendFile:function(j){var i=this.owner,h=WebUploader.Deferred();i.md5File(j,0,10485760).then(function(e){j.md5=e;h.resolve()});return h.promise()},beforeSend:function(g){var h=this.owner;g=g.file;console.log("fileMd5:"+g.md5);h.options.formData.fileMd5=g.md5;
        h.options.formData.fileName=g.name},afterSendFile:function(e){}}),d("textarea").each(function(){var g=d(this);g.data("x",g.outerWidth());g.data("y",g.outerHeight());g.mouseup(function(){var h=d(this);h.outerWidth()==h.data("x")&&h.outerHeight()==h.data("y")||window.webuploaderRefresh();h.data("x",h.outerWidth());h.data("y",h.outerHeight())})}));d.fn.webUploadex=function(g,k){var i,j=d(this),h=j.data("webuploader.ui.ex"),e="object"===typeof g&&g;h||(h=new c(j,e),j.data("webuploader.ui.ex",h));"string"===typeof g&&"function"===typeof h[g]&&(i=k instanceof Array?h[e].apply(h,k):h[g](k));return i};d.fn.webUploadex.defaults={id:"",bizId:"",bizType:"",readonly:false,returnPath:false,filePathInputId:"",fileNameInputId:"",uploadType:"",imageAllowSuffixes:".gif,.bmp,.jpeg,.jpg,.ico,.png,.tif,.tiff,",mediaAllowSuffixes:".flv,.swf,.mkv,webm,.mid,.mov,.mp3,.mp4,.m4v,.mpc,.mpeg,.mpg,.swf,.wav,.wma,.wmv,.avi,.rm,.rmi,.rmvb,.aiff,.asf,.ogg,.ogv,",fileAllowSuffixes:".doc,.docx,.rtf,.xls,.xlsx,.csv,.ppt,.pptx,.pdf,.vsd,.txt,.md,.xml,.rar,.zip,7z,.tar,.tgz,.jar,.gz,.gzip,.bz2,.cab,.iso,",maxFileSize:104857600,maxUploadNum:300,imageMaxWidth:1024,imageMaxHeight:768,service:{upload:baseURL+"/sys/comm/upload",download:baseURL+"/sys/comm/download",fileList:baseURL+"/sys/comm/fileList"},tipTitle:"",extendParams:{},chunked:false,chunkSize:10485760,threads:3,isLazy:false,preview:""}})(jQuery);