/*!
 * 表格封装处理
 * Copyright (c) 2020-Now http://www.j2eefast.com All rights reserved.
 * No deletion without permission
 * @author ZhouZhou
 */
(function(a){a.extend({table:{init:function(c){var g={formId:"",id:"bootstrap-table",type:0,height:undefined,sidePagination:"server",sortName:"",sortOrder:"desc",pagination:true,pageSize:50,pageList:[50,100,150],showCheckNumber:false,toolbar:"toolbar",showToolbar:true,striped:false,escape:true,outcheckbox:true,firstLoad:true,subtotalShowFooter:false,rowTotal:undefined,undefinedText:"-",emptyText:"-",search:false,showSearch:false,showPageGo:true,showRefresh:false,showColumns:true,resizable:false,showToggle:false,cardView:false,showCustomView:false,showExport:false,exportData:undefined,clickToSelect:true,singleSelect:false,paginationLoop:true,onSelectData:undefined,showPage:true,mobileResponsive:true,rememberSelected:true,_total:false,showPaginationSwitch:false,fixedColumns:false,onlyInfoPagination:false,fixedNumber:0,rightFixedColumns:false,totalFooterHeight:undefined,subtotalRowStyle:undefined,totalFooterRowStyle:undefined,rightFixedNumber:0,queryParams:a.table.queryParams,totalData:undefined,_totalColumns:[],rowStyle:{},showBorder:false,isFixedColumn:false};if(c.resizable){try{if(0!==_ColResizable){opt.error("\u6A21\u677F\u5F15\u64CE\u7F3A\u5C11\u5F15\u5165\u8868\u683C\u62D6\u52A8Libs['resizable']");return}}catch(f){opt.error("\u6A21\u677F\u5F15\u64CE\u7F3A\u5C11\u5F15\u5165\u8868\u683C\u62D6\u52A8Libs['resizable']");return}}var c=a.extend(g,c);if(c.outcheckbox&&(!opt.common.isEmpty(a("#"+c.toolbar+"-"+c.id+" .multiple").html())||!opt.common.isEmpty(a("#"+c.toolbar+"-"+c.id+" .single").html()))){var h=false;if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(c.columns[d] instanceof Array){for(var b=0;b<c.columns[d].length;b++){if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"checkbox"))){h=true;break}}if(h){break}}else{if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"checkbox"))){h=true;break}}}}if(!h){if(c.columns[0] instanceof Array){c.columns[c.columns.length-1].splice(0,0,{checkbox:true,field:"_state"})}else{c.columns.splice(0,0,{checkbox:true,field:"_state"})}}}if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(c.columns[0] instanceof Array){for(var b=0;b<c.columns[d].length;b++){if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"align"))){c.columns[d][b].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"halign"))){c.columns[d][b].halign="center"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"checkbox"))){c.columns[d][b].field="_state"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"radio"))){c.columns[d].field="_state"}}}else{if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"align"))){c.columns[d].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"halign"))){c.columns[d].halign="center"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"checkbox"))){c.columns[d].field="_state"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"radio"))){c.columns[d].field="_state"}}}}opt.table.options=c;opt.table.config[c.id]=c;a.table.initEvent();a("#"+c.id).bootstrapTable({id:c.id,url:c.url,contentType:"application/x-www-form-urlencoded",method:"post",cache:false,height:c.height,striped:c.striped,sortable:true,sortStable:true,sortName:c.sortName,sortOrder:c.sortOrder,pagination:c.pagination,paginationLoop:c.paginationLoop,undefinedText:c.undefinedText,emptyText:c.emptyText,showPaginationSwitch:c.showPaginationSwitch,pageNumber:1,pageSize:c.pageSize,showCustomView:c.showCustomView,customViewFormatter:c.customViewFormatter,pageList:c.pageList,showCheckNumber:c.showCheckNumber,firstLoad:c.firstLoad,isFixedColumn:c.isFixedColumn,escape:c.escape,subtotalShowFooter:c.subtotalShowFooter,rowTotal:c.rowTotal,subtotalRowStyle:c.subtotalRowStyle,subtotalFooterStyle:c.subtotalFooterStyle,totalShowFooter:c.totalShowFooter,totalFooterRowStyle:c.totalFooterRowStyle,totalFooterHeight:c.totalFooterHeight,totalFooterStyle:c.totalFooterStyle,iconSize:"outline",toolbar:c.showToolbar?("#"+c.toolbar+"-"+c.id):null,sidePagination:c.sidePagination,onlyInfoPagination:c.onlyInfoPagination,search:c.search,showBorder:c.showBorder,showToolbar:c.showToolbar,searchText:c.searchText,showSearch:c.showSearch,showPageGo:c.showPageGo,showPage:c.showPage,showRefresh:c.showRefresh,showColumns:c.showColumns,showToggle:c.showToggle,showExport:c.showExport,cardView:c.cardView,exportData:a.table.exportData,uniqueId:c.uniqueId,clickToSelect:c.clickToSelect,singleSelect:c.singleSelect,mobileResponsive:c.mobileResponsive,onCheck:c.onCheck,onUncheck:c.onUncheck,onCheckAll:c.onCheckAll,onUncheckAll:c.onUncheckAll,onClickRow:c.onClickRow,onDblClickRow:c.onDblClickRow,onClickCell:c.onClickCell,onDblClickCell:c.onDblClickCell,onEditableSave:c.onEditableSave,onExpandRow:c.onExpandRow,rememberSelected:c.rememberSelected,fixedColumns:c.fixedColumns,fixedNumber:c.fixedNumber,resizable:c.resizable,rightFixedColumns:c.rightFixedColumns,rightFixedNumber:c.rightFixedNumber,onReorderRow:c.onReorderRow,queryParams:c.queryParams,rowStyle:c.rowStyle,columns:c.columns,responseHandler:a.table.responseHandler,onLoadSuccess:a.table.onLoadSuccess,detailView:c.detailView,detailFormatter:c.detailFormatter})},getOptionsIds:function(c){var d=opt.common.isEmpty(c)?",":c;var b="";a.each(opt.table.config,function(e,f){b+="#"+e+d});return b.substring(0,b.length-1)},queryParams:function(e){var d={__limit:e.limit,__page:e.offset/e.limit+1,searchValue:e.search,__sidx:e.sort,__order:e.order};opt.table.set(this.id);var b=opt.common.isEmpty(opt.table.options.formId)?a("form").attr("id"):opt.table.options.formId;var c={};a.each(a("#"+b).serializeArray(),function(f,g){if(c[g.name]){c[g.name]+=(","+g.value)}else{c[g.name]=g.value}});if(opt.table.options.__fromData__==undefined){opt.table.options.__fromData__=c}return a.extend(d,c)},tableTotalHtml:function(c){opt.table.set();var b="";if(!opt.common.isEmpty(opt.table.options.totalData)){return"<span>"+opt.common.getJsonValue(opt.table.options.totalData,c)+"</span>"}else{return""}},responseHandler:function(b){if(typeof opt.table.get(this.id).responseHandler=="function"){opt.table.get(this.id).responseHandler(b)}if(b.code==0){if(opt.common.isNotEmpty(opt.table.options.sidePagination)&&opt.table.options.sidePagination=="client"){return b.rows}else{if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var c=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId;a.each(b.data.list,function(e,g){if(opt.table.rememberSelectedIds[opt.table.options.id]){var j=false;for(var e=0;e<opt.table.rememberSelectedIds[opt.table.options.id].length;e++){if(opt.common.getJsonValue(g,c)==opt.table.rememberSelectedIds[opt.table.options.id][e]){j=true}}if(j){if(opt.common.isEmpty(opt.table.rememberSelecteds[opt.table.options.id])){opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,c)}else{var h=true;for(var d=0;d<opt.table.rememberSelecteds[opt.table.options.id].length;d++){if(opt.common.getJsonValue(g,c)==opt.common.getJsonValue(opt.table.rememberSelecteds[opt.table.options.id][d],c)){h=false;break}}if(h){var f=opt.table.rememberSelecteds[opt.table.options.id];opt.table.rememberSelecteds[opt.table.options.id]=_.union(f,g,c)}}}g._state=j}else{g._state=false}})}if(opt.common.isNotEmpty(opt.table.options._total)&&opt.table.options._total){opt.table.options.totalData=b.pageTotal}return{rows:b.data.list,total:b.data.totalCount}}}else{opt.modal.error(b.msg,function(){try{opt.closeItem()}catch(d){}});return{rows:[],total:0}}},initEvent:function(){var b=a.table.getOptionsIds();a(b).on(TABLE_EVENTS,function(){opt.table.set(this.id)});a(b).on("check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table",function(k,i){var c=a.table.affectedRowIds(i);if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var g=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});var d=opt.table.rememberSelectedIds[opt.table.options.id];var j=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isEmpty(d)&&opt.common.isEmpty(j)&&g.length>=1){opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,opt.table.options.uniqueId);opt.table.rememberSelectedIds[opt.table.options.id]=_.union([],a.table.affectedRowIds(g),opt.table.options.uniqueId)}if(!opt.table.options.singleSelect){var f=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId,h=a.inArray(k.type,["check","check-all"])>-1?"union":"difference";d=opt.table.rememberSelectedIds[opt.table.options.id];if(opt.common.isNotEmpty(d)){opt.table.rememberSelectedIds[opt.table.options.id]=_[h](d,c,f)}else{opt.table.rememberSelectedIds[opt.table.options.id]=_[h]([],c,f)}j=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(j)){opt.table.rememberSelecteds[opt.table.options.id]=_[h](j,i,f)}else{opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,f)}if(opt.table.options.showCheckNumber){a("#"+opt.table.options.id).bootstrapTable("setCheckNumer",opt.table.rememberSelectedIds[opt.table.options.id].length)}}else{opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,opt.table.options.uniqueId);opt.table.rememberSelectedIds[opt.table.options.id]=_.union([],a.table.affectedRowIds(g),opt.table.options.uniqueId)}}if(typeof opt.table.get(opt.table.options.id).onSelectData=="function"){if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){opt.table.get(opt.table.options.id).onSelectData(opt.table.rememberSelecteds[opt.table.options.id])}else{opt.table.get(opt.table.options.id).onSelectData(i)}}});a(b).on("check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table load-success.bs.table",function(f){var c=opt.table.options.toolbar+"-"+opt.table.options.id,g=opt.table.options.uniqueId,d=opt.common.isEmpty(g)?a.table.selectFirstColumns():a.table.selectColumns(g);a("#"+c+" .multiple").toggleClass("disabled",!d.length);a("#"+c+" .single").toggleClass("disabled",d.length!=1)});a(b).off("click").on("click",".img-circle",function(){var g=a(this).attr("src");var f=a(this).data("target");var c=a(this).data("height")=="auto"?"":a(this).data("height");var d=a(this).data("name");var e=a(this).data("width")=="auto"?"":a(this).data("width");if(opt.common.equals("self",f)){opt.modal.openView(d,g,e,c)}else{if(opt.common.equals("blank",f)){window.open(g)}}});a(b).on("click",".tooltip-show",function(){var d=a(this).data("target");var c=a(this).prev();if(opt.common.equals("open",d)){opt.selfLayer.alert(c.val(),{title:"\u4FE1\u606F\u5185\u5BB9",shadeClose:true,btn:["\u786E\u8BA4"],btnclass:["btn btn-primary"]})}})},onLoadSuccess:function(d){if(typeof opt.table.get(this.id).onLoadSuccess=="function"){opt.table.get(this.id).onLoadSuccess(d)}if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected&&opt.table.options.showCheckNumber){a("#"+this.id).bootstrapTable("setCheckNumer",opt.table.rememberSelectedIds[opt.table.options.id]?opt.table.rememberSelectedIds[opt.table.options.id].length:0)}a(".table [data-toggle='tooltip']").tooltip();if(opt.common.isNotEmpty(opt.table.options._total)&&opt.table.options._total){var b="\u6C47\u603B:&nbsp;&nbsp;";for(var c=0;c<opt.table.options._totalColumns.length;c++){b+=opt.table.options._totalColumns[c].title;b+=":";b+=opt.common.isEmpty(opt.common.getJsonValue(opt.table.options.totalData,opt.table.options._totalColumns[c].field))?"0.00":opt.common.getJsonValue(opt.table.options.totalData,opt.table.options._totalColumns[c].field)+"&nbsp;&nbsp;"}a("#_pageTotal").html(b)}a('.table [data-toggle="popover"]').popover();if(a.fn.iCheck!==undefined){a(".check-box:not(.noicheck),.radio-box:not(.noicheck)").each(function(){a(this).iCheck({checkboxClass:(typeof(a(this).data("style"))=="undefined")?"icheckbox-blue":("icheckbox_"+(a(this).data("style")||"square-blue")),radioClass:(typeof(a(this).data("style"))=="undefined")?"iradio-blue":("iradio_"+(a(this).data("style")||"square-blue"))})})}if(a(".table .time-input").length>0){a(".time-input").each(function(g,o){var e=a(o);var i=e.attr("data-type")||"date";var l=e.attr("data-format")||"yyyy-MM-dd";var h=e.attr("data-btn")||"clear|now|confirm",p=[];var n=e.attr("data-callback")||{};if(h){if(h.indexOf("|")>0){var k=h.split("|"),m=k.length;for(var f=0;f<m;f++){if("clear"===k[f]||"now"===k[f]||"confirm"===k[f]){p.push(k[f])}}}else{if("clear"===h||"now"===h||"confirm"===h){p.push(h)}}}else{p=["clear","now","confirm"]}laydate.render({elem:o,theme:"molv",trigger:"click",type:i,format:l,btns:p,done:function(q,j){if(typeof window[n]!="undefined"&&window[n] instanceof Function){window[n](q,j)}}})})}if(a.fn.select2!==undefined){a.fn.select2.defaults.set("theme","bootstrap");a("select.form-control:not(.noselect2)").each(function(){if(typeof(a(this).attr("multiple"))=="undefined"){a(this).select2()}else{a(this).select2({allowClear:true,placeholder:""})}})}a.contextMenu({selector:".table a[data-target='copy'],.table span[data-target='copy']",trigger:"right",autoHide:true,items:{copy:{name:a.i18n.prop("\u590D\u5236\u6587\u672C"),icon:"fa-copy",callback:function(g,f){var e=a(this).prev();e.select();if(document.execCommand("copy")){window.opt.modal.msg(a.i18n.prop("\u590D\u5236\u6210\u529F")+"!")}}}}})},destroy:function(c){var b=opt.common.isEmpty(c)?opt.table.options.id:c;a("#"+b).bootstrapTable("destroy");delete opt.table.rememberSelectedIds[c];delete opt.table.rememberSelecteds[c]},serialNumber:function(f,g){var b=opt.common.isEmpty(g)?opt.table.options.id:g;var e=a("#"+b).bootstrapTable("getOptions");var d=e.pageSize;var c=e.pageNumber;return d*(c-1)+f+1},dropdownToggle:function(b){var c=[];c.push('<div class="btn-group">');c.push('<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false">');c.push('<i class="fa fa-cog"></i>&nbsp;<span class="fa fa-chevron-down"></span></button>');c.push('<ul class="dropdown-menu">');c.push(b.replace(/<a/g,"<li><a").replace(/<\/a>/g,"</a></li>"));c.push("</ul>");c.push("</div>");return c.join("")},imageView:function(f,b,e,g){if(opt.common.isEmpty(e)){e="auto"}if(opt.common.isEmpty(b)){b="auto"}var c=opt.common.isEmpty(g)?"self":g;if(opt.common.isNotEmpty(f)){var d=opt.common.fileFromPath(f);return opt.common.sprintf("<img class='img-circle img-xs' data-height='%s' data-width='%s' data-target='%s' src='%s' data-name='%s'/>",b,e,c,f,d)}else{return opt.common.nullToStr(f)}},search:function(c,j,e){opt.table.set(c);var h;if(opt.common.isEmpty(j)){if(opt.common.isEmpty(opt.table.options.formId)){h=a("form").attr("id")}else{h=opt.table.options.formId}}else{h=j}var b=a("#"+h).find('a[data-toggle="formMore"]');var f=a("#"+h).find("div.select-list-more");if(opt.common.isNotEmpty(b)&&opt.common.isNotEmpty(f)&&f.css("display")){var i=f.css("display");var g=[];if(i=="block"){f.toggle("normal");g.push('<i class="fa fa-angle-double-down"></i>&nbsp;',a.i18n.prop("\u66F4\u591A"));b.empty().append(g.join(""))}}var d=opt.common.isEmpty(c)?a("#"+opt.table.options.id).bootstrapTable("getOptions"):a("#"+c).bootstrapTable("getOptions");d.queryParams=function(l){var k=opt.common.formToJSON(h);if(opt.common.isNotEmpty(e)){a.each(e,function(m){k[m]=e[m]})}k.__limit=l.limit;k.__page=l.offset/l.limit+1;k.searchValue=l.search;k.__sidx=l.sort;k.__order=l.order;return k};if(opt.common.isNotEmpty(c)){a("#"+c).bootstrapTable("refresh",d)}else{a("#"+opt.table.options.id).bootstrapTable("refresh",d)}},exportData:function(){var b;if(opt.common.isEmpty(opt.table.options.formId)){b=a("form").attr("id")}else{b=opt.table.options.formId}if(typeof opt.table.get(this.id).exportData=="function"){opt.modal.loading("\u6B63\u5728\u5BFC\u51FA\u6570\u636E\uFF0C\u8BF7\u7A0D\u540E...");opt.table.get(this.id).exportData(this.id,a("#"+b).serializeArray());window.setTimeout(function(){opt.modal.closeLoading()},500)}else{opt.table.set(this.id);if(opt.common.isEmpty(opt.table.options.exportUrl)){opt.error("\u5BFC\u51FA\u5730\u5740exportUrl\u4E3A\u7A7A,\u8BF7\u68C0\u67E5\u914D\u7F6E");return}opt.modal.confirm("\u6839\u636E\u4E0A\u65B9\u67E5\u8BE2\u5BFC\u51FA\u6570\u636E,\u786E\u5B9A\u5BFC\u51FA"+opt.table.options.modalName+"\u6570\u636E\u5417\uFF1F",function(){opt.modal.loading("\u6B63\u5728\u5BFC\u51FA\u6570\u636E\uFF0C\u8BF7\u7A0D\u540E...");var d;if(opt.common.isEmpty(opt.table.options.formId)){d=a("form").attr("id")}else{d=opt.table.options.formId}var c=a("#"+d).serializeArray();opt.common.postDownLoadFile(c,opt.table.options.exportUrl);window.setTimeout(function(){opt.modal.closeLoading()},500)})}},exportExcel:function(b){opt.table.set();opt.modal.confirm("\u786E\u5B9A\u5BFC\u51FA\u6240\u6709"+opt.table.options.modalName+"\u5417\uFF1F",function(){var c=opt.common.isEmpty(b)?a("form").attr("id"):b;opt.modal.loading("\u6B63\u5728\u5BFC\u51FA\u6570\u636E\uFF0C\u8BF7\u7A0D\u540E...");var d={type:"POST",url:opt.table.options.exportUrl,data:a("#"+c).serializeArray(),success:function(e){if(e.code==opt.variable.web_status.SUCCESS){window.location.href=baseURL+"excel/download?fileName="+encodeURI(e.msg)}else{if(e.code==opt.variable.web_status.WARNING){opt.modal.alertWarning(e.msg)}else{opt.modal.alertError(e.msg)}}opt.modal.closeLoading()}};opt.common.sendAjax(d)})},importTemplate:function(b){b=window.encodeURI(b);opt.common.downLoadFile(baseURL+"excel/download?fileName="+b)},importExcel:function(d,e,c){opt.table.set();var b=opt.common.isEmpty(d)?"importTpl":d;opt.layer.open({type:1,area:["580px","200px"],shadeClose:true,resize:false,scrollbar:true,title:'<i class="fa fa-upload"></i> \u5BFC\u5165'+(opt.common.isEmpty(e)?opt.table.options.modalName:(e+"\u6570\u636E")),content:opt.template(b),btn:['<i class="fa fa-check"></i> \u5BFC\u5165','<i class="fa fa-remove"></i> \u53D6\u6D88'],shadeClose:true,success:function(f,g){f.find("#file").off("click").on("click",function(h){h.target.value=""})},btn1:function(h,f){var i=f.find("#file").val();if(i==""||(!opt.common.endWith(i,".xls")&&!opt.common.endWith(i,".xlsx"))){opt.warning("\u8BF7\u9009\u62E9\u540E\u7F00\u4E3A \u201Cxls\u201D\u6216\u201Cxlsx\u201D\u7684\u6587\u4EF6\u3002");return false}parent.opt.modal.loading();var j=new FormData(f.find("form")[0]);var g={url:opt.common.isEmpty(c)?opt.table.options.importUrl:c,data:j,cache:false,contentType:false,processData:false,type:"POST",success:function(k){if(k.code==opt.variable.web_status.SUCCESS){parent.opt.modal.closeLoading();opt.success(k.msg);a.table.refresh();opt.layer.close(h)}else{if(k.code==opt.variable.web_status.WARNING){opt.error(k.msg);parent.opt.modal.closeLoading()}else{opt.error(k.msg);parent.opt.modal.closeLoading()}}},error:function(k,l){opt.error(JSON.parse(k.responseText).msg||k.responseText);parent.opt.modal.closeLoading();return}};opt.common.sendAjax(g)}})},refresh:function(c){var b=opt.common.isEmpty(c)?opt.table.options.id:c;a("#"+b).bootstrapTable("refresh",{silent:true})},getRowByUniqueId:function(d,c){opt.table.set(c);var b=opt.common.isEmpty(c)?opt.table.options.id:c;return a("#"+b).bootstrapTable("getRowByUniqueId",d)},selectColumns:function(b){var c=a.map(a("#"+opt.table.options.id).bootstrapTable("getSelections"),function(h){var f=h;var e=b.split(".");for(var g in e){f=f&&f[e[g]]}return f});if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(opt.table.rememberSelecteds[opt.table.options.id],function(h){var f=h;var e=b.split(".");for(var g in e){f=f&&f[e[g]]}return f})}}return opt.common.uniqueFn(c)},affectedRowIds:function(d){var f=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId;var b;if(d instanceof Array){b=a.map(d,function(j){var h=j;var g=f.split(".");for(var i in g){h=h&&h[g[i]]}return h})}else{b=d;var c=f.split(".");for(var e in c){b=b&&b[c[e]]}b=[b]}return b},selectFirstColumns:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c=a.map(a("#"+opt.table.options.id).bootstrapTable("getSelections"),function(e){return e[opt.table.options.columns[1].field]});if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(d,function(e){return e[opt.table.options.columns[1].field]})}}return opt.common.uniqueFn(c)},selectAllColumns:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c;if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(d,function(e){return opt.common.getJsonValue(e,opt.table.options.uniqueId)})}else{c=[]}}if(opt.common.isEmpty(c)||c.length==0){c=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});c=a.table.affectedRowIds(c)}return opt.common.uniqueFn(c)},clearRememberSelected:function(b){opt.table.set(b);if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){delete opt.table.rememberSelectedIds[opt.table.options.id];delete opt.table.rememberSelecteds[opt.table.options.id]}},selectAllColumnRows:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c;if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){return d}else{c=[]}}if(opt.common.isEmpty(c)||c.length==0){c=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});return c}},showColumn:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("showColumn",c)},hideColumn:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("hideColumn",c)},uncheck:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("uncheck",c)},updataData:function(j,c){opt.table.set(c);var m=opt.common.isEmpty(c)?opt.table.options.id:c;var e=[];for(var n=0;n<=j;n++){var d=a("#"+m+' tr[data-index="'+n+'"] td');var g={};for(var h=0;h<d.length;h++){var b=a(d[h]).find("input");if(b.length==1){var r=a(d[h]).find("select");var p=opt.table.options.columns[h].field;if(opt.common.isNotEmpty(b.val())){g[p]=b.val()}else{if(opt.common.isNotEmpty(r.val())){g[p]=r.val()}else{g[p]=""}}}else{var r=a(d[h]).find("select");var p=opt.table.options.columns[h].field;if(opt.common.isNotEmpty(a(b[0]).val())){var l=a(b[1]).attr("name").split(".");if(l.length>1){g[p]=a(b[0]).val();var k=l;var f={},o=k.length-1;while(o>-1){var q={};q[k[o]]=f;f=q;if(o==(k.length-1)){f[k[o]]=a(b[1]).val()}o--}g=opt.common.extend(f,g)}else{g[p]=a(b[0]).val();g[a(b[1]).attr("name")]=a(b[1]).val()}}else{if(opt.common.isNotEmpty(r.val())){g[p]=r.val()}else{g[p]=""}}}}e.push({index:n,row:g})}a("#"+m).bootstrapTable("updateRow",e)},removeData:function(c,g){var f=this;opt.table.set();c=opt.common.isEmpty(c)?"index":c;var b=opt.common.isEmpty(g)?opt.table.options.id:g;var h=a("#"+b).bootstrapTable("getSelections");if(h.length==0){opt.modal.error(a.i18n.prop("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E"));return}var e=a("#"+b).bootstrapTable("getData").length;f.updataData(e);var j=[];for(var d=0;d<h.length;d++){j[d]=h[d][c]}a("#"+opt.table.options.id).bootstrapTable("remove",{field:c,values:j})},addColumn:function(f,g,e){var d=this;opt.table.set(e);var b=opt.common.isEmpty(e)?opt.table.options.id:e;var c=a("#"+b).bootstrapTable("getData").length;d.updataData(c);a("#"+b).bootstrapTable("insertRow",{index:c+1,row:f});if(a(".time-input").length>0){a(".time-input").each(function(k,r){var h=a(r);var m=h.attr("data-type")||"date";var o=h.attr("data-format")||"yyyy-MM-dd";var l=h.attr("data-btn")||"clear|now|confirm",s=[];var q=h.attr("data-callback")||{};if(l){if(l.indexOf("|")>0){var n=l.split("|"),p=n.length;for(var i=0;i<p;i++){if("clear"===n[i]||"now"===n[i]||"confirm"===n[i]){s.push(n[i])}}}else{if("clear"===l||"now"===l||"confirm"===l){s.push(l)}}}else{s=["clear","now","confirm"]}laydate.render({elem:r,theme:"molv",trigger:"click",type:m,format:o,btns:s,done:function(t,j){if(typeof window[q]!="undefined"&&window[q] instanceof Function){window[q](t,j)}}})})}if(a.fn.select2!==undefined){a.fn.select2.defaults.set("theme","bootstrap");a("select.form-control:not(.noselect2)").each(function(){if(typeof(a(this).attr("multiple"))=="undefined"){a(this).select2({allowClear:false,placeholder:"\u8BF7\u70B9\u51FB\u9009\u62E9"})}else{a(this).select2({allowClear:true,placeholder:""})}})}if(typeof g=="function"){g(f)}}}})})(jQuery);
