/*!
 * 表格树封装处理
 * Copyright (c) 2020-Now http://www.j2eefast.com All rights reserved.
 * No deletion without permission
 * @author ZhouZhou
 */
(function(a){a.extend({bttTable:{},treeTable:{init:function(c){var e={id:"bootstrap-tree-table",type:1,height:0,rootIdValue:"0",ajaxParams:{},sortName:"",sortOrder:"asc",async:false,toolbar:"toolbar",striped:false,pageSize:12,pageList:[12,24,32],expandColumn:1,showSearch:true,showRefresh:true,showColumns:true,expandAll:true,expandFirst:true,bordered:false,asynUrl:null,};var c=a.extend(e,c);var b=false;if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"align"))){c.columns[d].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"halign"))){c.columns[d].halign="center"}if(opt.common.getJsonValue(c.columns[d],"field")==="selectItem"){b=true}}}if(!b){c.expandColumn=0}opt.table.options=c;opt.table.config[c.id]=c;a.bttTable=a("#"+c.id).bootstrapTreeTable({id:c.id,code:c.code,parentCode:c.parentCode,type:"post",url:c.url,async:c.async,asynUrl:c.asynUrl,data:c.data,ajaxParams:c.ajaxParams,sortName:c.sortName,sortOrder:c.sortOrder,rootIdValue:c.rootIdValue,height:c.height,pageSize:c.pageSize,pageList:c.pageList,expandColumn:c.expandColumn,striped:c.striped,bordered:c.bordered,toolbar:"#"+c.toolbar+"-"+c.id,showSearch:c.showSearch,showRefresh:c.showRefresh,showColumns:c.showColumns,expandAll:c.expandAll,expandFirst:c.expandFirst,columns:c.columns,onClickRow:a.treeTable.onClickRow,responseHandler:a.treeTable.responseHandler})},search:function(e){var b=opt.common.isEmpty(e)?a("form").attr("id"):e;var d=opt.common.formToJSON(b);d["__refre"]=true;for(var c in d){if(opt.common.isNotEmpty(d[c])&&c!=="__refre"){d["__refre"]=false;break}}a.bttTable.bootstrapTreeTable("refresh",d)},refresh:function(){a.bttTable.bootstrapTreeTable("refresh",{"__refre":true})},selectColumns:function(b){var c=a.map(a.bttTable.bootstrapTreeTable("getSelections"),function(d){return d[b]});return opt.common.uniqueFn(c)},onClickRow:function(c){var b="toolbar-"+opt.table.get(this.id).id;a("#"+b+" .multiple").toggleClass("disabled",false);a("#"+b+" .single").toggleClass("disabled",false);if(typeof opt.table.get(this.id).onClickRow=="function"){opt.table.get(this.id).onClickRow(c)}},responseHandler:function(b){if(b.code!=undefined&&b.code!=0){opt.modal.error(b.msg);return[]}else{if(typeof opt.table.get(this.id).responseHandler=="function"){opt.table.get(this.id).responseHandler(b)}return b}},}})})(jQuery);