/*!
 * Copyright (c) 2020-Now http://www.j2eefast.com All rights reserved.
 * No deletion without permission
 * @author ZhouHuan
 * @date 2020-12-21
 * @version v1.1.0
 */
;if(typeof jQuery==="undefined"){throw new Error("fastJS JavaScript requires jQuery")}(function($,window,undefined){var opt={variable:{navtab:null,_tabIndex:-999,tindex:0,pushMenu:null,version:"1.1.0",debug:true,mode:"storage",loadTip:true,isWatermark:true,table_type:{bootstrapTable:0,bootstrapTreeTable:1},modal_status:{SUCCESS:"success",FAIL:"error",WARNING:"warning"},web_status:{SUCCESS:"00000",FAIL:500,WARNING:"50001"},skins:["skin-blue","skin-black","skin-red","skin-yellow","skin-purple","skin-green","skin-blue-light","skin-black-light","skin-red-light","skin-yellow-light","skin-purple-light","skin-green-light"]},domReady:function(){var fnArr=[];function doReady(doc){doc.isReady=true;for(var ci;ci=fnArr.pop();ci()){}}return function(onready,win){win=win||window;var doc=win.document;onready&&fnArr.push(onready);if(doc.readyState==="complete"){doReady(doc)}else{doc.isReady&&doReady(doc);var agent=navigator.userAgent.toLowerCase();var ie=/(msie\s|trident.*rv:)([\w.]+)/.test(agent);var version;var v1=agent.match(/(?:msie\s([\w.]+))/);var v2=agent.match(/(?:trident.*rv:([\w.]+))/);if(v1&&v2&&v1[1]&&v2[1]){version=Math.max(v1[1]*1,v2[1]*1)}else{if(v1&&v1[1]){version=v1[1]*1}else{if(v2&&v2[1]){version=v2[1]*1}else{version=0}}}if(ie&&version!=11){(function(){if(doc.isReady){return}try{doc.documentElement.doScroll("left")}catch(error){setTimeout(arguments.callee,0);return}doReady(doc)})();win.attachEvent("onload",function(){doReady(doc)})}else{doc.addEventListener("DOMContentLoaded",function(){doc.removeEventListener("DOMContentLoaded",arguments.callee,false);doReady(doc)},false);win.addEventListener("load",function(){doReady(doc)},false)}}}}(),sidebarCollapse:function(){opt.variable.pushMenu.expandOnHover();if(!$("body").hasClass("sidebar-collapse")){$('[data-layout="sidebar-collapse"]').click()}$('[data-toggle="push-menu"]').click()},pushMenuInit:function(){$(".main-sidebar").unbind("mouseenter").unbind("mouseleave")},wclearInterval:function(){window.clearInterval(opt.variable.tindex)},getMessage:function(){$.getJSON("sys/user/info?_"+$.now(),function(r){})},toast:function(){if($.toast){return $.toast}try{if(parent.$.toast){return parent.$.toast}if(parent.parent.$.toast){return parent.parent.$.toast}if(top.$.toast){return top.$.toast}}catch(e){}return null}(),error:function(msg,callback){opt.modal.enable();if(opt.toast){opt.toast({heading:$.i18n.prop("警告"),text:msg,hideAfter:4000,position:{right:7,bottom:32},showHideTransition:"slide",afterHidden:function(){if(typeof(callback)==="function"){callback("ok")}},icon:"error"})}else{opt.modal.alertError(msg)}},info:function(msg,callback){if(opt.toast){opt.toast({heading:$.i18n.prop("提示"),text:msg,hideAfter:4000,position:{right:7,bottom:32},showHideTransition:"slide",afterHidden:function(){if(typeof(callback)==="function"){callback("ok")}},icon:"info"})}else{opt.modal.alertInfo(msg);if(typeof(callback)==="function"){callback("ok")}}},success:function(msg,callback){if(opt.toast){opt.toast({heading:$.i18n.prop("成功"),text:msg,hideAfter:4000,position:{right:7,bottom:32},showHideTransition:"slide",afterHidden:function(){if(typeof(callback)==="function"){callback("ok")}},icon:"success"})}else{layui.use("layer",function(){var layer=layui.layer;layer.msg(msg)});if(typeof(callback)==="function"){callback("ok")}}},warning:function(text,callback){if(opt.toast){opt.toast({heading:$.i18n.prop("警告"),text:text,hideAfter:4000,position:{right:7,bottom:32},showHideTransition:"slide",afterHidden:function(){if(typeof(callback)==="function"){callback("ok")}},icon:"warning"})}else{opt.modal.alertWarning(text)}},changeSkin:function(cls){$.each(opt.variable.skins,function(i){$("body").removeClass(opt.variable.skins[i])});$("body").addClass(cls);opt.storage.set("skin",cls);return false},setPageMode:function(src){if(top.location==self.location){var mode=opt.storage.get("mode",0);if(typeof mode!=="undefined"&&mode&&mode.length>0){$("html").removeClass(mode)}if(typeof src!=="undefined"&&src&&src.length>0){if(!$("html").hasClass(src)){$("html").addClass(src)}}}},getLeftMeunDataConfig:function(module,href){var dataId=$("#leftMenu li a[data-url='"+href+"'][data-module='"+module+"']").attr("data-id")||-1;var dataIcon=$("#leftMenu li a[data-url='"+href+"'][data-module='"+module+"'] i").attr("data-icon")||"";var title=$("#leftMenu li a[data-url='"+href+"'][data-module='"+module+"'] span").html()||"";var data={href:href,icon:dataIcon,title:$.i18n.prop(title),id:dataId,module:module};return data},getLeftFirstMenuConig:function(){var href=$("#leftMenu li a[data-url]:first-child").attr("data-url")||"main";var dataId=$("#leftMenu li a[data-url]:first-child").attr("data-id")||-1;var module=$("#leftMenu li a[data-url]:first-child").attr("data-module")||"core";var dataIcon=$("#leftMenu li a[data-url]:first-child i").attr("data-icon")||"";var title=$("#leftMenu li a[data-url]:first-child span").html();var data={href:href,icon:dataIcon,title:$.i18n.prop(title),id:dataId,module:module};return data},createMenuItem:function(dataUrl,menuName){if(top.location!==self.location){var dataIndex=opt.common.randomString(16);var panelId,module;if(dataUrl==undefined||$.trim(dataUrl).length==0){return false}if(opt.common.isEmpty(parent.opt.variable.navtab)){parent.opt.createMenuItem(dataUrl,menuName);return}var topWindow=$(window.parent.document);if($(".layui-tab-title li",topWindow).length>0){$(".layui-tab-title li",topWindow).each(function(){if($(this).hasClass("layui-this")){panelId=$(this).attr("lay-id");module=$(this).children("em").data("module")}})}var data={href:dataUrl,icon:"fa fa-plus-square",panel:panelId,title:menuName,module:module,id:dataIndex};parent.opt.navTabAdd(data);return}else{opt.selfLayer.open({type:2,maxmin:true,shadeClose:true,title:menuName,area:[($(window).width()-100)+"px",($(window).height()-100)+"px"],content:dataUrl})}},closeItem:function(dataId){if(top.location!=self.location){var topWindow=$(window.parent.document);if($(".layui-tab-title li",topWindow).length>0){if(opt.common.isNotEmpty(dataId)){$('.layui-tab-title li[lay-id="'+dataId+'"]',topWindow).children('i.layui-tab-close[data-id="'+data.id+'"]').trigger("click")}else{$(".layui-tab-title li",topWindow).each(function(){if($(this).hasClass("layui-this")){$(this).children('i.layui-tab-close[data-id="'+$(this).attr("lay-id")+'"]').trigger("click")}})}}else{try{if(parent.opt.table.options.type==opt.variable.table_type.bootstrapTable){parent.$.table.refresh()}else{if(parent.opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){parent.$.treeTable.refresh()}}}catch(e){}parent.opt.selfLayer.closeAll()}}else{window.opener=null;window.open("","_self");window.close()}},block:function(value,element){if(opt.common.isEmpty(value)){if(opt.common.isNotEmpty(element)){$(element).block()}else{$.blockUI()}}else{if(opt.common.isNotEmpty(element)){$(element).block({message:'<div class="loaderbox"><div class="loading-activity"></div> '+$.i18n.prop(value)+"</div>"})}else{$.blockUI({message:'<div class="loaderbox"><div class="loading-activity"></div> '+$.i18n.prop(value)+"</div>"})}}},unblock:function(element){if(opt.common.isNotEmpty(element)){$(element).unblock()}else{$.unblockUI()}},template:function(id,data,callback){var tpl=String($("#"+id).html()).replace(/(\/\/\<!\-\-)|(\/\/\-\->)/g,""),data=data||[];if(typeof callback=="function"){laytpl(tpl).render(data||[],function(render){callback(render)});return null}return laytpl(tpl).render(data||[])},layer:function(){try{if(top.layer){return top.layer}if(parent.parent.layer){return parent.parent.layer}if(parent.layer){return parent.layer}}catch(e){}if(window.layer){return layer}return null}(),getCookie:function(name){if(document.cookie.length>0){var c_start=document.cookie.indexOf(name+"=");if(c_start!=-1){c_start=c_start+name.length+1;var c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length}return unescape(document.cookie.substring(c_start,c_end))}}return""},selfLayer:function(){if(window.layer){return layer}try{if(top.layer&&top.layer.window){return top.layer}if(parent.parent.layer&&parent.parent.layer.window){return parent.parent.layer}if(parent.layer&&parent.layer.window){return parent.layer}}catch(e){}return null}(),navDelTab:function(dataId){layui.element.tabDelete("main-tab",dataId).init()},navTabAdd:function(data){opt.variable.navtab.tabAdd(data)},navToTab:function(dataId){layui.element.tabChange("main-tab",dataId)},navDelTabNow:function(){if($(".layui-tab-title li").length>1){$(".layui-tab-title li").each(function(){if($(this).attr("lay-id")!=0){opt.navDelTab($(this).attr("lay-id"))}})}},storage:{set:function(key,value,tag){if(typeof tag!=="undefined"&&tag==0){window.localStorage.setItem(key,value)}else{window.localStorage.setItem(_username+key,value)}},get:function(key,tag){if(typeof tag!=="undefined"&&tag==0){return window.localStorage.getItem(key)}else{return window.localStorage.getItem(_username+key)}},remove:function(key,tag){if(typeof tag!=="undefined"&&tag==0){window.localStorage.removeItem(key)}else{window.localStorage.removeItem(_username+key)}},clear:function(){window.localStorage.clear()}},table:{config:{},options:{},set:function(id){if(opt.common.getLength(opt.table.config)>1){var tableId=opt.common.isEmpty(id)?$(event.currentTarget).parents(".bootstrap-table").find(".table").attr("id"):id;if(opt.common.isNotEmpty(tableId)){opt.table.options=opt.table.get(tableId)}}},get:function(id){return opt.table.config[id]},rememberSelecteds:{},rememberSelectedIds:{}},common:{isEmpty:function(obj){try{if(obj==null||obj==undefined){return true}if(this.isArray(obj)||this.isString(obj)){return obj.length===0}if(this.isNumber(obj)){return false}if(this.isFunction(obj)){return false}if(typeof obj==="boolean"){return false}for(var key in obj){if(obj.hasOwnProperty(key)){return false}}return true}catch(e){if(window.console){console.error(e)}return true}},addWaterMarker:function(str){var cpyName=str;if(str.length>26){cpyName=str.substring(0,26)}var can=document.createElement("canvas");var report=$(".wrapper")[0];report.appendChild(can);can.width=280;can.height=110;can.style.display="none";can.style.zIndex="999999";var cans=can.getContext("2d");cans.rotate(-25*Math.PI/180);cans.font="800 30px Microsoft JhengHei";cans.fillStyle="#000";cans.textAlign="center";cans.textBaseline="Middle";if(cans.measureText(cpyName).width>180){var size=180/cpyName.length;cans.font="800 "+size+"px  Microsoft JhengHei"}cans.fillText(cpyName,60,100);report.style.backgroundImage="url("+can.toDataURL("image/png")+")"},watermark:function(settings){var defaultSettings={watermark_txt:"text",watermark_x:20,watermark_y:20,watermark_rows:100,watermark_cols:20,watermark_x_space:10,watermark_y_space:10,watermark_color:"#aaa",watermark_alpha:0.3,watermark_fontsize:"15px",watermark_font:"微软雅黑",watermark_width:150,watermark_height:80,watermark_angle:15};if(arguments.length===1&&typeof arguments[0]==="object"){var src=arguments[0]||{};for(key in src){if(src[key]&&defaultSettings[key]&&src[key]===defaultSettings[key]){continue}else{if(src[key]){defaultSettings[key]=src[key]}}}}let oTemp=document.createDocumentFragment();let page_width=Math.max(document.body.scrollWidth,document.body.clientWidth);let cutWidth=page_width*0.015;page_width=page_width-cutWidth;let page_height=Math.max(document.body.scrollHeight-80,document.body.clientHeight-40);if(defaultSettings.watermark_cols==0||(parseInt(defaultSettings.watermark_x+defaultSettings.watermark_width*defaultSettings.watermark_cols+defaultSettings.watermark_x_space*(defaultSettings.watermark_cols-1))>page_width)){defaultSettings.watermark_cols=parseInt((page_width-defaultSettings.watermark_x+defaultSettings.watermark_x_space)/(defaultSettings.watermark_width+defaultSettings.watermark_x_space));defaultSettings.watermark_x_space=parseInt((page_width-defaultSettings.watermark_x-defaultSettings.watermark_width*defaultSettings.watermark_cols)/(defaultSettings.watermark_cols-1))}if(defaultSettings.watermark_rows==0||(parseInt(defaultSettings.watermark_y+defaultSettings.watermark_height*defaultSettings.watermark_rows+defaultSettings.watermark_y_space*(defaultSettings.watermark_rows-1))>page_height)){defaultSettings.watermark_rows=parseInt((defaultSettings.watermark_y_space+page_height-defaultSettings.watermark_y)/(defaultSettings.watermark_height+defaultSettings.watermark_y_space));defaultSettings.watermark_y_space=parseInt(((page_height-defaultSettings.watermark_y)-defaultSettings.watermark_height*defaultSettings.watermark_rows)/(defaultSettings.watermark_rows-1))}let x;let y;for(let i=0;i<defaultSettings.watermark_rows;i++){y=defaultSettings.watermark_y+(defaultSettings.watermark_y_space+defaultSettings.watermark_height)*i;for(let j=0;j<defaultSettings.watermark_cols;j++){x=defaultSettings.watermark_x+(defaultSettings.watermark_width+defaultSettings.watermark_x_space)*j;var mask_div=document.createElement("div");mask_div.id="mask_div"+i+j;mask_div.className="mask_div";mask_div.appendChild(document.createTextNode(defaultSettings.watermark_txt));mask_div.style.webkitTransform="rotate(-"+defaultSettings.watermark_angle+"deg)";mask_div.style.MozTransform="rotate(-"+defaultSettings.watermark_angle+"deg)";mask_div.style.msTransform="rotate(-"+defaultSettings.watermark_angle+"deg)";mask_div.style.OTransform="rotate(-"+defaultSettings.watermark_angle+"deg)";mask_div.style.transform="rotate(-"+defaultSettings.watermark_angle+"deg)";mask_div.style.visibility="";mask_div.style.position="fixed";mask_div.style.left=x+"px";mask_div.style.top=y+"px";mask_div.style.overflow="hidden";mask_div.style.zIndex="19920219";mask_div.style.pointerEvents="none";mask_div.style.opacity=defaultSettings.watermark_alpha;mask_div.style.fontSize=defaultSettings.watermark_fontsize;mask_div.style.fontFamily=defaultSettings.watermark_font;mask_div.style.color=defaultSettings.watermark_color;mask_div.style.textAlign="center";mask_div.style.width=defaultSettings.watermark_width+"px";mask_div.style.height=defaultSettings.watermark_height+"px";mask_div.style.display="block";if((i%2==0)&&(j%2==0)){oTemp.appendChild(mask_div)}if((i%2==1)&&(j%2==1)){oTemp.appendChild(mask_div)}}}document.body.appendChild(oTemp)},isPrimitive:function(value){return(typeof value==="string"||typeof value==="number"||typeof value==="symbol"||typeof value==="boolean")},isNotEmpty:function(value){return !opt.common.isEmpty(value)},nullToStr:function(value,_default){if(opt.common.isEmpty(value)){return(opt.common.isEmpty(_default))?"":_default}return value},visible:function(value){if(opt.common.isEmpty(value)||value==true){return true}return false},trim:function(value){if(value==null){return""}if(typeof value==="string"){return value.toString().replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")}else{return value}},hideStr:function(value,len,tag){if(opt.common.isEmpty(value)){return"-"}else{if(tag==0){if(value.length>len){return value.substr(0,len)+"..."}else{return value}}else{return"..."+value.substr(value.length-len,len)}}},equals:function(str,that){return str==that},equalsIgnoreCase:function(str,that){return String(str).toUpperCase()===String(that).toUpperCase()},split:function(str,sep,maxLen){if(opt.common.isEmpty(str)){return null}var value=String(str).split(sep);return maxLen?value.slice(0,maxLen-1):value},sprintf:function(str){var args=arguments,flag=true,i=1;str=str.replace(/%s/g,function(){var arg=args[i++];if(typeof arg==="undefined"){flag=false;return""}return arg});return flag?str:""},random:function(min,max){return Math.floor((Math.random()*max)+min)},randomString:function(len){len=len||32;var $chars="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";var maxPos=$chars.length;var pwd="";for(i=0;i<len;i++){pwd+=$chars.charAt(Math.floor(Math.random()*maxPos))}return pwd},startWith:function(value,start){var reg=new RegExp("^"+start);return reg.test(value)},endWith:function(value,end){var reg=new RegExp(end+"$");return reg.test(value)},uniqueFn:function(array){var result=[];var hashObj={};for(var i=0;i<array.length;i++){if(!hashObj[array[i]]){hashObj[array[i]]=true;result.push(array[i])}}return result},join:function(array,separator){if(opt.common.isEmpty(array)){return null}return array.join(separator)},formToJSON:function(formId){var json={};$.each($("#"+formId).serializeArray(),function(i,field){if(json[field.name]){json[field.name]+=(","+field.value)}else{json[field.name]=field.value}});return json},getJsonValue:function(obj,k){var rn=obj;var props=k.split(".");for(var p in props){if(rn[props[p]]&&typeof rn[props[p]]!="undefined"){rn=rn[props[p]]}else{rn=""}}return rn},objToEmpty:function(obj){for(var key in obj){if(Array.prototype==obj[key].__proto__){obj[key]=[]}else{if(typeof obj[key]=="string"){obj[key]=""}else{if(typeof obj[key]=="number"){obj[key]=0}}}}return obj},getLength:function(obj){var count=0;for(var i in obj){if(obj.hasOwnProperty(i)){count++}}return count},copy:function(text){var oInput=document.createElement("input");oInput.value=text;$(oInput).css({opacity:"0"});$(oInput).attr({name:"__copy_secukey"});document.body.appendChild(oInput);oInput.select();document.execCommand("Copy");oInput.className="oInput";$("input[name='__copy_secukey']").remove()},getCheckboxValue:function(name){var txt="";$('input[name="'+name+'"]').each(function(){if($(this).is(":checked")){txt+=$(this).val()+","}});if(txt.length>0){txt=txt.substring(0,txt.length-1)}return txt},toNumber:function(val){var n=parseFloat(val);return isNaN(n)?val:n},remove:function(arr,item){if(arr.length){var index=arr.indexOf(item);if(index>-1){return arr.splice(index,1)}}},toArray:function(list,start){start=start||0;var i=list.length-start;var ret=new Array(i);while(i--){ret[i]=list[i+start]}return ret},extend:function(target,source,isKeepTarget){if(source){for(var k in source){if(!isKeepTarget||!target.hasOwnProperty(k)){target[k]=source[k]}}}return target},each:function(obj,iterator,context){if(obj==null){return}if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(iterator.call(context,obj[i],i,obj)===false){return false}}}else{for(var key in obj){if(obj.hasOwnProperty(key)){if(iterator.call(context,obj[key],key,obj)===false){return false}}}}},toObject:function(arr){var that=this;var res={};for(var i=0;i<arr.length;i++){if(arr[i]){that.extend(res,arr[i])}}return res},moneyToChinese:function(money){var cnNums=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖");var cnIntRadice=new Array("","拾","佰","仟");var cnIntUnits=new Array("","万","亿","兆");var cnDecUnits=new Array("角","分","毫","厘");var cnInteger="整";var cnIntLast="元";var maxNum=1000000000000000;var IntegerNum;var DecimalNum;var ChineseStr="";var parts;var Symbol="";if(opt.common.isEmpty(money)){return""}money=parseFloat(money);if(money>=maxNum){throw new Error("超出最大金额!")}if(money==0){ChineseStr=cnNums[0]+cnIntLast+cnInteger;return ChineseStr}if(money<0){money=-money;Symbol="负 "}money=money.toString();if(money.indexOf(".")==-1){IntegerNum=money;DecimalNum=""}else{parts=money.split(".");IntegerNum=parts[0];DecimalNum=parts[1].substr(0,4)}if(parseInt(IntegerNum,10)>0){var zeroCount=0;var IntLen=IntegerNum.length;for(var i=0;i<IntLen;i++){var n=IntegerNum.substr(i,1);var p=IntLen-i-1;var q=p/4;var m=p%4;if(n=="0"){zeroCount++}else{if(zeroCount>0){ChineseStr+=cnNums[0]}zeroCount=0;ChineseStr+=cnNums[parseInt(n)]+cnIntRadice[m]}if(m==0&&zeroCount<4){ChineseStr+=cnIntUnits[q]}}ChineseStr+=cnIntLast}if(DecimalNum!=""){var decLen=DecimalNum.length;for(var i=0;i<decLen;i++){var n=DecimalNum.substr(i,1);if(n!="0"){ChineseStr+=cnNums[Number(n)]+cnDecUnits[i]}}}if(ChineseStr==""){ChineseStr+=cnNums[0]+cnIntLast+cnInteger}else{if(DecimalNum==""){ChineseStr+=cnInteger}}ChineseStr=Symbol+ChineseStr;return ChineseStr},compareVersion:function(version1,version2){var arr1=version1.split(".");var arr2=version2.split(".");var length1=arr1.length;var length2=arr2.length;var minlength=Math.min(length1,length2);var i=0;for(i;i<minlength;i++){var a=parseInt(arr1[i]);var b=parseInt(arr2[i]);if(a>b){return 1}else{if(a<b){return -1}}}if(length1>length2){for(var j=i;j<length1;j++){if(parseInt(arr1[j])!=0){return 1}}return 0}else{if(length1<length2){for(var j=i;j<length2;j++){if(parseInt(arr2[j])!=0){return -1}}return 0}}return 0},formatMoney:function(number,places,symbol,thousand,decimal){number=number||0;places=!isNaN(places=Math.abs(places))?places:2;symbol=symbol!==undefined?symbol:"$";thousand=thousand||",";decimal=decimal||".";var negative=number<0?"-":"",i=parseInt(number=Math.abs(+number||0).toFixed(places),10)+"",j=(j=i.length)>3?j%3:0;return symbol+negative+(j?i.substr(0,j)+thousand:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+thousand)+(places?decimal+Math.abs(number-i).toFixed(places).slice(2):"")},playSound:function(src){if(!(src.indexOf("http")==0)){src=baseURL+"static/audio/"+src+".wav"}if(!!window.ActiveXObject||"ActiveXObject" in window){var embed=document.noticePlay;if(embed){embed.remove()}embed=document.createElement("embed");embed.setAttribute("name","noticePlay");embed.setAttribute("src",src);embed.setAttribute("autostart",true);embed.setAttribute("loop",false);embed.setAttribute("hidden",true);document.body.appendChild(embed);embed=document.noticePlay;embed.volume=100}else{var audio=document.createElement("audio");audio.setAttribute("hidden",true);audio.setAttribute("src",src);document.body.appendChild(audio);audio.addEventListener("ended",function(){audio.parentNode.removeChild(audio)},false);audio.play()}},sendAjax:function(config){if(opt.common.equalsIgnoreCase(config.type,"POST")&&opt.common.isNotEmpty($('meta[name="csrf-token"]').attr("content"))){config=opt.common.extend(config,{headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}})}if(opt.common.isEmpty(config.error)||typeof config.error!="function"){config=opt.common.extend(config,{error:function(xhr,textStatus){try{opt.error(JSON.parse(xhr.responseText).msg||xhr.responseText)}catch(e){console.error(xhr.responseText)}opt.modal.closeLoading();return}})}$.ajax(config)},downLoadFile:function(url){var judgeDiv=document.getElementById("dwDiv");if(judgeDiv!=null){document.body.removeChild(judgeDiv)}var divObj=document.createElement("div");divObj.id="dwDiv";var aObj=document.createElement("a");aObj.href=encodeURI(url);aObj.id="hrefFile";divObj.appendChild(aObj);document.body.appendChild(divObj);document.getElementById("hrefFile").click();judgeDiv=document.getElementById("dwDiv");if(judgeDiv!=null){document.body.removeChild(judgeDiv)}},digit:function(e,t){var i="";e=String(e),t=t||2;for(var n=e.length;n<t;n++){i+="0"}return e<Math.pow(10,t)?i+(0|e):e},toDateString:function(data,t){var that=this,n=new Date(data||new Date),a=[that.digit(n.getFullYear(),4),that.digit(n.getMonth()+1),that.digit(n.getDate())],o=[that.digit(n.getHours()),that.digit(n.getMinutes()),that.digit(n.getSeconds())];return t=t||"yyyy-MM-dd HH:mm:ss",t.replace(/yyyy/g,a[0]).replace(/MM/g,a[1]).replace(/dd/g,a[2]).replace(/HH/g,o[0]).replace(/mm/g,o[1]).replace(/ss/g,o[2])},formatDat:function(date,format){var that=this;if(that.isEmpty(date)){return""}if(!date){return}if(!format){format="yyyy-MM-dd"}switch(typeof date){case"string":date=new Date(date.replace(/-/,"/"));break;case"number":date=new Date(date);break}if(!date instanceof Date){return}var dict={yyyy:date.getFullYear(),M:date.getMonth()+1,d:date.getDate(),H:date.getHours(),m:date.getMinutes(),s:date.getSeconds(),MM:(""+(date.getMonth()+101)).substr(1),dd:(""+(date.getDate()+100)).substr(1),HH:(""+(date.getHours()+100)).substr(1),mm:(""+(date.getMinutes()+100)).substr(1),ss:(""+(date.getSeconds()+100)).substr(1)};return format.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,function(){return dict[arguments[0]]})},escape:function(html){return String(html||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},encodeUrl:function(a){return encodeURIComponent(a)},decodeUrl:function(a){return decodeURIComponent(a)},subString:function(str,len,hasDot){var newLength=0;var newStr="";var chineseRegex=/[^\x00-\xff]/g;var singleChar="";var strLength=str.replace(chineseRegex,"**").length;for(var i=0;i<strLength;i++){singleChar=str.charAt(i).toString();if(singleChar.match(chineseRegex)!=null){newLength+=2}else{newLength++}if(newLength>len){break}newStr+=singleChar}if(hasDot&&strLength>len){newStr+="..."}return newStr},bytesToSize:function(bytes){if(bytes===0){return"0 B"}var k=1024;sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];i=Math.floor(Math.log(bytes)/Math.log(k));var num=bytes/Math.pow(k,i);return num.toPrecision(3)+" "+sizes[i]},fileFromPath:function(file){return file.replace(/.*(\/|\\)/,"")},getExt:function(file){return(-1!==file.indexOf("."))?file.replace(/.*[.]/,""):""},optimizationPath:function(path){var protocol=/^[a-z]+:\/\//.exec(path)[0],tmp=null,res=[];path=path.replace(protocol,"").split("?")[0].split("#")[0];path=path.replace(/\\/g,"/").split(/\//);path[path.length-1]="";while(path.length){if((tmp=path.shift())===".."){res.pop()}else{if(tmp!=="."){res.push(tmp)}}}return protocol+res.join("/")}},modal:{icon:function(type){var icon="";if(type==opt.variable.modal_status.WARNING){icon=0}else{if(type==opt.variable.modal_status.SUCCESS){icon=1}else{if(type==opt.variable.modal_status.FAIL){icon=2}else{icon=3}}}return icon},msg:function(content,type){if(type!=undefined){layui.use("layer",function(){var layer=layui.layer;layer.msg(content,{icon:opt.modal.icon(type),time:1000,shift:5})})}else{layui.use("layer",function(){var layer=layui.layer;layer.msg(content)})}},msgError:function(content){opt.modal.msg(content,opt.variable.modal_status.FAIL)},msgSuccess:function(content){opt.modal.msg(content,opt.variable.modal_status.SUCCESS)},msgWarning:function(content){opt.modal.msg(content,opt.variable.modal_status.WARNING)},alert:function(content,type,shadeClose){opt.selfLayer.alert(content,{icon:opt.modal.icon(type),title:$.i18n.prop("系统提示"),shadeClose:opt.common.isEmpty(shadeClose)?true:shadeClose,btn:['<i class="fa fa-check"></i> '+$.i18n.prop("确定")],btnclass:["btn btn-primary"]})},msgReload:function(msg,type){opt.selfLayer.msg(msg,{icon:opt.modal.icon(type),time:500},function(){opt.modal.reload()})},alertError:function(content){opt.modal.alert(content,opt.variable.modal_status.FAIL)},alertSuccess:function(content){opt.modal.alert(content,opt.variable.modal_status.SUCCESS)},alertInfo:function(content){opt.modal.alert(content,"")},success:function(msg,callback){opt.selfLayer.alert(msg,{icon:1,closeBtn:0,title:$.i18n.prop("系统提示"),anim:1,yes:function(index){if(typeof(callback)==="function"){callback("ok")}opt.selfLayer.close(index)}})},error:function(msg,callback){opt.error(msg,callback)},warning:function(msg,callback){opt.warning(msg,callback)},alertWarning:function(content){opt.modal.alert(content,opt.variable.modal_status.WARNING,true)},close:function(){var index=opt.selfLayer.getFrameIndex(window.name);if(opt.common.isNotEmpty(index)){opt.selfLayer.close(index)}else{opt.layer.closeAll()}},closeAll:function(){opt.selfLayer.closeAll();opt.layer.closeAll()},confirm:function(content,callback,shadeClose){opt.selfLayer.confirm(content,{icon:3,shadeClose:opt.common.isEmpty(shadeClose)?true:shadeClose,title:'<i class="fa fa-exclamation-circle"></i> '+$.i18n.prop("系统提示"),btn:['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")]},function(index){if(typeof(callback)==="function"){callback("ok")}opt.selfLayer.close(index)})},popupRight:function(title,url,isEdit,editFun,id){var width=150;var topp=50;if(top.location!==self.location){if($(top.window).outerWidth()<400){width=50}}else{topp=0;if($(window).outerWidth()<400){width=50}}opt.layer.open({type:2,scrollbar:false,anim:-1,closeBtn:0,move:false,title:title,shadeClose:true,outLeft:true,skin:"layui-anim layui-anim-rl",offset:[topp+"px",($(top.window?top.window:window).outerWidth()-($(window).outerWidth()-width))+"px"],area:[($(window).outerWidth()-width)+"px","100%"],success:function(layero,index){if(opt.common.isNotEmpty(isEdit)&&isEdit){var update=$('<div id="'+index+'" class="layui-right-update"><i class="fa fa-mail-reply-all"></i> 修改</div>').on("click",function(){opt.layer.close($(this).attr("id"));if(typeof editFun=="function"){window.setTimeout(function(){editFun(id)},200)}});if(!$(layero).find(".layui-right-update").html()){$(layero).find(".layui-layer-title").attr("style","font-size:13px;").before(update)}}else{var update=$('<div id="'+index+'" class="layui-right-update"><i class="fa fa fa-times-circle-o"></i> 关闭</div>').on("click",function(){opt.layer.close($(this).attr("id"))});if(!$(layero).find(".layui-right-update").html()){$(layero).find(".layui-layer-title").attr("style","font-size:13px;").before(update)}}},content:url})},open:function(title,url,width,height,callback,type){var full=false;if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){width="auto";height="auto";full=true}if(opt.common.isEmpty(title)){title=false}if(opt.common.isEmpty(url)){url="/404.html"}if(opt.common.isEmpty(width)){width=800}if(opt.common.isEmpty(height)){height=($(window).height()-50)}if(opt.common.isEmpty(type)){type=2}if(width!=="auto"||height!=="auto"){if(width>$(window).width()||height>$(window).height()){full=true}}var submit;if(!opt.common.isEmpty(callback)&&typeof callback=="function"){submit=function(index,layero){var iframeWin=layero.find("iframe")[0];if(typeof iframeWin.contentWindow.submitHandler=="function"){if(iframeWin.contentWindow.submitHandler(index,layero)){callback(index,layero,opt.selfLayer);return}}else{callback(index,layero,opt.selfLayer);return}}}else{submit=function(index,layero){var iframeWin=layero.find("iframe")[0];if(typeof iframeWin.contentWindow.submitHandler=="function"){iframeWin.contentWindow.submitHandler(index,layero);return}else{opt.selfLayer.close(index);return}}}opt.modal.loading($.i18n.prop("数据加载中，请稍后..."));var index=opt.selfLayer.open({type:type,area:[width+"px",height+"px"],fix:false,maxmin:true,title:$.i18n.prop(title),content:url,btn:['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")],shadeClose:true,yes:submit,success:function(layero,index){var iframeWin=layero.find("iframe")[0];if(!opt.common.isEmpty(iframeWin.contentWindow.onLoadSuccess)){iframeWin.contentWindow.onLoadSuccess(index,layero,opt.selfLayer)}opt.modal.closeLoading()},cancel:function(index){return true},end:function(){opt.modal.closeLoading()}});if(full){opt.selfLayer.full(index)}},openOptions:function(options){var _btn=opt.common.isEmpty(options.btn)?[]:options.btn;var _url=opt.common.isEmpty(options.url)?"/404.html":options.url;var _title=opt.common.isEmpty(options.title)?$.i18n.prop("系统窗口"):$.i18n.prop(options.title);var _width=opt.common.isEmpty(options.width)?"800":options.width;var _height=opt.common.isEmpty(options.height)?($(window).height()-50):options.height;var _framData=opt.common.isEmpty(options.fromData)?{}:options.fromData;var _type=opt.common.isEmpty(options.type)?2:options.type;var full=false;if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){_width="auto";_height="auto";full=true}var index;if(_width!=="auto"||_height!=="auto"){if(_width>$(window).width()||_height>$(window).height()){full=true}}if(options.clear){if(_btn.length==0){_btn=['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-trash-o"></i> '+$.i18n.prop("清除"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")]}}else{if(_btn.length==0){_btn=['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")]}}var _sf;if(opt.common.isNotEmpty(options.main)&&options.main){_sf=opt.layer;_height=opt.common.isEmpty(options.height)?($(top.window).height()-220):options.height}else{_sf=opt.selfLayer}if(opt.common.isEmpty(options.yes)){options.yes=function(index,layero){var iframeWin=layero.find("iframe")[0];if(typeof iframeWin.contentWindow.submitHandler=="function"){if(iframeWin.contentWindow.submitHandler(index,layero,_sf)){if(typeof options.callBack=="function"){options.callBack(index,layero,_sf)}}return}else{if(typeof options.callBack=="function"){options.callBack(index,layero,_sf);return}}}}index=_sf.open({type:_type,maxmin:true,title:_title,fix:false,area:[_width+"px",_height+"px"],content:_url,fromData:_framData,shadeClose:opt.common.isEmpty(options.shadeClose)?true:options.shadeClose,skin:options.skin,btn:_btn,yes:options.yes,btn2:function(index,layero){if(options.clear){options.clear(index,layero,_sf)}else{if(!opt.common.isEmpty(options.cancel)){options.cancel(index,layero)}_sf.close(index)}},btn3:function(index,layero){if(!opt.common.isEmpty(options.cancel)){options.cancel(index,layero)}_sf.close(index)},success:function(layero,index){var iframeWin=layero.find("iframe")[0];if(typeof(iframeWin.contentWindow.onLoadSuccess)==="function"){iframeWin.contentWindow.onLoadSuccess(options.obj,layero,index,_sf)}},cancel:function(index,layero){if(!opt.common.isEmpty(options.cancel)){options.cancel(index,layero)}return true}});if(full){_sf.full(index)}},openMainWin:function(options){var _url=opt.common.isEmpty(options.url)?"/404.html":options.url;var _title=opt.common.isEmpty(options.title)?$.i18n.prop("系统窗口"):$.i18n.prop(options.title);var _width=opt.common.isEmpty(options.width)?$(top.window).width()-100:options.width;var _height=opt.common.isEmpty(options.height)?$(top.window).height()-100:options.height;var _framData=opt.common.isEmpty(options.fromData)?{}:options.fromData;var full=false;if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){_width="auto";_height="auto";full=true}var index;if(_width!=="auto"||_height!=="auto"){if(_width>$(top.window).width()||_height>$(top.window).height()){full=true}}if(opt.common.isEmpty(options.but)){options.but=true}if(options.but){if(options.clear){_btn=['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-trash-o"></i> '+$.i18n.prop("清除"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")]}else{_btn=['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")]}if(!opt.common.isEmpty(options.callBack)){options.yes=function(index,layero){var iframeWin=layero.find("iframe")[0];if(typeof iframeWin.contentWindow.submitHandler=="function"){if(iframeWin.contentWindow.submitHandler(index,layero)){window.setTimeout(function(){options.callBack(index,layero,opt.layer)},100)}}else{options.callBack(index,layero,opt.layer)}}}else{options.yes=function(index,layero){var iframeWin=layero.find("iframe")[0];if(typeof iframeWin.contentWindow.submitHandler=="function"){if(iframeWin.contentWindow.submitHandler(index,layero)){window.setTimeout(function(){opt.layer.close(index)},100)}}else{opt.layer.close(index)}}}index=opt.layer.open({type:2,maxmin:true,shadeClose:true,title:_title,area:[_width+"px",_height+"px"],scrollbar:false,content:_url,fromData:_framData,success:function(layero,index){var iframeWin=layero.find("iframe")[0];if(typeof(iframeWin.contentWindow.onLoadSuccess)==="function"){iframeWin.contentWindow.onLoadSuccess(index,layero,opt.layer)}},btn:opt.common.isEmpty(options.btn)?_btn:options.btn,yes:options.yes,btn2:function(index,layero){if(options.clear){options.clear(index,layero,opt.layer)}else{opt.layer.close(index)}},btn3:function(index,layero){opt.layer.close(index)},cancel:function(index,layero){if(!opt.common.isEmpty(options.cancel)){options.cancel(index,layero)}return true}})}else{index=opt.layer.open({type:2,maxmin:true,shadeClose:true,title:_title,area:[_width+"px",_height+"px"],content:_url,success:function(layero,index){opt.selfLayer=opt.layer;var iframeWin=layero.find("iframe")[0];if(typeof(iframeWin.contentWindow.onLoadSuccess)==="function"){iframeWin.contentWindow.onLoadSuccess(index,layero,opt.layer)}}})}if(full){opt.layer.full(index)}},openFull:function(title,url,width,height){if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){width="auto";height="auto"}if(opt.common.isEmpty(title)){title=false}if(opt.common.isEmpty(url)){url="/404.html"}if(opt.common.isEmpty(width)){width=800}if(opt.common.isEmpty(height)){height=($(window).height()-50)}var index=opt.selfLayer.open({type:2,area:[width+"px",height+"px"],fix:false,maxmin:true,title:title,content:url,btn:['<i class="fa fa-check"></i> '+$.i18n.prop("确定"),'<i class="fa fa-close"></i> '+$.i18n.prop("取消")],shadeClose:true,yes:function(index,layero){var iframeWin=layero.find("iframe")[0];iframeWin.contentWindow.submitHandler(index,layero)},cancel:function(index){return true}});opt.selfLayer.full(index)},openView:function(name,url,width,height){var url=baseURL+"sys/component/fileViwe?fileName="+opt.common.encodeUrl(name)+"&fileUrl="+opt.common.encodeUrl(url);width=opt.common.isEmpty(width)?$(top.window).width()-200:width;height=opt.common.isEmpty(height)?$(top.window).height()-50:height;opt.layer?opt.layer.open({type:2,maxmin:false,shadeClose:true,title:false,area:[width+"px",height+"px"],content:url}):opt.modal.windowOpen(url)},windowOpen:function(url,title,width,height){width&&height||(width=window.screen.width-200,height=window.screen.height-150);var top=parseInt((window.screen.height-height)/2-20,10),left=parseInt((window.screen.width-width)/2,10);window.open(url,title,"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes,width="+width+",height="+height+",top="+top+",left="+left)},openTab:function(title,url){opt.createMenuItem(url,title)},parentTab:function(title,url){var dataId=window.frameElement.getAttribute("data-id");opt.createMenuItem(url,title);opt.closeItem(dataId)},closeTab:function(dataId){opt.closeItem(dataId)},disable:function(){var doc=window.top==window.parent?window.document:window.parent.document;try{$("a[class*=layui-layer-btn]",doc).addClass("layer-disabled");$('button[class="btn btn-sm btn-primary"]',doc).attr("disabled",true)}catch(e){}},enable:function(){var doc=window.top==window.parent?window.document:window.parent.document;try{$("a[class*=layui-layer-btn]",doc).removeClass("layer-disabled");$('button[class="btn btn-sm btn-primary"]',doc).attr("disabled",false)}catch(e){}},loading:function(message){if(opt.common.isEmpty(message)){$.blockUI()}else{$.blockUI({message:'<div class="loaderbox"><div class="loading-activity"></div> '+message+"</div>"})}},closeLoading:function(){setTimeout(function(){$.unblockUI()},50)},closeNowLoading:function(){if(top.location!=self.location){$(".content-wrapper",window.parent.document).unblock()}else{$.unblockUI()}},reload:function(){parent.location.reload()}},operate:{submit:function(url,type,dataType,data,callback,del){var config={url:url,type:type,dataType:dataType,data:data,beforeSend:function(){opt.modal.loading("正在处理中，请稍后...")},success:function(result){if(result.code==opt.variable.web_status.SUCCESS&&opt.table.options.type==opt.variable.table_type.bootstrapTable){if(!opt.common.isEmpty(del)&&del){if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var s=opt.common.getJsonValue(data,"ids").split(",");var column=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId;var selectedRows=opt.table.rememberSelecteds[opt.table.options.id];var p=[];if(opt.common.isNotEmpty(selectedRows)){for(var j=0;j<selectedRows.length;j++){for(var i=0;i<s.length;i++){if(opt.common.getJsonValue(selectedRows[j],column)===s[i]){p[p.length]=selectedRows[j];selectedRows.splice(j,1);j=j-1}}}}var selectedIds=opt.table.rememberSelectedIds[opt.table.options.id];if(opt.common.isNotEmpty(selectedIds)){for(var j=0;j<selectedIds.length;j++){for(var i=0;i<p.length;i++){if(opt.common.getJsonValue(p[i],column)===selectedIds[j]){selectedIds.splice(j,1);j=j-1}}}}}}}if(typeof callback=="function"){callback(result)}opt.operate.ajaxSuccess(result)}};opt.common.sendAjax(config)},delPost:function(url,data,callback){if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){opt.table.rememberSelecteds={};opt.table.rememberSelectedIds={}}opt.operate.submit(url,"post","json",data,callback)},post:function(url,data,callback){opt.operate.submit(url,"post","json",data,callback)},get:function(url,callback){opt.operate.submit(url,"get","json","",callback)},detail:function(id,title,width,height){opt.table.set();var _url=opt.operate.detailUrl(id);var _width=opt.common.isEmpty(width)?"800":width;var _height=opt.common.isEmpty(height)?($(window).height()-50):height;if(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)){_width="auto";_height="auto"}var options={title:opt.common.isEmpty(title)?opt.table.options.modalName+"详细":title,width:_width,height:_height,url:_url,btn:["关闭"],yes:function(index,layero){opt.layer.close(index)||opt.selfLayer.close(index)}};opt.modal.openOptions(options)},detailUrl:function(id){var url="/404.html";if(opt.common.isNotEmpty(id)){url=opt.table.options.detailUrl.replace("{id}",id)}else{var id=opt.common.isEmpty(opt.table.options.uniqueId)?$.table.selectFirstColumns():$.table.selectColumns(opt.table.options.uniqueId);if(id.length==0){opt.modal.alertWarning("请至少选择一条记录");return}url=opt.table.options.detailUrl.replace("{id}",id)}return url},del:function(id,tableId){if(opt.common.isNotEmpty(tableId)){opt.table.set(tableId)}else{opt.table.set()}if(opt.common.isEmpty(opt.table.options.delUrl)){opt.modal.msgError("delUrl 未传!");return}if(typeof bootTableCallback==="function"){var rows=$.table.selectAllColumnRows(tableId);rows=rows.length==0?[$.table.getRowByUniqueId(id)]:rows;if(!bootTableCallback(opt.table.options.id,"del",rows)){return}}opt.modal.confirm("确定删除该条"+opt.table.options.modalName+"信息吗？",function(){if(opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){var row=$("#"+opt.table.options.id).bootstrapTreeTable("getSelections")[0];var url;if(opt.common.isEmpty(row)){url=opt.table.options.delUrl}else{url=opt.table.options.delUrl.replace("{id}",row[opt.table.options.uniqueId])}opt.operate.get(url)}else{var url=opt.common.isEmpty(id)?opt.table.options.delUrl:opt.table.options.delUrl.replace("{id}",id);var data={ids:id};opt.operate.submit(url,"POST","json",data,"",true)}})},exe:function(id){opt.table.set();opt.modal.confirm("确定处理该条"+opt.table.options.modalName+"信息吗？",function(){var url=opt.common.isEmpty(id)?opt.table.options.exeUrl:opt.table.options.exeUrl.replace("{id}",id);if(opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){opt.operate.get(url)}else{var data={ids:id};opt.operate.submit(url,"POST","json",data)}})},delAll:function(tableId){if(opt.common.isEmpty(tableId)){opt.table.set()}else{opt.table.set(tableId)}if(opt.common.isEmpty(opt.table.options.delUrl)){opt.modal.msgError("delUrl 未传!");return}if(typeof bootTableCallback==="function"){var rows=$.table.selectAllColumnRows(tableId);if(!bootTableCallback(opt.table.options.id,"del",rows)){return}}var rows=opt.common.isEmpty(opt.table.options.uniqueId)?$.table.selectFirstColumns():$.table.selectColumns(opt.table.options.uniqueId);if(opt.common.isEmpty(rows)){opt.modal.error("请至少选择一条记录");return}opt.modal.confirm("确认要删除选中的"+rows.length+"条数据吗?",function(){var url=opt.table.options.delUrl;var data={ids:rows.join()};opt.operate.submit(url,"POST","json",data,"",true)})},clean:function(){opt.table.set();opt.modal.confirm("确定清空所有"+opt.table.options.modalName+"吗？",function(){var url=opt.table.options.cleanUrl;opt.operate.submit(url,"post","json","")})},add:function(id){opt.table.set();opt.modal.open("添加"+opt.table.options.modalName,opt.operate.addUrl(id))},exeDis:function(id,title){opt.table.set();opt.modal.open("处理["+title+"]",opt.operate.exeUrl(id))},addTab:function(id){opt.table.set();opt.modal.openTab("添加"+opt.table.options.modalName,opt.operate.addUrl(id))},addFull:function(id){opt.table.set();var url=opt.common.isEmpty(id)?opt.table.options.addUrl:opt.table.options.addUrl.replace("{id}",id);opt.modal.openFull("添加"+opt.table.options.modalName,url)},addUrl:function(id){opt.table.set();var url=opt.common.isEmpty(id)?opt.table.options.addUrl.replace("{id}",""):opt.table.options.addUrl.replace("{id}",id);return url},exeUrl:function(id){opt.table.set();var url=opt.common.isEmpty(id)?opt.table.options.exeUrl.replace("{id}",""):opt.table.options.exeUrl.replace("{id}",id);return url},edit:function(id,tableId){opt.table.set(tableId);if(opt.common.isEmpty(opt.table.options.editUrl)){opt.modal.msgError("editUrl 未传!");return}if(typeof bootTableCallback==="function"){var rows;if(opt.common.isEmpty(id)){rows=$.table.selectAllColumnRows(tableId);rows=rows.length==0?[$.table.getRowByUniqueId(id)]:rows}else{rows=[$.table.getRowByUniqueId(id)]}if(!bootTableCallback(opt.table.options.id,"edit",rows)){return}}if(opt.common.isEmpty(id)&&opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){var row=$("#"+opt.table.options.id).bootstrapTreeTable("getSelections")[0];if(opt.common.isEmpty(row)){opt.modal.error("请至少选择一条记录");return}var url=opt.table.options.editUrl.replace("{id}",row[opt.table.options.uniqueId]);opt.modal.open("修改"+opt.table.options.modalName,url)}else{opt.modal.open("修改"+opt.table.options.modalName,opt.operate.editUrl(id))}},view:function(id,edit,fun){var _self=this;opt.table.set();if(opt.common.isEmpty(opt.table.options.viewUrl)){opt.modal.msgError("viewUrl 未传!");return}if(opt.common.isEmpty(id)){opt.modal.error("id必须传!");return}if(opt.common.isEmpty(edit)){edit=false}else{edit=true}var url=opt.table.options.viewUrl.replace("{id}",id);opt.modal.popupRight(opt.table.options.modalName+"信息详情",url,edit,fun,id)},editTab:function(id,prefix,tableId){opt.table.set();if(opt.common.isEmpty(opt.table.options.editUrl)){opt.modal.msgError("editUrl 未传!");return}if(typeof bootTableCallback==="function"){var rows;if(opt.common.isEmpty(id)){rows=$.table.selectAllColumnRows(tableId);rows=rows.length==0?[$.table.getRowByUniqueId(id)]:rows}else{rows=[$.table.getRowByUniqueId(id)]}if(!bootTableCallback(opt.table.options.id,"edit",rows)){return}}if(opt.common.isEmpty(id)&&opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){var row=$("#"+opt.table.options.id).bootstrapTreeTable("getSelections")[0];if(opt.common.isEmpty(row)){opt.modal.error("请至少选择一条记录");return}var url=opt.table.options.editUrl.replace("{id}",row[opt.table.options.uniqueId]);opt.modal.openTab(opt.common.isEmpty(prefix)?"修改":prefix+opt.table.options.modalName,opt.operate.editUrl(id))}else{opt.modal.openTab(opt.common.isEmpty(prefix)?"修改":prefix+opt.table.options.modalName,opt.operate.editUrl(id))}},editFull:function(id){opt.table.set();var url="/404.html";if(opt.common.isNotEmpty(id)){url=opt.table.options.editUrl.replace("{id}",id)}else{var row=opt.common.isEmpty(opt.table.options.uniqueId)?$.table.selectFirstColumns():$.table.selectColumns(opt.table.options.uniqueId);url=opt.table.options.editUrl.replace("{id}",row)}opt.modal.openFull("修改"+opt.table.options.modalName,url)},editUrl:function(id){opt.table.set();var url="/404.html";if(opt.common.isNotEmpty(id)){url=opt.table.options.editUrl.replace("{id}",id)}else{var id=opt.common.isEmpty(opt.table.options.uniqueId)?$.table.selectFirstColumns():$.table.selectColumns(opt.table.options.uniqueId);if(id.length==0){opt.modal.error("请至少选择一条记录");return}url=opt.table.options.editUrl.replace("{id}",id)}return url},save:function(url,data,callback){var config={url:url,type:"post",dataType:"json",data:data,beforeSend:function(){opt.modal.disable();opt.modal.loading($.i18n.prop("数据加载中，请稍后..."))},success:function(result){if(typeof callback=="function"){opt.modal.closeLoading();callback(result)}else{opt.operate.successCallback(result)}}};opt.common.sendAjax(config)},saveModal:function(url,data,callback){var config={url:url,type:"post",dataType:"json",data:data,beforeSend:function(){opt.modal.loading($.i18n.prop("数据加载中，请稍后..."))},success:function(result){opt.modal.closeLoading();if(typeof callback=="function"){callback(result);return}if(result.code==opt.variable.web_status.SUCCESS){opt.modal.success($.i18n.prop("操作成功!"))}else{if(result.code==opt.variable.web_status.WARNING){opt.modal.warning(result.msg)}else{opt.modal.error(result.msg)}}}};opt.common.sendAjax(config)},saveTab:function(url,data,callback){var config={url:url,type:"POST",dataType:"JSON",data:data,beforeSend:function(){opt.modal.loading($.i18n.prop("数据加载中，请稍后..."))},success:function(result){if(typeof callback=="function"){opt.modal.closeLoading();callback(result)}else{opt.operate.successTabCallback(result)}}};opt.common.sendAjax(config)},ajaxSuccess:function(result){if(result.code==opt.variable.web_status.SUCCESS&&opt.table.options.type==opt.variable.table_type.bootstrapTable){opt.success($.i18n.prop("操作成功!"));$.table.refresh()}else{if(result.code==opt.variable.web_status.SUCCESS&&opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){opt.success($.i18n.prop("操作成功!"));$.treeTable.refresh()}else{if(result.code==opt.variable.web_status.SUCCESS){opt.success($.i18n.prop("操作成功!"))}else{if(result.code==opt.variable.web_status.WARNING){opt.modal.warning(result.msg)}else{opt.modal.error(result.msg)}}}}opt.modal.closeLoading()},saveSuccess:function(result){if(result.code==opt.variable.web_status.SUCCESS){opt.modal.msgReload("保存成功,正在刷新数据请稍后……",opt.variable.modal_status.SUCCESS)}else{if(result.code==opt.variable.web_status.WARNING){opt.modal.alertWarning(result.msg)}else{opt.modal.alertError(result.msg)}}opt.modal.closeLoading()},successCallback:function(result){opt.modal.closeLoading();if(result.code==opt.variable.web_status.SUCCESS){var parent=window.parent;if(parent.opt.table.options.type==opt.variable.table_type.bootstrapTable){parent.$.table.refresh();parent.opt.success("操作成功",parent.opt.modal.closeAll())}else{if(parent.opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){parent.$.treeTable.refresh();parent.opt.success("操作成功",parent.opt.modal.closeAll())}else{if(window.opt.table.options.type==opt.variable.table_type.bootstrapTable){window.$.table.refresh();window.opt.success("操作成功",parent.opt.modal.closeAll())}else{opt.modal.msgReload("保存成功,正在刷新数据请稍后……",opt.variable.modal_status.SUCCESS)}}}}else{if(result.code==opt.variable.web_status.WARNING){opt.modal.warning(result.msg)}else{opt.modal.error(result.msg)}}opt.modal.enable()},successTabCallback:function(result){opt.modal.closeLoading();if(top.location!=self.location){if(result.code==opt.variable.web_status.SUCCESS){var topWindow=$(window.parent.document);var currentId=$(".layui-tab-title",topWindow).find(".layui-this").children("em").attr("panel-id");if(opt.common.isNotEmpty(currentId)){var $contentWindow=$('iframe[data-id="'+currentId+'"]',topWindow)[0].contentWindow;$contentWindow.opt.success($.i18n.prop("操作成功!"))}else{parent.opt.success($.i18n.prop("操作成功!"))}opt.modal.closeTab()}else{if(result.code==opt.variable.web_status.WARNING){opt.modal.warning(result.msg)}else{opt.modal.error(result.msg)}}}else{opt.modal.closeTab()}},successTab:function(){if(top.location!=self.location){var topWindow=$(window.parent.document);var currentId=$(".layui-tab-title",topWindow).find(".layui-this").children("em").attr("panel-id");if(opt.common.isNotEmpty(currentId)){var $contentWindow=$('iframe[data-id="'+currentId+'"]',topWindow)[0].contentWindow;$contentWindow.opt.modal.msg($.i18n.prop("操作成功!"));if($contentWindow.opt.table.options.type==opt.variable.table_type.bootstrapTable){$contentWindow.$.table.refresh()}else{if($contentWindow.opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){$contentWindow.$.treeTable.refresh()}}}opt.modal.closeTab()}else{opt.modal.closeTab()}}},validate:{unique:function(o){var obj=$.parseJSON(o);if(obj.code===opt.variable.web_status.SUCCESS){return true}return"<i class='fa fa-times-circle'></i>  "+obj.msg},form:function(formId){var currentId;if(opt.common.isEmpty(formId)){if(opt.common.isEmpty(opt.table.options.formId)){currentId=$("form").attr("id")}else{currentId=opt.table.options.formId}}else{currentId=formId}return $("#"+currentId).validate().form()},reset:function(formId){var currentId;if(opt.common.isEmpty(formId)){if(opt.common.isEmpty(opt.table.options.formId)){currentId=$("form").attr("id")}else{currentId=opt.table.options.formId}}else{currentId=formId}return $("#"+currentId).validate().resetForm()},fromData:function(formId){var currentId;if(opt.common.isEmpty(formId)){if(opt.common.isEmpty(opt.table.options.formId)){currentId=$("form").attr("id")}else{currentId=opt.table.options.formId}}else{currentId=formId}return $("#"+currentId).serialize()}},form:{reset:function(tableId,formId,notName){var notNames=opt.common.isEmpty(notName)?[]:notName.split(",");opt.table.set(tableId);var currentId;if(opt.common.isEmpty(formId)){if(opt.common.isEmpty(opt.table.options.formId)){currentId=$("form").attr("id")}else{currentId=opt.table.options.formId}}else{currentId=formId}var inpt=$("#"+currentId).find("input, select");$.each(inpt,function(){if(this.tagName=="SELECT"){if(opt.common.isEmpty(notName)){$(this).val(null).trigger("change")}else{var temp=false;for(var i=0;i<notNames.length;i++){if($(this).attr("name")==notNames[i]){temp=true}}if(!temp){$(this).val(null).trigger("change")}}}else{if(this.tagName=="INPUT"){if(!(this.type=="hidden"&&opt.common.isNotEmpty($(this).data("refresh"))&&!$(this).data("refresh"))){this.value=""}}}});$("#"+currentId+" select").each(function(i){if(!opt.common.isEmpty($(this).attr("data-select2-id"))){if(opt.common.isEmpty(notName)){$(this).val(null).trigger("change")}else{var temp=false;for(var i=0;i<notNames.length;i++){if($(this).attr("name")==notNames[i]){temp=true}}if(!temp){$(this).val(null).trigger("change")}}}});if(opt.table.options.type==opt.variable.table_type.bootstrapTable){if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){opt.table.rememberSelecteds={};opt.table.rememberSelectedIds={}}if(opt.common.isEmpty(tableId)){$("#"+opt.table.options.id).bootstrapTable("refresh")}else{$("#"+tableId).bootstrapTable("refresh")}}else{if(opt.table.options.type==opt.variable.table_type.bootstrapTreeTable){if(opt.common.isEmpty(tableId)){$("#"+opt.table.options.id).bootstrapTreeTable("refresh",{__refre:true})}else{$("#"+tableId).bootstrapTreeTable("refresh",{__refre:true})}}}},submit:function(){if(typeof submitHandler=="function"){opt.modal.disable();submitHandler();opt.modal.enable()}else{opt.modal.error($.i18n.prop("页面必须存在[submitHandler]方法"))}},selectCheckeds:function(name){var checkeds="";$('input:checkbox[name="'+name+'"]:checked').each(function(i){if(0==i){checkeds=$(this).val()}else{checkeds+=(","+$(this).val())}});return checkeds},selectSelects:function(name){var selects="";$("#"+name+" option:selected").each(function(i){if(0==i){selects=$(this).val()}else{selects+=(","+$(this).val())}});return selects.split(",")},getInputValue:function(name){return $('input[name="'+name+'"]').val()},dataUp:function(options){var defaults={id:"form-user-saveUpdate",del:[],conversion:[]};var options=$.extend(defaults,options);var data=$("#"+options.id).serializeArray();for(var i=0;i<data.length;i++){if(opt.common.isEmpty(options.del)){break}for(var k=0;k<options.del.length;k++){if(data[i].name==options.del[k]){data.splice(i,1);if(i==0){i=0}else{i--}}}}for(var i=0;i<data.length;i++){if(opt.common.isEmpty(options.conversion)){break}for(var k=0;k<options.conversion.length;k++){if(data[i].name==options.conversion[k].name){if(options.conversion[k].value=="arr"){data[i].value=data[i].value.split(",")}if(options.conversion[k].value=="num"){data[i].value=Number(data[i].value)}}}}return data}}};opt.common.each(["String","Function","Array","Number","RegExp","Object","Date"],function(v){opt.common["is"+v]=function(obj){return Object.prototype.toString.apply(obj)=="[object "+v+"]"}});$(function(){if(!(self.frameElement&&self.frameElement.tagName=="IFRAME")&&opt.variable.isWatermark){opt.common.watermark({watermark_txt:"J2eeFAST 开源版本 v2.2.2"})}$('[data-toggle="tooltip"]').each(function(){$(this).tooltip()});setTimeout(function(){$('[data-index="_new"]').each(function(){$(this).addClass("jump5")})},2000);if($.fn.select2!==undefined){$.fn.select2.defaults.set("theme","bootstrap");$("select.form-control:not(.noselect2)").each(function(){if(typeof($(this).attr("multiple"))=="undefined"){$(this).select2({allowClear:false,placeholder:"请点击选择"})}else{$(this).select2({allowClear:true,placeholder:""})}})}if($.fn.iCheck!==undefined){$(".check-box:not(.noicheck),.radio-box:not(.noicheck)").each(function(){$(this).iCheck({checkboxClass:(typeof($(this).data("style"))=="undefined")?"icheckbox-blue":("icheckbox_"+($(this).data("style")||"square-blue")),radioClass:(typeof($(this).data("style"))=="undefined")?"iradio-blue":("iradio_"+($(this).data("style")||"square-blue"))})})}$('[data-toggle="popover"]').each(function(){$(this).popover()});if($(".select-time").length>0){layui.use("laydate",function(){var laydate=layui.laydate;var startDate=laydate.render({elem:"#startTime",max:$("#endTime").val(),theme:"default",type:$("#startTime").attr("data-type")||"date",trigger:"click",done:function(value,date){if(value!==""){endDate.config.min.year=date.year;endDate.config.min.month=date.month-1;endDate.config.min.date=date.date}else{endDate.config.min.year="";endDate.config.min.month="";endDate.config.min.date=""}$("#endTime").trigger("click")}});var endDate=laydate.render({elem:"#endTime",min:$("#startTime").val(),theme:"default",type:$("#endTime").attr("data-type")||"date",trigger:"click",done:function(value,date){if(value!==""){startDate.config.max.year=date.year;startDate.config.max.month=date.month-1;startDate.config.max.date=date.date}else{startDate.config.max.year="2099";startDate.config.max.month="12";startDate.config.max.date="31"}}})})}if($(".time-input").length>0){layui.use("laydate",function(){var com=layui.laydate;$(".time-input").each(function(index,item){var time=$(item);var type=time.attr("data-type")||"date";var format=time.attr("data-format")||"yyyy-MM-dd";var buttons=time.attr("data-btn")||"clear|now|confirm",newBtnArr=[];var callback=time.attr("data-callback")||{};if(buttons){if(buttons.indexOf("|")>0){var btnArr=buttons.split("|"),btnLen=btnArr.length;for(var j=0;j<btnLen;j++){if("clear"===btnArr[j]||"now"===btnArr[j]||"confirm"===btnArr[j]){newBtnArr.push(btnArr[j])}}}else{if("clear"===buttons||"now"===buttons||"confirm"===buttons){newBtnArr.push(buttons)}}}else{newBtnArr=["clear","now","confirm"]}com.render({elem:item,theme:"molv",trigger:"click",type:type,format:format,btns:newBtnArr,done:function(value,data){if(typeof window[callback]!="undefined"&&window[callback] instanceof Function){window[callback](value,data)}else{try{if(opt.common.isString(callback)){console.log(callback);eval(callback)||new Function(callback)}}catch(e){console.error(e)}}}})})})}var expandFlag;$("#expandAllBtn").click(function(){var dataExpand=opt.common.isEmpty(opt.table.options.expandAll)?true:opt.table.options.expandAll;expandFlag=opt.common.isEmpty(expandFlag)?dataExpand:expandFlag;if(!expandFlag){$.bttTable.bootstrapTreeTable("expandAll")}else{$.bttTable.bootstrapTreeTable("collapseAll")}expandFlag=expandFlag?false:true});if($("#keyword").length>0){$("#keyword").bind("focus",function focusKey(e){if($("#keyword").hasClass("empty")){$("#keyword").removeClass("empty")}}).bind("blur",function blurKey(e){if($("#keyword").val()===""){$("#keyword").addClass("empty")}$.tree.searchNode(e)}).bind("input propertychange",$.tree.searchNode)}$("body",document).on("keyup",this,function(e){if(e.which===27){opt.modal.closeAll()}});if($.fn.toTop!==undefined){if($.fn.layout!==undefined&&$(".ui-layout-center")){var _opt={win:$(".ui-layout-center"),doc:$(".ui-layout-center")};$("#scroll-up").toTop(_opt)}else{$("#scroll-up").toTop()}}$('a[data-toggle="formMore"]').each(function(){$(this).off("click").on("click",function(){var html=[];var formMore=$(this).parents("form").find(".select-list-more");var show=formMore.css("display");if(show=="block"){formMore.toggle("normal");html.push('<i class="fa fa-angle-double-down"></i>&nbsp;',$.i18n.prop("更多"))}else{formMore.fadeIn(500).css("display","block");html.push('<i class="fa fa-angle-double-up"></i>&nbsp;',$.i18n.prop("隐藏"))}$(this).empty().append(html.join(""))})})});window.opt=opt})(window.jQuery,window);(function(a){a.fn.toTop=function(c){var d=this;var f=(c&&c.hasOwnProperty("win"))?c.win:a(window);var e=(c&&c.hasOwnProperty("doc"))?c.doc:a("html, body");var b=a.extend({autohide:true,offset:50,speed:500,position:true,right:15,bottom:5},c);d.css({cursor:"pointer"});if(b.autohide){d.css("display","none")}if(b.position){d.css({position:"fixed",right:b.right,bottom:b.bottom})}d.click(function(){e.animate({scrollTop:0},b.speed)});f.scroll(function(){var g=f.scrollTop();if(b.autohide){if(g>b.offset){d.fadeIn(b.speed)}else{d.fadeOut(b.speed)}}})}}(jQuery));(function(a){a.extend({table:{init:function(c){var g={formId:"",id:"bootstrap-table",type:0,height:undefined,sidePagination:"server",sortName:"",sortOrder:"desc",pagination:true,pageSize:50,pageList:[50,100,150],toolbar:"toolbar",striped:false,escape:false,outcheckbox:true,firstLoad:true,showFooter:false,undefinedText:"-",emptyText:"-",search:false,showSearch:true,showPageGo:true,showRefresh:true,showColumns:true,resizable:false,showToggle:true,showExport:false,clickToSelect:true,singleSelect:false,paginationLoop:true,onSelectData:undefined,showPage:true,mobileResponsive:true,rememberSelected:true,_total:false,showPaginationSwitch:false,fixedColumns:false,fixedNumber:0,rightFixedColumns:false,rightFixedNumber:0,queryParams:a.table.queryParams,totalData:undefined,_totalColumns:[],rowStyle:{},showBorder:false,isFixedColumn:false};if(c.resizable){try{if(0!==_ColResizable){opt.error("模板引擎缺少引入表格拖动Libs['resizable']");return}}catch(f){opt.error("模板引擎缺少引入表格拖动Libs['resizable']");return}}var c=a.extend(g,c);if(c.outcheckbox&&(!opt.common.isEmpty(a("#"+c.toolbar+"-"+c.id+" .multiple").html())||!opt.common.isEmpty(a("#"+c.toolbar+"-"+c.id+" .single").html()))){var h=false;if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(c.columns[d] instanceof Array){for(var b=0;b<c.columns[d].length;b++){if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"checkbox"))){h=true;break}}if(h){break}}else{if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"checkbox"))){h=true;break}}}}if(!h){if(c.columns[0] instanceof Array){c.columns[c.columns.length-1].splice(0,0,{checkbox:true,field:"_state"})}else{c.columns.splice(0,0,{checkbox:true,field:"_state"})}}}if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(c.columns[0] instanceof Array){for(var b=0;b<c.columns[d].length;b++){if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"align"))){c.columns[d][b].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"halign"))){c.columns[d][b].halign="center"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d][b],"checkbox"))){c.columns[d][b].field="_state"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"radio"))){c.columns[d].field="_state"}}}else{if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"align"))){c.columns[d].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"halign"))){c.columns[d].halign="center"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"checkbox"))){c.columns[d].field="_state"}if(!opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"radio"))){c.columns[d].field="_state"}}}}opt.table.options=c;opt.table.config[c.id]=c;a.table.initEvent();a("#"+c.id).bootstrapTable({id:c.id,url:c.url,contentType:"application/x-www-form-urlencoded",method:"post",cache:false,height:c.height,striped:c.striped,sortable:true,sortStable:true,sortName:c.sortName,sortOrder:c.sortOrder,pagination:c.pagination,paginationLoop:c.paginationLoop,undefinedText:c.undefinedText,emptyText:c.emptyText,showPaginationSwitch:c.showPaginationSwitch,pageNumber:1,pageSize:c.pageSize,pageList:c.pageList,firstLoad:c.firstLoad,isFixedColumn:c.isFixedColumn,escape:c.escape,showFooter:c.showFooter,footerStyle:c.footerStyle,iconSize:"outline",toolbar:"#"+c.toolbar+"-"+c.id,sidePagination:c.sidePagination,search:c.search,showBorder:c.showBorder,searchText:c.searchText,showSearch:c.showSearch,showPageGo:c.showPageGo,showPage:c.showPage,showRefresh:c.showRefresh,showColumns:c.showColumns,showToggle:c.showToggle,showExport:c.showExport,uniqueId:c.uniqueId,clickToSelect:c.clickToSelect,singleSelect:c.singleSelect,mobileResponsive:c.mobileResponsive,detailView:c.detailView,onCheck:c.onCheck,onUncheck:c.onUncheck,onCheckAll:c.onCheckAll,onUncheckAll:c.onUncheckAll,onClickRow:c.onClickRow,onDblClickRow:c.onDblClickRow,onClickCell:c.onClickCell,onDblClickCell:c.onDblClickCell,onEditableSave:c.onEditableSave,onExpandRow:c.onExpandRow,rememberSelected:c.rememberSelected,fixedColumns:c.fixedColumns,fixedNumber:c.fixedNumber,resizable:c.resizable,rightFixedColumns:c.rightFixedColumns,rightFixedNumber:c.rightFixedNumber,onReorderRow:c.onReorderRow,queryParams:c.queryParams,rowStyle:c.rowStyle,columns:c.columns,responseHandler:a.table.responseHandler,onLoadSuccess:a.table.onLoadSuccess,exportOptions:c.exportOptions,detailFormatter:c.detailFormatter})},getOptionsIds:function(c){var d=opt.common.isEmpty(c)?",":c;var b="";a.each(opt.table.config,function(e,f){b+="#"+e+d});return b.substring(0,b.length-1)},queryParams:function(d){var c={__limit:d.limit,__page:d.offset/d.limit+1,searchValue:d.search,__sidx:d.sort,__order:d.order};opt.table.set(this.id);var b=opt.common.isEmpty(opt.table.options.formId)?a("form").attr("id"):opt.table.options.formId;return a.extend(c,opt.common.formToJSON(b))},tableTotalHtml:function(c){opt.table.set();var b="";if(!opt.common.isEmpty(opt.table.options.totalData)){return"<span>"+opt.common.getJsonValue(opt.table.options.totalData,c)+"</span>"}else{return""}},responseHandler:function(b){if(typeof opt.table.get(this.id).responseHandler=="function"){opt.table.get(this.id).responseHandler(b)}if(b.code==0){if(opt.common.isNotEmpty(opt.table.options.sidePagination)&&opt.table.options.sidePagination=="client"){return b.rows}else{if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var c=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId;a.each(b.data.list,function(e,g){if(opt.table.rememberSelectedIds[opt.table.options.id]){var l=false;for(var e=0;e<opt.table.rememberSelectedIds[opt.table.options.id].length;e++){if(opt.common.getJsonValue(g,c)==opt.table.rememberSelectedIds[opt.table.options.id][e]){l=true}}if(l){if(opt.common.isEmpty(opt.table.rememberSelecteds[opt.table.options.id])){opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,c)}else{var h=true;for(var d=0;d<opt.table.rememberSelecteds[opt.table.options.id].length;d++){if(opt.common.getJsonValue(g,c)==opt.common.getJsonValue(opt.table.rememberSelecteds[opt.table.options.id][d],c)){h=false;break}}if(h){var f=opt.table.rememberSelecteds[opt.table.options.id];opt.table.rememberSelecteds[opt.table.options.id]=_.union(f,g,c)}}}g._state=l}else{g._state=false}})}if(opt.common.isNotEmpty(opt.table.options._total)&&opt.table.options._total){opt.table.options.totalData=b.pageTotal}return{rows:b.data.list,total:b.data.totalCount}}}else{opt.modal.error(b.msg,function(){try{opt.closeItem()}catch(d){}});return{rows:[],total:0}}},initEvent:function(){var b=a.table.getOptionsIds();a(b).on(TABLE_EVENTS,function(){opt.table.set(this.id)});a(b).on("check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table",function(m,k){var c=a.table.affectedRowIds(k);if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var g=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});var d=opt.table.rememberSelectedIds[opt.table.options.id];var l=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isEmpty(d)&&opt.common.isEmpty(l)&&g.length>=1){opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,opt.table.options.uniqueId);opt.table.rememberSelectedIds[opt.table.options.id]=_.union([],a.table.affectedRowIds(g),opt.table.options.uniqueId)}if(!opt.table.options.singleSelect){var f=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId,h=a.inArray(m.type,["check","check-all"])>-1?"union":"difference";d=opt.table.rememberSelectedIds[opt.table.options.id];if(opt.common.isNotEmpty(d)){opt.table.rememberSelectedIds[opt.table.options.id]=_[h](d,c,f)}else{opt.table.rememberSelectedIds[opt.table.options.id]=_[h]([],c,f)}l=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(l)){opt.table.rememberSelecteds[opt.table.options.id]=_[h](l,k,f)}else{opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,f)}}else{opt.table.rememberSelecteds[opt.table.options.id]=_.union([],g,opt.table.options.uniqueId);opt.table.rememberSelectedIds[opt.table.options.id]=_.union([],a.table.affectedRowIds(g),opt.table.options.uniqueId)}}if(typeof opt.table.get(opt.table.options.id).onSelectData=="function"){if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){opt.table.get(opt.table.options.id).onSelectData(opt.table.rememberSelecteds[opt.table.options.id])}else{opt.table.get(opt.table.options.id).onSelectData(k)}}});a(b).on("check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table load-success.bs.table",function(){var c=opt.table.options.toolbar+"-"+opt.table.options.id;var e=opt.table.options.uniqueId;var d=opt.common.isEmpty(e)?a.table.selectFirstColumns():a.table.selectColumns(e);a("#"+c+" .multiple").toggleClass("disabled",!d.length);a("#"+c+" .single").toggleClass("disabled",d.length!=1)});a(b).off("click").on("click",".img-circle",function(){var g=a(this).attr("src");var f=a(this).data("target");var c=a(this).data("height")=="auto"?"":a(this).data("height");var d=a(this).data("name");var e=a(this).data("width")=="auto"?"":a(this).data("width");if(opt.common.equals("self",f)){opt.modal.openView(d,g,e,c)}else{if(opt.common.equals("blank",f)){window.open(g)}}});a(b).on("click",".tooltip-show",function(){var d=a(this).data("target");var c=a(this).prev();if(opt.common.equals("open",d)){opt.selfLayer.alert(c.val(),{title:"信息内容",shadeClose:true,btn:["确认"],btnclass:["btn btn-primary"]})}})},onLoadSuccess:function(d){if(typeof opt.table.get(this.id).onLoadSuccess=="function"){opt.table.get(this.id).onLoadSuccess(d)}a(".table [data-toggle='tooltip']").tooltip();if(opt.common.isNotEmpty(opt.table.options._total)&&opt.table.options._total){var b="汇总:&nbsp;&nbsp;";for(var c=0;c<opt.table.options._totalColumns.length;c++){b+=opt.table.options._totalColumns[c].title;b+=":";b+=opt.common.isEmpty(opt.common.getJsonValue(opt.table.options.totalData,opt.table.options._totalColumns[c].field))?"0.00":opt.common.getJsonValue(opt.table.options.totalData,opt.table.options._totalColumns[c].field)+"&nbsp;&nbsp;"}a("#_pageTotal").html(b)}a('.table [data-toggle="popover"]').popover();if(a.fn.iCheck!==undefined){a(".check-box:not(.noicheck),.radio-box:not(.noicheck)").each(function(){a(this).iCheck({checkboxClass:(typeof(a(this).data("style"))=="undefined")?"icheckbox-blue":("icheckbox_"+(a(this).data("style")||"square-blue")),radioClass:(typeof(a(this).data("style"))=="undefined")?"iradio-blue":("iradio_"+(a(this).data("style")||"square-blue"))})})}if(a(".table .time-input").length>0){layui.use("laydate",function(){var e=layui.laydate;a(".time-input").each(function(h,q){var f=a(q);var l=f.attr("data-type")||"date";var n=f.attr("data-format")||"yyyy-MM-dd";var k=f.attr("data-btn")||"clear|now|confirm",r=[];var p=f.attr("data-callback")||{};if(k){if(k.indexOf("|")>0){var m=k.split("|"),o=m.length;for(var g=0;g<o;g++){if("clear"===m[g]||"now"===m[g]||"confirm"===m[g]){r.push(m[g])}}}else{if("clear"===k||"now"===k||"confirm"===k){r.push(k)}}}else{r=["clear","now","confirm"]}e.render({elem:q,theme:"molv",trigger:"click",type:l,format:n,btns:r,done:function(t,s){if(typeof window[p]!="undefined"&&window[p] instanceof Function){window[p](t,s)}}})})})}if(a.fn.select2!==undefined){a.fn.select2.defaults.set("theme","bootstrap");a("select.form-control:not(.noselect2)").each(function(){if(typeof(a(this).attr("multiple"))=="undefined"){a(this).select2()}else{a(this).select2({allowClear:true,placeholder:""})}})}a.contextMenu({selector:".table a[data-target='copy']",trigger:"right",autoHide:true,items:{copy:{name:a.i18n.prop("复制文本"),icon:"fa-copy",callback:function(g,f){var e=a(this).prev();e.select();if(document.execCommand("copy")){window.opt.modal.msg(a.i18n.prop("复制成功")+"!")}}}}})},destroy:function(c){var b=opt.common.isEmpty(c)?opt.table.options.id:c;a("#"+b).bootstrapTable("destroy");delete opt.table.rememberSelectedIds[c];delete opt.table.rememberSelecteds[c]},serialNumber:function(f,g){var b=opt.common.isEmpty(g)?opt.table.options.id:g;var e=a("#"+b).bootstrapTable("getOptions");var d=e.pageSize;var c=e.pageNumber;return d*(c-1)+f+1},tooltip:function(l,c,e,f){var g=opt.common.isEmpty(c)?20:c;var k=opt.common.isEmpty(e)?false:e;var h="";var m=opt.common.nullToStr(l);var b=opt.common.isEmpty(f)?"copy":f;if(m.length>g){if(k){h="..."+m.substr(m.length-g,g)}else{h=m.substr(0,g)+"..."}m=m.replace(/\'/g,"&apos;");m=m.replace(/\"/g,"&quot;");var d=[];d.push(opt.common.sprintf('<input style="opacity: 0;position: absolute;z-index:-1" type="text" value="%s"/>',m));d.push(opt.common.sprintf('<a href="###" class="tooltip-show" data-toggle="tooltip" data-target="%s" title="%s">%s</a>',b,m,h));return d.join("")}else{h=m;return h}},dropdownToggle:function(b){var c=[];c.push('<div class="btn-group">');c.push('<button type="button" class="btn btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false">');c.push('<i class="fa fa-cog"></i>&nbsp;<span class="fa fa-chevron-down"></span></button>');c.push('<ul class="dropdown-menu">');c.push(b.replace(/<a/g,"<li><a").replace(/<\/a>/g,"</a></li>"));c.push("</ul>");c.push("</div>");return c.join("")},imageView:function(f,b,e,g){if(opt.common.isEmpty(e)){e="auto"}if(opt.common.isEmpty(b)){b="auto"}var c=opt.common.isEmpty(g)?"self":g;if(opt.common.isNotEmpty(f)){var d=opt.common.fileFromPath(f);return opt.common.sprintf("<img class='img-circle img-xs' data-height='%s' data-width='%s' data-target='%s' src='%s' data-name='%s'/>",b,e,c,f,d)}else{return opt.common.nullToStr(f)}},search:function(c,l,e){opt.table.set(c);var h;if(opt.common.isEmpty(l)){if(opt.common.isEmpty(opt.table.options.formId)){h=a("form").attr("id")}else{h=opt.table.options.formId}}else{h=l}var b=a("#"+h).find('a[data-toggle="formMore"]');var f=a("#"+h).find("div.select-list-more");if(opt.common.isNotEmpty(b)&&opt.common.isNotEmpty(f)&&f.css("display")){var k=f.css("display");var g=[];if(k=="block"){f.toggle("normal");g.push('<i class="fa fa-angle-double-down"></i>&nbsp;',a.i18n.prop("更多"));b.empty().append(g.join(""))}}var d=opt.common.isEmpty(c)?a("#"+opt.table.options.id).bootstrapTable("getOptions"):a("#"+c).bootstrapTable("getOptions");d.queryParams=function(n){var m=opt.common.formToJSON(h);if(opt.common.isNotEmpty(e)){a.each(e,function(o){m[o]=e[o]})}m.__limit=n.limit;m.__page=n.offset/n.limit+1;m.searchValue=n.search;m.__sidx=n.sort;m.__order=n.order;return m};if(opt.common.isNotEmpty(c)){a("#"+c).bootstrapTable("refresh",d)}else{a("#"+opt.table.options.id).bootstrapTable("refresh",d)}},exportExcel:function(b){opt.table.set();opt.modal.confirm("确定导出所有"+opt.table.options.modalName+"吗？",function(){var c=opt.common.isEmpty(b)?a("form").attr("id"):b;opt.modal.loading("正在导出数据，请稍后...");var d={type:"POST",url:opt.table.options.exportUrl,data:a("#"+c).serializeArray(),success:function(e){if(e.code==opt.variable.web_status.SUCCESS){window.location.href=baseURL+"excel/download?fileName="+encodeURI(e.msg)}else{if(e.code==opt.variable.web_status.WARNING){opt.modal.alertWarning(e.msg)}else{opt.modal.alertError(e.msg)}}opt.modal.closeLoading()}};opt.common.sendAjax(d)})},importTemplate:function(b){b=window.encodeURI(b);opt.common.downLoadFile(baseURL+"excel/download?fileName="+b)},importExcel:function(c){opt.table.set();var b=opt.common.isEmpty(c)?"importTpl":c;opt.layer.open({type:1,area:["580px","200px"],shadeClose:true,resize:false,scrollbar:true,title:'<i class="fa fa-upload"></i> 导入'+opt.table.options.modalName+"数据",content:opt.template(b),btn:['<i class="fa fa-check"></i> 导入','<i class="fa fa-remove"></i> 取消'],shadeClose:true,btn1:function(f,d){var g=d.find("#file").val();if(g==""||(!opt.common.endWith(g,".xls")&&!opt.common.endWith(g,".xlsx"))){opt.warning("请选择后缀为 “xls”或“xlsx”的文件。");return false}parent.opt.modal.loading();var h=new FormData(d.find("form")[0]);var e={url:opt.table.options.importUrl,data:h,cache:false,contentType:false,processData:false,type:"POST",success:function(k){if(k.code==opt.variable.web_status.SUCCESS){parent.opt.modal.closeLoading();opt.error(k.msg);a.table.refresh()}else{if(k.code==opt.variable.web_status.WARNING){opt.error(k.msg);parent.opt.modal.closeLoading();opt.layer.close(f)}else{opt.error(k.msg);parent.opt.modal.closeLoading();opt.layer.close(f)}}},error:function(k,l){opt.error(JSON.parse(k.responseText).msg||k.responseText);parent.opt.modal.closeLoading();return}};opt.common.sendAjax(e)}})},refresh:function(c){var b=opt.common.isEmpty(c)?opt.table.options.id:c;a("#"+b).bootstrapTable("refresh",{silent:true})},getRowByUniqueId:function(d,c){opt.table.set(c);var b=opt.common.isEmpty(c)?opt.table.options.id:c;return a("#"+b).bootstrapTable("getRowByUniqueId",d)},selectColumns:function(b){var c=a.map(a("#"+opt.table.options.id).bootstrapTable("getSelections"),function(h){var f=h;var e=b.split(".");for(var g in e){f=f&&f[e[g]]}return f});if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(opt.table.rememberSelecteds[opt.table.options.id],function(h){var f=h;var e=b.split(".");for(var g in e){f=f&&f[e[g]]}return f})}}return opt.common.uniqueFn(c)},affectedRowIds:function(d){var f=opt.common.isEmpty(opt.table.options.uniqueId)?opt.table.options.columns[1].field:opt.table.options.uniqueId;var b;if(d instanceof Array){b=a.map(d,function(l){var h=l;var g=f.split(".");for(var k in g){h=h&&h[g[k]]}return h})}else{b=d;var c=f.split(".");for(var e in c){b=b&&b[c[e]]}b=[b]}return b},selectFirstColumns:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c=a.map(a("#"+opt.table.options.id).bootstrapTable("getSelections"),function(e){return e[opt.table.options.columns[1].field]});if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(d,function(e){return e[opt.table.options.columns[1].field]})}}return opt.common.uniqueFn(c)},selectAllColumns:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c;if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){c=a.map(d,function(e){return opt.common.getJsonValue(e,opt.table.options.uniqueId)})}else{c=[]}}if(opt.common.isEmpty(c)||c.length==0){c=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});c=a.table.affectedRowIds(c)}return opt.common.uniqueFn(c)},selectAllColumnRows:function(b){if(opt.common.isNotEmpty(b)){opt.table.set(b)}var c;if(opt.common.isNotEmpty(opt.table.options.rememberSelected)&&opt.table.options.rememberSelected){var d=opt.table.rememberSelecteds[opt.table.options.id];if(opt.common.isNotEmpty(d)){return d}else{c=[]}}if(opt.common.isEmpty(c)||c.length==0){c=a.map(a("#"+opt.table.options.id).bootstrapTable("getAllSelections"),function(e){return e});return c}},selectDictLabel:function(b,c){var d=[];a.each(b,function(f,g){if(g.dictValue==(""+c)){var e=opt.common.equals("default",g.listClass)||opt.common.isEmpty(g.listClass)?"":"badge badge-"+g.listClass;if(!opt.common.isEmpty(g.cssClass)){e=opt.common.isEmpty(g.cssClass)?"":g.cssClass}if(!opt.common.isEmpty(g.cssStyle)){e=g.cssStyle}if(!opt.common.isEmpty(g.cssStyle)){d.push(opt.common.sprintf("<span style='%s'>%s</span>",e,a.i18n.prop(g.dictLabel)))}else{d.push(opt.common.sprintf("<span class='%s'>%s</span>",e,a.i18n.prop(g.dictLabel)))}return false}if(opt.common.isEmpty(c)&&g.isDefault==="Y"){var e=opt.common.equals("default",g.listClass)||opt.common.isEmpty(g.listClass)?"":"badge badge-"+g.listClass;if(!opt.common.isEmpty(g.cssClass)){e=opt.common.isEmpty(g.cssClass)?"":g.cssClass}d.push(opt.common.sprintf("<span class='%s'>%s</span>",e,a.i18n.prop(g.dictLabel)));return false}});return d.join("")},selectDictLabels:function(c,b){var e=[];b=b+"";b=b||"";var d=b.split(",");a.each(d,function(f,g){a.each(c,function(k,l){if(l.dictValue==(""+g)){var h=opt.common.equals("default",l.listClass)||opt.common.isEmpty(l.listClass)?"":"badge badge-"+l.listClass;if(!opt.common.isEmpty(l.cssClass)){h=opt.common.isEmpty(l.cssClass)?"":l.cssClass}if(!opt.common.isEmpty(l.cssStyle)){h=l.cssStyle}if(!opt.common.isEmpty(l.cssStyle)){e.push(opt.common.sprintf("<span style='%s'>%s</span>",h,a.i18n.prop(l.dictLabel)))}else{e.push(opt.common.sprintf("<span class='%s'>%s</span>",h,a.i18n.prop(l.dictLabel)))}return false}if(opt.common.isEmpty(g)&&l.isDefault==="Y"){var h=opt.common.equals("default",l.listClass)||opt.common.isEmpty(l.listClass)?"":"badge badge-"+l.listClass;if(!opt.common.isEmpty(l.cssClass)){h=opt.common.isEmpty(l.cssClass)?"":l.cssClass}e.push(opt.common.sprintf("<span class='%s'>%s</span>",h,a.i18n.prop(l.dictLabel)));return false}})});return e.join(",")},showColumn:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("showColumn",c)},hideColumn:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("hideColumn",c)},uncheck:function(c,d){opt.table.set(d);var b=opt.common.isEmpty(d)?opt.table.options.id:d;a("#"+b).bootstrapTable("uncheck",c)},updataData:function(k,c){opt.table.set(c);var n=opt.common.isEmpty(c)?opt.table.options.id:c;var e=[];for(var o=0;o<=k;o++){var d=a("#"+n+' tr[data-index="'+o+'"] td');var g={};for(var h=0;h<d.length;h++){var b=a(d[h]).find("input");if(b.length==1){var s=a(d[h]).find("select");var q=opt.table.options.columns[h].field;if(opt.common.isNotEmpty(b.val())){g[q]=b.val()}else{if(opt.common.isNotEmpty(s.val())){g[q]=s.val()}else{g[q]=""}}}else{var s=a(d[h]).find("select");var q=opt.table.options.columns[h].field;if(opt.common.isNotEmpty(a(b[0]).val())){var m=a(b[1]).attr("name").split(".");if(m.length>1){g[q]=a(b[0]).val();var l=m;var f={},p=l.length-1;while(p>-1){var r={};r[l[p]]=f;f=r;if(p==(l.length-1)){f[l[p]]=a(b[1]).val()}p--}g=opt.common.extend(f,g)}else{g[q]=a(b[0]).val();g[a(b[1]).attr("name")]=a(b[1]).val()}}else{if(opt.common.isNotEmpty(s.val())){g[q]=s.val()}else{g[q]=""}}}}e.push({index:o,row:g})}a("#"+n).bootstrapTable("updateRow",e)},removeData:function(c,g){var f=this;opt.table.set();c=opt.common.isEmpty(c)?"index":c;var b=opt.common.isEmpty(g)?opt.table.options.id:g;var h=a("#"+b).bootstrapTable("getSelections");if(h.length==0){opt.modal.error(a.i18n.prop("请选择要删除的数据"));return}var e=a("#"+b).bootstrapTable("getData").length;f.updataData(e);var k=[];for(var d=0;d<h.length;d++){k[d]=h[d][c]}a("#"+opt.table.options.id).bootstrapTable("remove",{field:c,values:k})},addColumn:function(f,g,e){var d=this;opt.table.set(e);var b=opt.common.isEmpty(e)?opt.table.options.id:e;var c=a("#"+b).bootstrapTable("getData").length;d.updataData(c);a("#"+b).bootstrapTable("insertRow",{index:c+1,row:f});if(a(".time-input").length>0){layui.use("laydate",function(){var h=layui.laydate;a(".time-input").each(function(m,t){var k=a(t);var o=k.attr("data-type")||"date";var q=k.attr("data-format")||"yyyy-MM-dd";var n=k.attr("data-btn")||"clear|now|confirm",u=[];var s=k.attr("data-callback")||{};if(n){if(n.indexOf("|")>0){var p=n.split("|"),r=p.length;for(var l=0;l<r;l++){if("clear"===p[l]||"now"===p[l]||"confirm"===p[l]){u.push(p[l])}}}else{if("clear"===n||"now"===n||"confirm"===n){u.push(n)}}}else{u=["clear","now","confirm"]}h.render({elem:t,theme:"molv",trigger:"click",type:o,format:q,btns:u,done:function(w,v){if(typeof window[s]!="undefined"&&window[s] instanceof Function){window[s](w,v)}}})})})}if(typeof g=="function"){g(f)}}}})})(jQuery);(function(a){a.extend({bttTable:{},treeTable:{init:function(c){var e={id:"bootstrap-tree-table",type:1,height:0,rootIdValue:"0",ajaxParams:{},sortName:"",sortOrder:"asc",async:false,toolbar:"toolbar",striped:false,pageSize:12,pageList:[12,24,32],expandColumn:1,showSearch:true,showRefresh:true,showColumns:true,expandAll:true,expandFirst:true,bordered:false,asynUrl:null};var c=a.extend(e,c);var b=false;if(!opt.common.isEmpty(c.columns.length)){for(var d=0;d<c.columns.length;d++){if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"align"))){c.columns[d].align="center"}if(opt.common.isEmpty(opt.common.getJsonValue(c.columns[d],"halign"))){c.columns[d].halign="center"}if(opt.common.getJsonValue(c.columns[d],"field")==="selectItem"){b=true}}}if(!b){c.expandColumn=0}opt.table.options=c;opt.table.config[c.id]=c;a.bttTable=a("#"+c.id).bootstrapTreeTable({id:c.id,code:c.code,parentCode:c.parentCode,type:"post",url:c.url,async:c.async,asynUrl:c.asynUrl,data:c.data,ajaxParams:c.ajaxParams,sortName:c.sortName,sortOrder:c.sortOrder,rootIdValue:c.rootIdValue,height:c.height,pageSize:c.pageSize,pageList:c.pageList,expandColumn:c.expandColumn,striped:c.striped,bordered:c.bordered,toolbar:"#"+c.toolbar+"-"+c.id,showSearch:c.showSearch,showRefresh:c.showRefresh,showColumns:c.showColumns,expandAll:c.expandAll,expandFirst:c.expandFirst,columns:c.columns,onClickRow:a.treeTable.onClickRow,responseHandler:a.treeTable.responseHandler})},search:function(d){var b=opt.common.isEmpty(d)?a("form").attr("id"):d;var c=opt.common.formToJSON(b);c.__refre=true;a.bttTable.bootstrapTreeTable("refresh",c)},refresh:function(){a.bttTable.bootstrapTreeTable("refresh",{__refre:true})},selectColumns:function(b){var c=a.map(a.bttTable.bootstrapTreeTable("getSelections"),function(d){return d[b]});return opt.common.uniqueFn(c)},onClickRow:function(c){var b="toolbar-"+opt.table.get(this.id).id;a("#"+b+" .multiple").toggleClass("disabled",false);a("#"+b+" .single").toggleClass("disabled",false);if(typeof opt.table.get(this.id).onClickRow=="function"){opt.table.get(this.id).onClickRow(c)}},responseHandler:function(b){if(b.code!=undefined&&b.code!=0){opt.modal.error(b.msg);return[]}else{if(typeof opt.table.get(this.id).responseHandler=="function"){opt.table.get(this.id).responseHandler(b)}return b}}}})})(jQuery);(function(a){a.extend({_tree:{},tree:{_option:{},_lastValue:{},init:function(c){var e={ajxType:"GET",ajaxParams:{},id:"tree",expandLevel:0,view:{selectedMulti:false,nameIsHTML:true},check:{enable:true,radioType:"level",chkStyle:"radio",nocheckInherit:true},data:{key:{title:"name",name:"title"},simpleData:{enable:true}},displayLen:0};var c=a.extend(e,c);a.tree._option=c;var d={callback:{onClick:c.onClick,onCheck:c.onCheck,onDblClick:c.onDblClick,onCollapse:c.OnCollapse,onExpand:c.OnExpand,beforeClick:c.beforeClick},check:c.check,view:c.view,data:c.data};var b={url:c.url,type:c.ajxType,dataType:"JSON",data:c.ajaxParams,success:function(n){var m;if(opt.common.isArray(n)){m=n}else{if(n.code==opt.variable.web_status.SUCCESS){for(var h in n){if(opt.common.isArray(n[h])){m=n[h]}}for(var g=0;g<m.length;g++){for(var h in m[g]){if(h=="url"){delete m[g][h]}}}}else{opt.modal.error(n.msg);return}}if(c.displayLen!=0){for(var g=0;g<m.length;g++){for(var h in m[g]){if(h=="title"){m[g][h]=opt.common.subString(m[g][h],c.displayLen,true)}}}}var l=a("#treeId").val();tree=a.fn.zTree.init(a("#"+c.id),d,m);a._tree=tree;if(c.expandLevel==1){var k=tree.getNodesByFilter(function(o){return o.level==0},true);tree.expandNode(k,true,null,null)}if(c.expandLevel==2){tree.expandAll(true)}if(!opt.common.isEmpty(c._list)){var f=c._list.split(",");for(var g=0;g<f.length;g++){var k=tree.getNodeByParam(opt.common.isEmpty(c.data.simpleData.idKey)?"id":c.data.simpleData.idKey,f[g]);if(k!=null){tree.checkNode(k,true);tree.selectNode(k)}}}if(!opt.common.isEmpty(l)){var f=l.split(",");for(var g=0;g<f.length;g++){var k=tree.getNodeByParam(opt.common.isEmpty(c.data.simpleData.idKey)?"id":c.data.simpleData.idKey,f[g]);if(k!=null){tree.checkNode(k,true);tree.selectNode(k)}}}if(typeof(c.callBack)==="function"){c.callBack(a._tree)}}};opt.common.sendAjax(b)},expandAll:function(){a._tree.expandAll(true)},searchNode:function(){var c=opt.common.trim(a("#keyword").val());if(a.tree._lastValue==c){return}a.tree._lastValue=c;var b=a._tree.getNodes();if(c==""){a.tree.showAllNode(b);return}a.tree.hideAllNode(b);a.tree.updateNodes(a._tree.getNodesByParamFuzzy("name",c))},selectByIdName:function(c,b){if(opt.common.isNotEmpty(c)&&c==opt.common.getJsonValue(b,a.tree._option.data.simpleData.idKey)){a._tree.selectNode(b,true)}},showAllNode:function(b){b=a._tree.transformToArray(b);for(var c=b.length-1;c>=0;c--){if(b[c].getParentNode()!=null){a._tree.expandNode(b[c],true,false,false,false)}else{a._tree.expandNode(b[c],true,true,false,false)}a._tree.showNode(b[c]);a.tree.showAllNode(b[c].children)}},hideAllNode:function(c){var b=a.fn.zTree.getZTreeObj("tree");var c=a._tree.transformToArray(c);for(var d=c.length-1;d>=0;d--){a._tree.hideNode(c[d])}},showParent:function(c){var b;while((b=c.getParentNode())!=null){a._tree.showNode(b);a._tree.expandNode(b,true,false,false);c=b}},getParentIds:function(d){if(opt.common.isEmpty(d)){return""}var b=d.id;var c=d.getParentNode();if(c!=null){b=b+","+a.tree.getParentIds(c)}return b},showChildren:function(d){if(d.isParent){for(var b in d.children){var c=d.children[b];a._tree.showNode(c);a.tree.showChildren(c)}}},updateNodes:function(c){a._tree.showNodes(c);for(var d=0,b=c.length;d<b;d++){var e=c[d];a.tree.showChildren(e);a.tree.showParent(e)}},refreshNode:function(){a._tree.reAsyncChildNodes(null,"refresh")},getCheckedNodes:function(c){var e=opt.common.isEmpty(c)?(opt.common.isEmpty(a.tree._option.data.simpleData.idKey)?"id":a.tree._option.data.simpleData.idKey):c;var b=a._tree.getCheckedNodes(true);var d=a.map(b,function(f){return f[e]}).join();return d.split(",")},notAllowParents:function(b){return true},notAllowLastLevel:function(d){var b=d.getSelectedNodes();for(var c=0;c<b.length;c++){if(!b[c].isParent){a.modal.msgError("不能选择最后层级节点（"+b[c].name+"）");return false}}return true},toggleSearch:function(){a("#search").slideToggle(200);a("#btnShow").toggle();a("#btnHide").toggle();a("#keyword").focus()},checkAllNodes:function(b){a._tree.checkAllNodes(b)},collapse:function(){a._tree.expandAll(false)},expand:function(){a._tree.expandAll(true)},callBackTree:function(b,e){var m=b.find("iframe")[0].contentWindow.$._tree;if(a.tree.notAllowParents(m)){var g=layer.getChildFrame("body",e);var f=g.find("#treeId").val();var h=g.find("#treeName").val();var l=g.find("#parentIds").val();var d=g.find("#treeTitle").val();var k=g.find("#type").val();var c='{"id":"'+f+'","name":"'+h+'","title":"'+d+'","parentIds":"'+l+'","type":"'+k+'"}';return a.parseJSON(c)}else{return false}}}})})(jQuery);+function(){var b=opt.getCookie("_lang");$.i18n.properties({path:baseURL+"i18n/",name:"i18n",language:b,cache:true,mode:"map"});var a=opt.storage.get("skin");if(a&&($.inArray(a,opt.variable.skins)>=0)){opt.changeSkin(a)}if(window.layer!==undefined){layer.config({extend:"moon/style.css",skin:"layer-ext-moon"})}}();!function(){var b={open:"{{",close:"}}"};var a={exp:function(f){return new RegExp(f,"g")},query:function(h,f,k){var g=["#([\\s\\S])+?","([^{#}])*?"][h||0];return d((f||"")+b.open+g+b.close+(k||""))},escape:function(f){return String(f||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},error:function(h,f){var g="Laytpl Error：";typeof console==="object"&&console.error(g+h+"\n"+(f||""));return g+h}};var d=a.exp,e=function(f){this.tpl=f};e.pt=e.prototype;window.errors=0;e.pt.parse=function(g,k){var h=this,f=g;var m=d("^"+b.open+"#",""),n=d(b.close+"$","");g=g.replace(/\s+|\r|\t|\n/g," ").replace(d(b.open+"#"),b.open+"# ").replace(d(b.close+"}"),"} "+b.close).replace(/\\/g,"\\\\").replace(d(b.open+"!(.+?)!"+b.close),function(o){o=o.replace(d("^"+b.open+"!"),"").replace(d("!"+b.close),"").replace(d(b.open+"|"+b.close),function(p){return p.replace(/(.)/g,"\\$1")});return o}).replace(/(?="|')/g,"\\").replace(a.query(),function(o){o=o.replace(m,"").replace(n,"");return'";'+o.replace(/\\/g,"")+';view+="'}).replace(a.query(1),function(o){var p='"+(';if(o.replace(/\s/g,"")===b.open+b.close){return""}o=o.replace(d(b.open+"|"+b.close),"");if(/^=/.test(o)){o=o.replace(/^=/,"");p='"+_escape_('}return p+o.replace(/\\/g,"")+')+"'});g='"use strict";var view = "'+g+'";return view;';try{h.cache=g=new Function("d, _escape_",g);return g(k,a.escape)}catch(l){delete h.cache;return a.error(l,f)}};e.pt.render=function(h,k){var g=this,f;if(!h){return a.error("no data")}f=g.cache?g.cache(h,a.escape):g.parse(g.tpl,h);if(!k){return f}k(f)};var c=function(f){if(typeof f!=="string"){return a.error("Template not found")}return new e(f)};c.config=function(f){f=f||{};for(var g in f){b[g]=f[g]}};c.v="1.2.0";"function"==typeof define?define(function(){return c}):"undefined"!=typeof exports?module.exports=c:window.laytpl=c}();+function(d){var b="lte.boxwidget";var f={animationSpeed:500,collapseTrigger:'[data-widget="collapse"]',removeTrigger:'[data-widget="remove"]',collapseIcon:"fa-minus",expandIcon:"fa-plus",removeIcon:"fa-times"};var a={data:".box",collapsed:".collapsed-box",header:".box-header",body:".box-body",footer:".box-footer",tools:".box-tools"};var h={collapsed:"collapsed-box"};var k={collapsing:"collapsing.boxwidget",collapsed:"collapsed.boxwidget",expanding:"expanding.boxwidget",expanded:"expanded.boxwidget",removing:"removing.boxwidget",removed:"removed.boxwidget"};var e=function(m,l){this.element=m;this.options=l;this._setUpListeners()};e.prototype.toggle=function(){var l=!d(this.element).is(a.collapsed);if(l){this.collapse()}else{this.expand()}};e.prototype.expand=function(){var n=d.Event(k.expanded);var o=d.Event(k.expanding);var m=this.options.collapseIcon;var l=this.options.expandIcon;d(this.element).removeClass(h.collapsed);d(this.element).children(a.header+", "+a.body+", "+a.footer).children(a.tools).find("."+l).removeClass(l).addClass(m);d(this.element).children(a.body+", "+a.footer).slideDown(this.options.animationSpeed,function(){d(this.element).trigger(n)}.bind(this)).trigger(o)};e.prototype.collapse=function(){var m=d.Event(k.collapsed);var o=d.Event(k.collapsing);var n=this.options.collapseIcon;var l=this.options.expandIcon;d(this.element).children(a.header+", "+a.body+", "+a.footer).children(a.tools).find("."+n).removeClass(n).addClass(l);d(this.element).children(a.body+", "+a.footer).slideUp(this.options.animationSpeed,function(){d(this.element).addClass(h.collapsed);d(this.element).trigger(m)}.bind(this)).trigger(expandingEvent)};e.prototype.remove=function(){var l=d.Event(k.removed);var m=d.Event(k.removing);d(this.element).slideUp(this.options.animationSpeed,function(){d(this.element).trigger(l);d(this.element).remove()}.bind(this)).trigger(m)};e.prototype._setUpListeners=function(){var l=this;d(this.element).on("click",this.options.collapseTrigger,function(m){if(m){m.preventDefault()}l.toggle(d(this));return false});d(this.element).on("click",this.options.removeTrigger,function(m){if(m){m.preventDefault()}l.remove(d(this));return false})};function g(l){return this.each(function(){var o=d(this);var n=o.data(b);if(!n){var m=d.extend({},f,o.data(),typeof l=="object"&&l);o.data(b,(n=new e(o,m)))}if(typeof l=="string"){if(typeof n[l]=="undefined"){throw new Error("No method named "+l)}n[l]()}})}var c=d.fn.boxWidget;d.fn.boxWidget=g;d.fn.boxWidget.Constructor=e;d.fn.boxWidget.noConflict=function(){d.fn.boxWidget=c;return this};d(window).on("load",function(){d(a.data).each(function(){g.call(d(this))})})}(jQuery);(function(a,b){b.fn.serializeJson=function(){var c={};var d=this.serializeArray();b(d).each(function(){if(c[this.name]){if(b.isArray(c[this.name])){c[this.name].push(this.value)}else{c[this.name]=[c[this.name],this.value]}}else{c[this.name]=this.value}});return c}})(window,jQuery);
