/*!
 * Copyright (c) 2020-Now http://www.j2eefast.com All rights reserved.
 * No deletion without permission
 * @author ZhouZhou 国密加密
 */
eval(function(e,l,c,a,j,k){j=function(b){return(b<l?"":j(parseInt(b/l)))+((b=b%l)>35?String.fromCharCode(b+29):b.toString(36))};if(!"".replace(/^/,String)){while(c--){k[j(c)]=a[c]||j(c)}a=[function(b){return k[b]}];j=function(){return"\\w+"};c=1}while(c--){if(a[c]){e=e.replace(new RegExp("\\b"+j(c)+"\\b","g"),a[c])}}return e}('D 1C;D 3d=5T;D 2F=(3d&5U)==5V;H J(e,d,f){E(e!=V){E("3e"==2G e){C.2H(e,d,f)}K{E(d==V&&"5W"!=2G e){C.2u(e,1J)}K{C.2u(e,d)}}}}H Q(){F M J(V)}H 3f(f,a,b,e,h,g){N(--g>=0){D d=a*C[f++]+b[e]+h;h=12.1D(d/5X);b[e++]=d&5Y}F h}H 3g(f,q,r,e,o,a){D k=q&2g,p=q>>15;N(--a>=0){D d=C[f]&2g;D g=C[f++]>>15;D b=p*d+g*k;d=k*d+((b&2g)<<15)+r[e]+(o&3h);o=(d>>>30)+(b>>>15)+p*g+(o>>>30);r[e++]=d&3h}F o}H 3i(f,q,r,e,o,a){D k=q&2I,p=q>>14;N(--a>=0){D d=C[f]&2I;D g=C[f++]>>14;D b=p*d+g*k;d=k*d+((b&2I)<<14)+r[e]+o;o=(d>>28)+(b>>14)+p*g;r[e++]=d&5Z}F o}E(2F&&2v.2J=="60 62 63"){J.I.1q=3g;1C=30}K{E(2F&&2v.2J!="3j"){J.I.1q=3f;1C=26}K{J.I.1q=3i;1C=28}}J.I.P=1C;J.I.1e=(1<<1C)-1;J.I.1l=1<<1C;D 2w=52;J.I.3k=12.2h(2,2w);J.I.2K=2w-1C;J.I.2L=2*1C-2w;D 3l="64";D 2i=M 1P();D 1Q,1r;1Q="0".2j(0);T(1r=0;1r<=9;++1r){2i[1Q++]=1r}1Q="a".2j(0);T(1r=10;1r<36;++1r){2i[1Q++]=1r}1Q="A".2j(0);T(1r=10;1r<36;++1r){2i[1Q++]=1r}H 2M(a){F 3l.2N(a)}H 2O(b,a){D d=2i[b.2j(a)];F d==V?-1:d}H 3m(b){T(D a=C.t-1;a>=0;--a){b[a]=C[a]}b.t=C.t;b.s=C.s}H 3n(a){C.t=1;C.s=a<0?-1:0;E(a>0){C[0]=a}K{E(a<-1){C[0]=a+C.1l}K{C.t=0}}}H 1E(a){D b=Q();b.1X(a);F b}H 3o(h,c){D e;E(c==16){e=4}K{E(c==8){e=3}K{E(c==1J){e=8}K{E(c==2){e=1}K{E(c==32){e=5}K{E(c==4){e=2}K{C.3p(h,c);F}}}}}}C.t=0;C.s=0;D g=h.1a,d=1v,f=0;N(--g>=0){D a=e==8?h[g]&1m:2O(h,g);E(a<0){E(h.2N(g)=="-"){d=1w}3q}d=1v;E(f==0){C[C.t++]=a}K{E(f+e>C.P){C[C.t-1]|=(a&(1<<C.P-f)-1)<<f;C[C.t++]=a>>C.P-f}K{C[C.t-1]|=a<<f}}f+=e;E(f>=C.P){f-=C.P}}E(e==8&&(h[0]&2x)!=0){C.s=-1;E(f>0){C[C.t-1]|=(1<<C.P-f)-1<<f}}C.1n();E(d){J.1c.U(C,C)}}H 3r(){D a=C.s&C.1e;N(C.t>0&&C[C.t-1]==a){--C.t}}H 3s(c){E(C.s<0){F"-"+C.1x().1R(c)}D e;E(c==16){e=4}K{E(c==8){e=3}K{E(c==2){e=1}K{E(c==32){e=5}K{E(c==4){e=2}K{F C.3t(c)}}}}}D g=(1<<e)-1,l,a=1v,h="",f=C.t;D j=C.P-f*C.P%e;E(f-->0){E(j<C.P&&(l=C[f]>>j)>0){a=1w;h=2M(l)}N(f>=0){E(j<e){l=(C[f]&(1<<j)-1)<<e-j;l|=C[--f]>>(j+=C.P-e)}K{l=C[f]>>(j-=e)&g;E(j<=0){j+=C.P;--f}}E(l>0){a=1w}E(a){h+=2M(l)}}}F a?h:"0"}H 3u(){D a=Q();J.1c.U(C,a);F a}H 3v(){F C.s<0?C.1x():C}H 3w(b){D d=C.s-b.s;E(d!=0){F d}D c=C.t;d=c-b.t;E(d!=0){F C.s<0?-d:d}N(--c>=0){E((d=C[c]-b[c])!=0){F d}}F 0}H 2k(a){D c=1,b;E((b=a>>>16)!=0){a=b;c+=16}E((b=a>>8)!=0){a=b;c+=8}E((b=a>>4)!=0){a=b;c+=4}E((b=a>>2)!=0){a=b;c+=2}E((b=a>>1)!=0){a=b;c+=1}F c}H 3x(){E(C.t<=0){F 0}F C.P*(C.t-1)+2k(C[C.t-1]^C.s&C.1e)}H 3y(c,b){D a;T(a=C.t-1;a>=0;--a){b[a+c]=C[a]}T(a=c-1;a>=0;--a){b[a]=0}b.t=C.t+c;b.s=C.s}H 3z(c,b){T(D a=c;a<C.t;++a){b[a-c]=C[a]}b.t=12.2P(C.t-c,0);b.s=C.s}H 3A(j,e){D b=j%C.P;D a=C.P-b;D g=(1<<a)-1;D f=12.1D(j/C.P),h=C.s<<b&C.1e,d;T(d=C.t-1;d>=0;--d){e[d+f+1]=C[d]>>a|h;h=(C[d]&g)<<b}T(d=f-1;d>=0;--d){e[d]=0}e[f]=h;e.t=C.t+f+1;e.s=C.s;e.1n()}H 3B(g,d){d.s=C.s;D e=12.1D(g/C.P);E(e>=C.t){d.t=0;F}D b=g%C.P;D a=C.P-b;D f=(1<<b)-1;d[0]=C[e]>>b;T(D c=e+1;c<C.t;++c){d[c-e-1]|=(C[c]&f)<<a;d[c-e]=C[c]>>b}E(b>0){d[C.t-e-1]|=(C.s&f)<<a}d.t=C.t-e;d.1n()}H 3C(d,f){D e=0,g=0,b=12.1Y(d.t,C.t);N(e<b){g+=C[e]-d[e];f[e++]=g&C.1e;g>>=C.P}E(d.t<C.t){g-=d.s;N(e<C.t){g+=C[e];f[e++]=g&C.1e;g>>=C.P}g+=C.s}K{g+=C.s;N(e<d.t){g-=d[e];f[e++]=g&C.1e;g>>=C.P}g-=d.s}f.s=g<0?-1:0;E(g<-1){f[e++]=C.1l+g}K{E(g>0){f[e++]=g}}f.t=e;f.1n()}H 3D(c,e){D b=C.1F(),f=c.1F();D d=b.t;e.t=d+f.t;N(--d>=0){e[d]=0}T(d=0;d<f.t;++d){e[d+b.t]=b.1q(0,f[d],e,d,0,b.t)}e.s=0;e.1n();E(C.s!=c.s){J.1c.U(e,e)}}H 3E(d){D a=C.1F();D b=d.t=2*a.t;N(--b>=0){d[b]=0}T(b=0;b<a.t-1;++b){D e=a.1q(b,a[b],d,2*b,0,1);E((d[b+a.t]+=a.1q(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.1l){d[b+a.t]-=a.1l;d[b+a.t+1]=1}}E(d.t>0){d[d.t-1]+=a.1q(b,a[b],d,2*b,0,1)}d.s=0;d.1n()}H 3F(n,h,g){D w=n.1F();E(w.t<=0){F}D k=C.1F();E(k.t<w.t){E(h!=V){h.1X(0)}E(g!=V){C.1G(g)}F}E(g==V){g=Q()}D d=Q(),a=C.s,l=n.s;D v=C.P-2k(w[w.t-1]);E(v>0){w.1Z(v,d);k.1Z(v,g)}K{w.1G(d);k.1G(g)}D p=d.t;D b=d[p-1];E(b==0){F}D o=b*(1<<C.2K)+(p>1?d[p-2]>>C.2L:0);D B=C.3k/o,A=(1<<C.2K)/o,x=1<<C.2L;D u=g.t,s=u-p,f=h==V?Q():h;d.20(s,f);E(g.Y(f)>=0){g[g.t++]=1;g.U(f,g)}J.1h.20(p,f);f.U(d,d);N(d.t<p){d[d.t++]=0}N(--s>=0){D c=g[--u]==b?C.1e:12.1D(g[u]*B+(g[u-1]+x)*A);E((g[u]+=d.1q(0,c,g,s,0,p))<c){d.20(s,f);g.U(f,g);N(g[u]<--c){g.U(f,g)}}}E(h!=V){g.2l(p,h);E(a!=l){J.1c.U(h,h)}}g.t=p;g.1n();E(v>0){g.1i(v,g)}E(a<0){J.1c.U(g,g)}}H 3G(b){D c=Q();C.1F().1H(b,V,c);E(C.s<0&&c.Y(J.1c)>0){b.U(c,c)}F c}H 1K(a){C.m=a}H 3H(a){E(a.s<0||a.Y(C.m)>=0){F a.Z(C.m)}K{F a}}H 3I(a){F a}H 3J(a){a.1H(C.m,V,a)}H 3K(a,c,b){a.21(c,b);C.1y(b)}H 3L(a,b){a.22(b);C.1y(b)}1K.I.25=3H;1K.I.27=3I;1K.I.1y=3J;1K.I.1S=3K;1K.I.1z=3L;H 3M(){E(C.t<1){F 0}D a=C[0];E((a&1)==0){F 0}D b=a&3;b=b*(2-(a&15)*b)&15;b=b*(2-(a&1m)*b)&1m;b=b*(2-((a&2y)*b&2y))&2y;b=b*(2-a*b%C.1l)%C.1l;F b>0?C.1l-b:-b}H 1L(a){C.m=a;C.2Q=a.3N();C.2R=C.2Q&2g;C.3O=C.2Q>>15;C.3P=(1<<a.P-15)-1;C.3Q=2*a.t}H 3R(a){D b=Q();a.1F().20(C.m.t,b);b.1H(C.m,V,b);E(a.s<0&&b.Y(J.1c)>0){C.m.U(b,b)}F b}H 3S(a){D b=Q();a.1G(b);C.1y(b);F b}H 3T(a){N(a.t<=C.3Q){a[a.t++]=0}T(D c=0;c<C.m.t;++c){D b=a[c]&2g;D d=b*C.2R+((b*C.3O+(a[c]>>15)*C.2R&C.3P)<<15)&a.1e;b=c+C.m.t;a[b]+=C.m.1q(0,d,a,c,0,C.m.t);N(a[b]>=a.1l){a[b]-=a.1l;a[++b]++}}a.1n();a.2l(C.m.t,a);E(a.Y(C.m)>=0){a.U(C.m,a)}}H 3U(a,b){a.22(b);C.1y(b)}H 3V(a,c,b){a.21(c,b);C.1y(b)}1L.I.25=3R;1L.I.27=3S;1L.I.1y=3T;1L.I.1S=3V;1L.I.1z=3U;H 3W(){F(C.t>0?C[0]&1:C.s)==0}H 3X(h,j){E(h>65||h<1){F J.1h}D f=Q(),a=Q(),d=j.25(C),c=2k(h)-1;d.1G(f);N(--c>=0){j.1z(f,a);E((h&1<<c)>0){j.1S(a,d,f)}K{D b=f;f=a;a=b}}F j.27(f)}H 3Y(b,a){D c;E(b<1J||a.1j()){c=M 1K(a)}K{c=M 1L(a)}F C.2S(b,c)}J.I.1G=3m;J.I.1X=3n;J.I.2u=3o;J.I.1n=3r;J.I.20=3y;J.I.2l=3z;J.I.1Z=3A;J.I.1i=3B;J.I.U=3C;J.I.21=3D;J.I.22=3E;J.I.1H=3F;J.I.3N=3M;J.I.1j=3W;J.I.2S=3X;J.I.1R=3s;J.I.1x=3u;J.I.1F=3v;J.I.Y=3w;J.I.1A=3x;J.I.Z=3G;J.I.3Z=3Y;J.1c=1E(0);J.1h=1E(1);H 40(){D a=Q();C.1G(a);F a}H 42(){E(C.s<0){E(C.t==1){F C[0]-C.1l}K{E(C.t==0){F-1}}}K{E(C.t==1){F C[0]}K{E(C.t==0){F 0}}}F(C[1]&(1<<32-C.P)-1)<<C.P|C[0]}H 44(){F C.t==0?C.s:C[0]<<24>>24}H 45(){F C.t==0?C.s:C[0]<<16>>16}H 46(a){F 12.1D(12.66*C.P/12.68(a))}H 49(){E(C.s<0){F-1}K{E(C.t<=0||C.t==1&&C[0]<=0){F 0}K{F 1}}}H 4a(c){E(c==V){c=10}E(C.1s()==0||c<2||c>36){F"0"}D f=C.2T(c);D e=12.2h(c,f);D i=1E(e),j=Q(),h=Q(),g="";C.1H(i,j,h);N(j.1s()>0){g=(e+h.2U()).1R(c).1T(1)+g;j.1H(i,j,h)}F h.2U().1R(c)+g}H 4b(m,h){C.1X(0);E(h==V){h=10}D f=C.2T(h);D g=12.2h(h,f),e=1v,a=0,l=0;T(D c=0;c<m.1a;++c){D k=2O(m,c);E(k<0){E(m.2N(c)=="-"&&C.1s()==0){e=1w}3q}l=h*l+k;E(++a>=f){C.2V(g);C.2a(l,0);a=0;l=0}}E(a>0){C.2V(12.2h(h,a));C.2a(l,0)}E(e){J.1c.U(C,C)}}H 4c(f,e,h){E("3e"==2G e){E(f<2){C.1X(1)}K{C.2H(f,h);E(!C.1I(f-1)){C.1U(J.1h.1B(f-1),2z,C)}E(C.1j()){C.2a(1,0)}N(!C.4d(e)){C.2a(2,0);E(C.1A()>f){C.U(J.1h.1B(f-1),C)}}}}K{D d=M 1P(),g=f&7;d.1a=(f>>3)+1;e.4e(d);E(g>0){d[0]&=(1<<g)-1}K{d[0]=0}C.2u(d,1J)}}H 4f(){D b=C.t,c=M 1P();c[0]=C.s;D e=C.P-b*C.P%8,f,a=0;E(b-->0){E(e<C.P&&(f=C[b]>>e)!=(C.s&C.1e)>>e){c[a++]=f|C.s<<C.P-e}N(b>=0){E(e<8){f=(C[b]&(1<<e)-1)<<8-e;f|=C[--b]>>(e+=C.P-8)}K{f=C[b]>>(e-=8)&1m;E(e<=0){e+=C.P;--b}}E((f&2x)!=0){f|=-1J}E(a==0&&(C.s&2x)!=(f&2x)){++a}E(a>0||f!=C.s){c[a++]=f}}}F c}H 4g(b){F C.Y(b)==0}H 4h(b){F C.Y(b)<0?C:b}H 4i(b){F C.Y(b)>0?C:b}H 4j(c,h,e){D d,g,b=12.1Y(c.t,C.t);T(d=0;d<b;++d){e[d]=h(C[d],c[d])}E(c.t<C.t){g=c.s&C.1e;T(d=b;d<C.t;++d){e[d]=h(C[d],g)}e.t=C.t}K{g=C.s&C.1e;T(d=b;d<c.t;++d){e[d]=h(g,c[d])}e.t=c.t}e.s=h(C.s,c.s);e.1n()}H 4k(a,b){F a&b}H 4l(b){D c=Q();C.1U(b,4k,c);F c}H 2z(a,b){F a|b}H 4m(b){D c=Q();C.1U(b,2z,c);F c}H 2W(a,b){F a^b}H 4n(b){D c=Q();C.1U(b,2W,c);F c}H 2X(a,b){F a&~b}H 4o(b){D c=Q();C.1U(b,2X,c);F c}H 4p(){D b=Q();T(D a=0;a<C.t;++a){b[a]=C.1e&~C[a]}b.t=C.t;b.s=~C.s;F b}H 4q(b){D a=Q();E(b<0){C.1i(-b,a)}K{C.1Z(b,a)}F a}H 4r(b){D a=Q();E(b<0){C.1Z(-b,a)}K{C.1i(b,a)}F a}H 4s(a){E(a==0){F-1}D b=0;E((a&2y)==0){a>>=16;b+=16}E((a&1m)==0){a>>=8;b+=8}E((a&15)==0){a>>=4;b+=4}E((a&3)==0){a>>=2;b+=2}E((a&1)==0){++b}F b}H 4t(){T(D a=0;a<C.t;++a){E(C[a]!=0){F a*C.P+4s(C[a])}}E(C.s<0){F C.t*C.P}F-1}H 4u(a){D b=0;N(a!=0){a&=a-1;++b}F b}H 4v(){D c=0,a=C.s&C.1e;T(D b=0;b<C.t;++b){c+=4u(C[b]^a)}F c}H 4w(b){D a=12.1D(b/C.P);E(a>=C.t){F C.s!=0}F(C[a]&1<<b%C.P)!=0}H 4x(c,b){D a=J.1h.1B(c);C.1U(a,b,a);F a}H 4y(a){F C.2A(a,2z)}H 4z(a){F C.2A(a,2X)}H 4A(a){F C.2A(a,2W)}H 4B(d,f){D e=0,g=0,b=12.1Y(d.t,C.t);N(e<b){g+=C[e]+d[e];f[e++]=g&C.1e;g>>=C.P}E(d.t<C.t){g+=d.s;N(e<C.t){g+=C[e];f[e++]=g&C.1e;g>>=C.P}g+=C.s}K{g+=C.s;N(e<d.t){g+=d[e];f[e++]=g&C.1e;g>>=C.P}g+=d.s}f.s=g<0?-1:0;E(g>0){f[e++]=g}K{E(g<-1){f[e++]=C.1l+g}}f.t=e;f.1n()}H 4C(b){D c=Q();C.2m(b,c);F c}H 4D(b){D c=Q();C.U(b,c);F c}H 4E(b){D c=Q();C.21(b,c);F c}H 4F(){D a=Q();C.22(a);F a}H 4G(b){D c=Q();C.1H(b,c,V);F c}H 4H(b){D c=Q();C.1H(b,V,c);F c}H 4I(b){D d=Q(),c=Q();C.1H(b,d,c);F M 1P(d,c)}H 4J(a){C[C.t]=C.1q(0,a-1,C,0,0,C.t);++C.t;C.1n()}H 4K(b,a){E(b==0){F}N(C.t<=a){C[C.t++]=0}C[a]+=b;N(C[a]>=C.1l){C[a]-=C.1l;E(++a>=C.t){C[C.t++]=0}++C[a]}}H 2b(){}H 2Y(a){F a}H 4L(a,c,b){a.21(c,b)}H 4M(a,b){a.22(b)}2b.I.25=2Y;2b.I.27=2Y;2b.I.1S=4L;2b.I.1z=4M;H 4N(a){F C.2S(a,M 2b())}H 4O(b,f,e){D d=12.1Y(C.t+b.t,f);e.s=0;e.t=d;N(d>0){e[--d]=0}D c;T(c=e.t-C.t;d<c;++d){e[d+C.t]=C.1q(0,b[d],e,d,0,C.t)}T(c=12.1Y(b.t,f);d<c;++d){C.1q(0,b[d],e,d,0,f-d)}e.1n()}H 4P(b,e,d){--e;D c=d.t=C.t+b.t-e;d.s=0;N(--c>=0){d[c]=0}T(c=12.2P(e-C.t,0);c<b.t;++c){d[C.t+c-e]=C.1q(e-c,b[c],d,0,0,C.t+c-e)}d.1n();d.2l(1,d)}H 1V(a){C.1M=Q();C.2Z=Q();J.1h.20(2*a.t,C.1M);C.4Q=C.1M.2n(a);C.m=a}H 4R(a){E(a.s<0||a.t>2*C.m.t){F a.Z(C.m)}K{E(a.Y(C.m)<0){F a}K{D b=Q();a.1G(b);C.1y(b);F b}}}H 4S(a){F a}H 4T(a){a.2l(C.m.t-1,C.1M);E(a.t>C.m.t+1){a.t=C.m.t+1;a.1n()}C.4Q.4U(C.1M,C.m.t+1,C.2Z);C.m.4V(C.2Z,C.m.t+1,C.1M);N(a.Y(C.1M)<0){a.2a(1,C.m.t+1)}a.U(C.1M,a);N(a.Y(C.m)>=0){a.U(C.m,a)}}H 4W(a,b){a.22(b);C.1y(b)}H 4X(a,c,b){a.21(c,b);C.1y(b)}1V.I.25=4R;1V.I.27=4S;1V.I.1y=4T;1V.I.1S=4X;1V.I.1z=4W;H 4Y(q,f){D o=q.1A(),h,b=1E(1),v;E(o<=0){F b}K{E(o<18){h=1}K{E(o<48){h=3}K{E(o<69){h=4}K{E(o<6a){h=5}K{h=6}}}}}E(o<8){v=M 1K(f)}K{E(f.1j()){v=M 1V(f)}K{v=M 1L(f)}}D p=M 1P(),d=3,s=h-1,a=(1<<h)-1;p[1]=v.25(C);E(h>1){D A=Q();v.1z(p[1],A);N(d<=a){p[d]=Q();v.1S(A,p[d-2],p[d]);d+=2}}D l=q.t-1,x,u=1w,c=Q(),y;o=2k(q[l])-1;N(l>=0){E(o>=s){x=q[l]>>o-s&a}K{x=(q[l]&(1<<o+1)-1)<<s-o;E(l>0){x|=q[l-1]>>C.P+o-s}}d=h;N((x&1)==0){x>>=1;--d}E((o-=d)<0){o+=C.P;--l}E(u){p[x].1G(b);u=1v}K{N(d>1){v.1z(b,c);v.1z(c,b);d-=2}E(d>0){v.1z(b,c)}K{y=b;b=c;c=y}v.1S(c,p[x],b)}N(l>=0&&(q[l]&1<<o)==0){v.1z(b,c);y=b;b=c;c=y;E(--o<0){o=C.P-1;--l}}}F v.27(b)}H 4Z(c){D b=C.s<0?C.1x():C.2o();D h=c.s<0?c.1x():c.2o();E(b.Y(h)<0){D e=b;b=h;h=e}D d=b.2c(),f=h.2c();E(f<0){F b}E(d<f){f=d}E(f>0){b.1i(f,b);h.1i(f,h)}N(b.1s()>0){E((d=b.2c())>0){b.1i(d,b)}E((d=h.2c())>0){h.1i(d,h)}E(b.Y(h)>=0){b.U(h,b);b.1i(1,b)}K{h.U(b,h);h.1i(1,h)}}E(f>0){h.1Z(f,h)}F h}H 50(e){E(e<=0){F 0}D c=C.1l%e,b=C.s<0?e-1:0;E(C.t>0){E(c==0){b=C[0]%e}K{T(D a=C.t-1;a>=0;--a){b=(c*b+C[a])%e}}}F b}H 51(f){D j=f.1j();E(C.1j()&&j||f.1s()==0){F J.1c}D i=f.2o(),h=C.2o();D g=1E(1),e=1E(0),l=1E(0),k=1E(1);N(i.1s()!=0){N(i.1j()){i.1i(1,i);E(j){E(!g.1j()||!e.1j()){g.2m(C,g);e.U(f,e)}g.1i(1,g)}K{E(!e.1j()){e.U(f,e)}}e.1i(1,e)}N(h.1j()){h.1i(1,h);E(j){E(!l.1j()||!k.1j()){l.2m(C,l);k.U(f,k)}l.1i(1,l)}K{E(!k.1j()){k.U(f,k)}}k.1i(1,k)}E(i.Y(h)>=0){i.U(h,i);E(j){g.U(l,g)}e.U(k,e)}K{h.U(i,h);E(j){l.U(g,l)}k.U(e,k)}}E(h.Y(J.1h)!=0){F J.1c}E(k.Y(f)>=0){F k.X(f)}E(k.1s()<0){k.2m(f,k)}K{F k}E(k.1s()<0){F k.1o(f)}K{F k}}D 1k=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,6b,6c,6d,6e,6f,6g,6h,6i,6j,6k,6l,6m,6n,6o,6p,6q,6r,6s,6t,6u,6v,6w,6x,6y,6z,6A,6B,6C,6D,6E,6F,6G,6H,6I,6J,6K,6L,6M,6N,6O,6P,6Q,6R,6S,6T,6U,6V,6W,6X,6Y,6Z,70,72,74,75,76,77,78,7a,7b,7c,7d,7e,7f,7g,7h,7i,7j,7k,7l,7m,7n,7o,7p,7q,7r,7s,7t,7u,7v,7w,7x,7y,7z,7A,7B,7C,7D,7E,7F,7G,7H,7I,7J,7K,7L,7M,7N,7O,7P,7Q,7R,7S,7T,7U,7V,7W,7X,7Y,7Z,80,81,82,84,85,86,87,88,8a,8b,8c,8d,8e,8f,8g,8h,8i,8j,8k,8l,8m,8n,8o,8p,8q,8r,8s,8t,8u,8v,8w,8x,8y];D 54=(1<<26)/1k[1k.1a-1];H 55(e){D d,b=C.1F();E(b.t==1&&b[0]<=1k[1k.1a-1]){T(d=0;d<1k.1a;++d){E(b[0]==1k[d]){F 1w}}F 1v}E(b.1j()){F 1v}d=1;N(d<1k.1a){D a=1k[d],c=d+1;N(c<1k.1a&&a<54){a*=1k[c++]}a=b.56(a);N(d<c){E(a%1k[d++]==0){F 1v}}}F b.57(e)}H 58(f){D g=C.X(J.1h);D c=g.2c();E(c<=0){F 1v}D h=g.5a(c);f=f+1>>1;E(f>1k.1a){f=1k.1a}D b=Q();T(D e=0;e<f;++e){b.1X(1k[12.1D(12.33()*1k.1a)]);D l=b.5b(h,C);E(l.Y(J.1h)!=0&&l.Y(g)!=0){D d=1;N(d++<c&&l.Y(g)!=0){l=l.3Z(2,C);E(l.Y(J.1h)==0){F 1v}}E(l.Y(g)!=0){F 1v}}}F 1w}J.I.2T=46;J.I.3t=4a;J.I.3p=4b;J.I.2H=4c;J.I.1U=4j;J.I.2A=4x;J.I.2m=4B;J.I.2V=4J;J.I.2a=4K;J.I.4V=4O;J.I.4U=4P;J.I.56=50;J.I.57=58;J.I.2o=40;J.I.2U=42;J.I.8z=44;J.I.8A=45;J.I.1s=49;J.I.8B=4f;J.I.1b=4g;J.I.1Y=4h;J.I.2P=4i;J.I.8C=4l;J.I.8D=4m;J.I.8E=4n;J.I.8F=4o;J.I.34=4p;J.I.1B=4q;J.I.5a=4r;J.I.2c=4t;J.I.8G=4v;J.I.1I=4w;J.I.8H=4y;J.I.8I=4z;J.I.8J=4A;J.I.1o=4C;J.I.X=4D;J.I.L=4E;J.I.2n=4G;J.I.8K=4H;J.I.8L=4I;J.I.5b=4Y;J.I.2B=51;J.I.2h=4N;J.I.8M=4Z;J.I.4d=55;J.I.1t=4F;H 1f(b,a){C.x=a;C.q=b}H 5c(a){E(a==C){F 1w}F C.q.1b(a.q)&&C.x.1b(a.x)}H 5d(){F C.x}H 5e(){F M 1f(C.q,C.x.1x().Z(C.q))}H 5f(a){F M 1f(C.q,C.x.1o(a.R()).Z(C.q))}H 5g(a){F M 1f(C.q,C.x.X(a.R()).Z(C.q))}H 5h(a){F M 1f(C.q,C.x.L(a.R()).Z(C.q))}H 5i(){F M 1f(C.q,C.x.1t().Z(C.q))}H 5j(a){F M 1f(C.q,C.x.L(a.R().2B(C.q)).Z(C.q))}1f.I.1b=5c;1f.I.R=5d;1f.I.1x=5e;1f.I.1o=5f;1f.I.X=5g;1f.I.L=5h;1f.I.1t=5i;1f.I.2n=5j;H W(c,a,d,b){C.O=c;C.x=a;C.y=d;E(b==V){C.z=J.1h}K{C.z=b}C.1W=V}H 5k(){E(C.1W==V){C.1W=C.z.2B(C.O.q)}F C.O.1g(C.x.R().L(C.1W).Z(C.O.q))}H 5l(){E(C.1W==V){C.1W=C.z.2B(C.O.q)}F C.O.1g(C.y.R().L(C.1W).Z(C.O.q))}H 5m(a){E(a==C){F 1w}E(C.1p()){F a.1p()}E(a.1p()){F C.1p()}D c,b;c=a.y.R().L(C.z).X(C.y.R().L(a.z)).Z(C.O.q);E(!c.1b(J.1c)){F 1v}b=a.x.R().L(C.z).X(C.x.R().L(a.z)).Z(C.O.q);F b.1b(J.1c)}H 5n(){E(C.x==V&&C.y==V){F 1w}F C.z.1b(J.1c)&&!C.y.R().1b(J.1c)}H 5o(){F M W(C.O,C.x,C.y.1x(),C.z)}H 5p(l){E(C.1p()){F l}E(l.1p()){F C}D p=l.y.R().L(C.z).X(C.y.R().L(l.z)).Z(C.O.q);D o=l.x.R().L(C.z).X(C.x.R().L(l.z)).Z(C.O.q);E(J.1c.1b(o)){E(J.1c.1b(p)){F C.2d()}F C.O.1N()}D j=M J("3");D e=C.x.R();D n=C.y.R();D c=l.x.R();D k=l.y.R();D m=o.1t();D i=m.L(o);D d=e.L(m);D g=p.1t().L(C.z);D a=g.X(d.1B(1)).L(l.z).X(i).L(o).Z(C.O.q);D h=d.L(j).L(p).X(n.L(i)).X(g.L(p)).L(l.z).1o(p.L(i)).Z(C.O.q);D f=i.L(C.z).L(l.z).Z(C.O.q);F M W(C.O,C.O.1g(a),C.O.1g(h),f)}H 5q(){E(C.1p()){F C}E(C.y.R().1s()==0){F C.O.1N()}D g=M J("3");D c=C.x.R();D h=C.y.R();D e=h.L(C.z);D j=e.L(h).Z(C.O.q);D i=C.O.a.R();D k=c.1t().L(g);E(!J.1c.1b(i)){k=k.1o(C.z.1t().L(i))}k=k.Z(C.O.q);D b=k.1t().X(c.1B(3).L(j)).1B(1).L(e).Z(C.O.q);D f=k.L(g).L(c).X(j.1B(1)).1B(2).L(j).X(k.1t().L(k)).Z(C.O.q);D d=e.1t().L(e).1B(3).Z(C.O.q);F M W(C.O,C.O.1g(b),C.O.1g(f),d)}H 5r(b){E(C.1p()){F C}E(b.1s()==0){F C.O.1N()}D g=b;D f=g.L(M J("3"));D l=C.1x();D d=C;D c;T(c=f.1A()-2;c>0;--c){d=d.2d();D a=f.1I(c);D j=g.1I(c);E(a!=j){d=d.1o(a?C:l)}}F d}H 5s(c,a,b){D d;E(c.1A()>b.1A()){d=c.1A()-1}K{d=b.1A()-1}D f=C.O.1N();D e=C.1o(a);N(d>=0){f=f.2d();E(c.1I(d)){E(b.1I(d)){f=f.1o(e)}K{f=f.1o(C)}}K{E(b.1I(d)){f=f.1o(a)}}--d}F f}W.I.2p=5k;W.I.2q=5l;W.I.1b=5m;W.I.1p=5n;W.I.1x=5o;W.I.1o=5p;W.I.2d=5q;W.I.L=5r;W.I.8N=5s;H 1O(e,d,c){C.q=e;C.a=C.1g(d);C.b=C.1g(c);C.2C=M W(C,V,V)}H 5t(){F C.q}H 5u(){F C.a}H 5v(){F C.b}H 5w(a){E(a==C){F 1w}F C.q.1b(a.q)&&C.a.1b(a.a)&&C.b.1b(a.b)}H 5x(){F C.2C}H 5y(a){F M 1f(C.q,a)}H 5z(d){8O(8P(d.1T(0,2),16)){2e 0:F C.2C;2e 2:2e 3:F V;2e 4:2e 6:2e 7:D a=(d.1a-2)/2;D c=d.1T(2,a);D b=d.1T(a+2,a);F M W(C,C.1g(M J(c,16)),C.1g(M J(b,16)));8Q:F V}}1O.I.35=5t;1O.I.5A=5u;1O.I.5B=5v;1O.I.1b=5w;1O.I.1N=5x;1O.I.1g=5y;1O.I.8R=5z;1f.I.8S=H(){F 12.1D((C.R().1A()+7)/8)};W.I.8T=H(c){D d=H(h,f){D g=h.8U();E(f<g.1a){g=g.38(g.1a-f)}K{N(f>g.1a){g.2f(0)}}F g};D a=C.2p().R();D e=C.2q().R();D b=d(a,32);E(c){E(e.1j()){b.2f(2)}K{b.2f(3)}}K{b.2f(4);b=b.8V(d(e,32))}F b};W.8W=H(g,c){D f=c[0];D e=c.1a-1;D d=c.38(1,1+e/2);D b=c.38(1+e/2,1+e);d.2f(0);b.2f(0);D a=M J(d);D h=M J(b);F M W(g,g.1g(a),g.1g(h))};W.8X=H(g,c){D f=c.1T(0,2);D e=c.1a-2;D d=c.1T(2,e/2);D b=c.1T(2+e/2,e/2);D a=M J(d,16);D h=M J(b,16);F M W(g,g.1g(a),g.1g(h))};W.I.5C=H(c){E(C.1p()){F c}E(c.1p()){F C}E(C.x.1b(c.x)){E(C.y.1b(c.y)){F C.2d()}F C.O.1N()}D g=c.x.X(C.x);D e=c.y.X(C.y);D a=e.2n(g);D d=a.1t().X(C.x).X(c.x);D f=a.L(C.x.X(d)).X(C.y);F M W(C.O,d,f)};W.I.8Y=H(){E(C.1p()){F C}E(C.y.R().1s()==0){F C.O.1N()}D b=C.O.1g(J.5D(2));D e=C.O.1g(J.5D(3));D a=C.x.1t().L(e).1o(C.O.a).2n(C.y.L(b));D c=a.1t().X(C.x.L(b));D d=a.L(C.x.X(c)).X(C.y);F M W(C.O,c,d)};W.I.8Z=H(b){E(C.1p()){F C}E(b.1s()==0){F C.O.1N()}D g=b;D f=g.L(M J("3"));D l=C.1x();D d=C;D c;T(c=f.1A()-2;c>0;--c){d=d.2d();D a=f.1I(c);D j=g.1I(c);E(a!=j){d=d.5C(a?C:l)}}F d};W.I.5E=H(){D d=C.2p().R();D i=C.2q().R();D f=C.O.5A().R();D c=C.O.5B().R();D h=C.O.35();D e=i.L(i).Z(h);D g=d.L(d).L(d).1o(f.L(d)).1o(c).Z(h);F e.1b(g)};W.I.1R=H(){F"("+C.2p().R().1R()+","+C.2q().R().1R()+")"};W.I.90=H(){D c=C.O.35();E(C.1p()){2r M 2s("39 3a 91 2C.")}D a=C.2p().R();D b=C.2q().R();E(a.Y(J.1h)<0||a.Y(c.X(J.1h))>0){2r M 2s("x 5F 5G 3b 5H")}E(b.Y(J.1h)<0||b.Y(c.X(J.1h))>0){2r M 2s("y 5F 5G 3b 5H")}E(!C.5E()){2r M 2s("39 3a 34 92 93 O.")}E(C.L(c).1p()){2r M 2s("39 3a 34 a 94 95 3b G.")}F 1w};H 2D(){C.i=0;C.j=0;C.S=M 1P()}H 5I(d){D c,a,b;T(c=0;c<1J;++c){C.S[c]=c}a=0;T(c=0;c<1J;++c){a=a+C.S[c]+d[c%d.1a]&1m;b=C.S[c];C.S[c]=C.S[a];C.S[a]=b}C.i=0;C.j=0}H 5J(){D a;C.i=C.i+1&1m;C.j=C.j+C.S[C.i]&1m;a=C.S[C.i];C.S[C.i]=C.S[C.j];C.S[C.j]=a;F C.S[a+C.S[C.i]&1m]}2D.I.5K=5I;2D.I.5L=5J;H 5M(){F M 2D()}D 2E=1J;D 2t;D 1u;D 1d;H 5N(a){1u[1d++]^=a&1m;1u[1d++]^=a>>8&1m;1u[1d++]^=a>>16&1m;1u[1d++]^=a>>24&1m;E(1d>=2E){1d-=2E}}H 3c(){5N(M 96().98())}E(1u==V){1u=M 1P();1d=0;D t;E(2v.2J=="3j"&&2v.99<"5"&&5O.5P){D z=5O.5P.33(32);T(t=0;t<z.1a;++t){1u[1d++]=z.2j(t)&1m}}N(1d<2E){t=12.1D(9a*12.33());1u[1d++]=t>>>8;1u[1d++]=t&1m}1d=0;3c()}H 5Q(){E(2t==V){3c();2t=5M();2t.5K(1u);T(1d=0;1d<1u.1a;++1d){1u[1d]=0}1d=0}F 2t.5L()}H 5R(b){D a;T(a=0;a<b.1a;++a){b[a]=5Q()}}H 5S(){}5S.I.4e=5R;',62,569,"||||||||||||||||||||||||||||||||||||||this|var|if|return||function|prototype|BigInteger|else|multiply|new|while|curve|DB|nbi|toBigInteger||for|subTo|null|ECPointFp|subtract|compareTo|mod|||Math||||||||length|equals|ZERO|rng_pptr|DM|ECFieldElementFp|fromBigInteger|ONE|rShiftTo|isEven|lowprimes|DV|255|clamp|add|isInfinity|am|vv|signum|square|rng_pool|false|true|negate|reduce|sqrTo|bitLength|shiftLeft|dbits|floor|nbv|abs|copyTo|divRemTo|testBit|256|Classic|Montgomery|r2|getInfinity|ECCurveFp|Array|rr|toString|mulTo|substr|bitwiseTo|Barrett|zinv|fromInt|min|lShiftTo|dlShiftTo|multiplyTo|squareTo|||convert||revert|||dAddOffset|NullExp|getLowestSetBit|twice|case|unshift|32767|pow|BI_RC|charCodeAt|nbits|drShiftTo|addTo|divide|clone|getX|getY|throw|Error|rng_state|fromString|navigator|BI_FP|128|65535|op_or|changeBit|modInverse|infinity|Arcfour|rng_psize|j_lm|typeof|fromNumber|16383|appName|F1|F2|int2char|charAt|intAt|max|mp|mpl|exp|chunkSize|intValue|dMultiply|op_xor|op_andnot|nNop|q3||||random|not|getQ|||slice|Point|is|of|rng_seed_time|canary|number|am1|am2|1073741823|am3|Netscape|FV|BI_RM|bnpCopyTo|bnpFromInt|bnpFromString|fromRadix|continue|bnpClamp|bnToString|toRadix|bnNegate|bnAbs|bnCompareTo|bnBitLength|bnpDLShiftTo|bnpDRShiftTo|bnpLShiftTo|bnpRShiftTo|bnpSubTo|bnpMultiplyTo|bnpSquareTo|bnpDivRemTo|bnMod|cConvert|cRevert|cReduce|cMulTo|cSqrTo|bnpInvDigit|invDigit|mph|um|mt2|montConvert|montRevert|montReduce|montSqrTo|montMulTo|bnpIsEven|bnpExp|bnModPowInt|modPowInt|bnClone||bnIntValue||bnByteValue|bnShortValue|bnpChunkSize|||bnSigNum|bnpToRadix|bnpFromRadix|bnpFromNumber|isProbablePrime|nextBytes|bnToByteArray|bnEquals|bnMin|bnMax|bnpBitwiseTo|op_and|bnAnd|bnOr|bnXor|bnAndNot|bnNot|bnShiftLeft|bnShiftRight|lbit|bnGetLowestSetBit|cbit|bnBitCount|bnTestBit|bnpChangeBit|bnSetBit|bnClearBit|bnFlipBit|bnpAddTo|bnAdd|bnSubtract|bnMultiply|bnSquare|bnDivide|bnRemainder|bnDivideAndRemainder|bnpDMultiply|bnpDAddOffset|nMulTo|nSqrTo|bnPow|bnpMultiplyLowerTo|bnpMultiplyUpperTo|mu|barrettConvert|barrettRevert|barrettReduce|multiplyUpperTo|multiplyLowerTo|barrettSqrTo|barrettMulTo|bnModPow|bnGCD|bnpModInt|bnModInverse|||lplim|bnIsProbablePrime|modInt|millerRabin|bnpMillerRabin||shiftRight|modPow|feFpEquals|feFpToBigInteger|feFpNegate|feFpAdd|feFpSubtract|feFpMultiply|feFpSquare|feFpDivide|pointFpGetX|pointFpGetY|pointFpEquals|pointFpIsInfinity|pointFpNegate|pointFpAdd|pointFpTwice|pointFpMultiply|pointFpMultiplyTwo|curveFpGetQ|curveFpGetA|curveFpGetB|curveFpEquals|curveFpGetInfinity|curveFpFromBigInteger|curveFpDecodePointHex|getA|getB|add2D|valueOf|isOnCurve|coordinate|out|bounds|ARC4init|ARC4next|init|next|prng_newstate|rng_seed_int|window|crypto|rng_get_byte|rng_get_bytes|SecureRandom|244837814094590|16777215|15715070|string|67108864|67108863|268435455|Microsoft||Internet|Explorer|0123456789abcdefghijklmnopqrstuvwxyz|4294967295|LN2||log|144|768|101|103|107|109|113|127|131|137|139|149|151|157|163|167|173|179|181|191|193|197|199|211|223|227|229|233|239|241|251|257|263|269|271|277|281|283|293|307|311|313|317|331|337|347|349|353|359|367|373|379|383|389||397||401|409|419|421|431||433|439|443|449|457|461|463|467|479|487|491|499|503|509|521|523|541|547|557|563|569|571|577|587|593|599|601|607|613|617|619|631|641|643|647|653|659|661|673|677|683|691|701|709|719|727|733|739|743|751|757|761|769|773|787||797|809|811|821|823||827|829|839|853|857|859|863|877|881|883|887|907|911|919|929|937|941|947|953|967|971|977|983|991|997|byteValue|shortValue|toByteArray|and|or|xor|andNot|bitCount|setBit|clearBit|flipBit|remainder|divideAndRemainder|gcd|multiplyTwo|switch|parseInt|default|decodePointHex|getByteLength|getEncoded|toByteArrayUnsigned|concat|decodeFrom|decodeFromHex|twice2D|multiply2D|validate|at|on|the|scalar|multiple|Date||getTime|appVersion|65536".split("|"),0,{}));var ecc_param={p:"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",a:"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",b:"28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",n:"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",gx:"32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7",gy:"BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",keylen:256};function SM2(){this.ecc_p=new BigInteger(ecc_param.p,16);this.ecc_a=new BigInteger(ecc_param.a,16);this.ecc_b=new BigInteger(ecc_param.b,16);this.ecc_n=new BigInteger(ecc_param.n,16);this.ecc_gx=new BigInteger(ecc_param.gx,16);this.ecc_gy=new BigInteger(ecc_param.gy,16);this.rng=new SecureRandom();this.ecCurve=new ECCurveFp(this.ecc_p,this.ecc_a,this.ecc_b);this.ecPointG=ECPointFp.decodeFromHex(this.ecCurve,"04"+ecc_param.gx+ecc_param.gy)}SM2.prototype={getBigRandom:function(b){return new BigInteger(b.bitLength(),this.rng).mod(b.subtract(BigInteger.ONE)).add(BigInteger.ONE)},generateKeyPairHex:function(){var l=this.generateKeyPairBigInteger();var m=l.pubkey.getX().toBigInteger();var n=l.pubkey.getY().toBigInteger();var o=ecc_param.keylen/4;var k=("0000000000"+l.privkey.toString(16)).slice(-o);var p=("0000000000"+m.toString(16)).slice(-o);var j=("0000000000"+n.toString(16)).slice(-o);var i=p+j;return{privkeyhex:k,pubkeyhex:i}},generateKeyPairBigInteger:function(){var d=this.ecc_n;var f=null;var e=null;while(true){do{f=this.getBigRandom(d)}while(f.equals(BigInteger.ZERO)||f.compareTo(d)>=0||f.bitLength()<249);e=this.ecPointG.multiply(f);if(e.getX().toBigInteger().bitLength()>=249&&e.getY().toBigInteger().bitLength()>=249){break}}return{privkey:f,pubkey:e}},formartXY:function(f,j){var g=new Array(j);for(var h=0;h<g.length;h++){g[h]=0}var i=f.toByteArray();if(i==null){return null}if(i.length>j){arrayCopy(i,i.length-j,g,0,j)}else{if(i.length==j){g=i}else{arrayCopy(i,0,g,j-i.length,i.length)}}return g},kdf:function(m,h){var l=Math.ceil(h.length/32);var j;var n=new Array(32);for(var i=0;i<l;i++){j=new SM3Digest();j.update(m,0,m.length);j.update(intToByte(i+1),0,4);n=j.doFinal();for(var k=0;k<n.length&&(i*32+k)<h.length;k++){h[i*32+k]^=n[k]}}return 0},arrayCompare:function(k,g,l,h,j){if(k.length-g<j){return -1}if(l.length-h<j){return -1}for(var i=0;i<j;i++){if(k[g++]!=l[h++]){return -1}}return 0},encrypt:function(C,D){var K;if(C==null||C.length==0||D==null||D.length==0){return null}var J=new Array(65);if(C.length==64){J[0]=4;arrayCopy(C,0,J,1,C.length)}else{arrayCopy(C,0,J,0,C.length)}var x=D;var F=ECPointFp.decodeFromHex(this.ecCurve,Hex.encode(J));var w=null;var v=null;var t=null;var H=null;var B=0;do{var L=this.generateKeyPairBigInteger();v=L.pubkey;var u=F.multiply(L.privkey);t=this.formartXY(u.getX().toBigInteger(),32);H=this.formartXY(u.getY().toBigInteger(),32);w=new Array(x.length);arrayCopy(x,0,w,0,x.length);var E=new Array(t.length+H.length);arrayCopy(t,0,E,0,t.length);arrayCopy(H,0,E,t.length,H.length);this.kdf(E,w);B++}while(this.arrayCompare(w,0,x,0,x.length)==0&&B<10);if(B>=10){return null}var y=new SM3Digest();y.update(t,0,t.length);y.update(x,0,x.length);y.update(H,0,H.length);var A=y.doFinal();K=new Array(96+w.length);var z=this.formartXY(v.getX().toBigInteger(),33);var G=this.formartXY(v.getY().toBigInteger(),33);var I=new Array(z.length+G.length-2);arrayCopy(z,1,I,0,z.length-1);arrayCopy(G,1,I,z.length-1,G.length-1);arrayCopy(I,0,K,0,64);arrayCopy(A,0,K,64,A.length);arrayCopy(w,0,K,64+A.length,w.length);return K},decrypt:function(v,w){if(w.length<96){return null}var t=w.length-64-32;var n=new Array(64+1);var o=new Array(t);var p=new Array(32);n[0]=4;arrayCopy(w,0,n,1,64);arrayCopy(w,64,p,0,32);arrayCopy(w,96,o,0,t);var q=ECPointFp.decodeFromHex(this.ecCurve,Hex.encode(n,0,n.length));var x=q.multiply(new BigInteger(Hex.encode(v),16));var r=this.formartXY(x.getX().toBigInteger(),32);var u=this.formartXY(x.getY().toBigInteger(),32);var s=new Array(r.length+u.length);arrayCopy(r,0,s,0,r.length);arrayCopy(u,0,s,r.length,u.length);var m=new Array(o.length);arrayCopy(o,0,m,0,o.length);this.kdf(s,o);if(this.arrayCompare(m,0,o,0,o.length)==0){return null}return o}};function SM3Digest(){this.ivByte=new Array(115,128,22,111,73,20,178,185,23,36,66,215,218,138,6,0,169,111,48,188,22,49,56,170,227,141,238,77,176,251,14,78);this.iv=byteArrayToIntArray(this.ivByte);this.tj=new Array(64);this.BLOCK_BYTE_LEN=64;this.vbuf=new Array(8);this.dataBuf=new Array(64);this.dataBufLen=0;this.totalLen=0;for(var b=0;b<64;b++){if(b<=15){this.tj[b]=2043430169}else{this.tj[b]=2055708042}}arrayCopy(this.iv,0,this.vbuf,0,this.vbuf.length)}SM3Digest.prototype={ffj:function(i,j,f,g){var h;if(g<=15){h=i^j^f}else{h=(i&j)|(i&f)|(j&f)}return h},ggj:function(i,j,f,g){var h=0;if(g<=15){h=i^j^f}else{h=(i&j)|(~i&f)}return h},p0:function(b){return b^(b<<9|(b>>>(32-9)))^(b<<17|(b>>>(32-17)))},p1:function(b){return b^(b<<15|(b>>>(32-15)))^(b<<23|(b>>>(32-23)))},cycleLeft:function(d,c){return d<<c|(d>>>(32-c))},padding:function(f){var g=0;var h=f.length;var e;g=64-(h+1+8)%64;if(g>=64){g=0}e=new Array(g+1+h+8);e[h]=1<<7;arrayCopy(f,0,e,0,h);arrayCopy(longToByte(this.totalLen<<3),0,e,h+g+1,8);return e},iterate:function(k){var i=k.length;var j=parseInt(i/16);var m,n;var b;m=this.vbuf;n=new Array(16);for(var l=0;l<j;l++){arrayCopy(k,l*16,n,0,n.length);b=this.expand(n);m=this.cf(m,b[0],b[1])}arrayCopy(m,0,this.vbuf,0,m.length)},expand:function(h){var g=new Array(68);var b=new Array(64);arrayCopy(h,0,g,0,h.length);for(var f=16;f<g.length;f++){g[f]=this.p1(g[f-16]^g[f-9]^this.cycleLeft(g[f-3],15))^this.cycleLeft(g[f-13],7)^g[f-6]}for(var f=0;f<b.length;f++){b[f]=g[f]^g[f+4]}return new Array(g,b)},cf:function(h,d,g){var b;var e,B,D,G,H,a,c,f,i,v,C,F;e=h[0];B=h[1];D=h[2];G=h[3];H=h[4];a=h[5];c=h[6];f=h[7];for(var E=0;E<64;E++){i=this.cycleLeft(this.cycleLeft(e,12)+H+this.cycleLeft(this.tj[E],E),7);v=i^this.cycleLeft(e,12);C=this.ffj(e,B,D,E)+G+v+g[E];F=this.ggj(H,a,c,E)+f+i+d[E];G=D;D=this.cycleLeft(B,9);B=e;e=C;f=c;c=this.cycleLeft(a,19);a=H;H=this.p0(F)}b=new Array(8);b[0]=e^h[0];b[1]=B^h[1];b[2]=D^h[2];b[3]=G^h[3];b[4]=H^h[4];b[5]=a^h[5];b[6]=c^h[6];b[7]=f^h[7];return b},digest:function(g){var j;var f=this.padding(g);var h=byteArrayToIntArray(f);this.iterate(h);var i=this.vbuf;j=intArrayToByteArray(i);return j},update:function(l,k,j){var i=parseInt((j+this.dataBufLen)/64);this.totalLen+=j;if(j+this.dataBufLen<this.BLOCK_BYTE_LEN){arrayCopy(l,0,this.dataBuf,this.dataBufLen,j);this.dataBufLen=j+this.dataBufLen}else{var g;arrayCopy(l,0,this.dataBuf,this.dataBufLen,this.BLOCK_BYTE_LEN-this.dataBufLen);g=byteArrayToIntArray(this.dataBuf);this.iterate(g);for(var h=1;h<i;h++){arrayCopy(l,h*this.BLOCK_BYTE_LEN-this.dataBufLen,this.dataBuf,0,this.BLOCK_BYTE_LEN);g=byteArrayToIntArray(this.dataBuf);this.iterate(g)}arrayCopy(l,i*this.BLOCK_BYTE_LEN-this.dataBufLen,this.dataBuf,0,j-(i*this.BLOCK_BYTE_LEN-this.dataBufLen));this.dataBufLen=j-(i*this.BLOCK_BYTE_LEN-this.dataBufLen)}},doFinal:function(){var j;var g=new Array(this.dataBufLen);arrayCopy(this.dataBuf,0,g,0,this.dataBufLen);var f=this.padding(g);var h=byteArrayToIntArray(f);this.iterate(h);var i=this.vbuf;j=intArrayToByteArray(i);return j}};function SM4(){this.SboxTable=new Array(214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72);this.FK=new Array(2746333894,1453994832,1736282519,2993693404);this.CK=new Array(462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257)}SM4.prototype={SM4_SETKEY:function(k,i){var p=new Array(32);var j,n;var o=new Array(4);var l=new Array(4);for(var m=0;m<4;m++){l[0]=k[0+4*m]&255;l[1]=k[1+4*m]&255;l[2]=k[2+4*m]&255;l[3]=k[3+4*m]&255;o[m]=l[0]<<24|l[1]<<16|l[2]<<8|l[3]}o[0]^=this.FK[0];o[1]^=this.FK[1];o[2]^=this.FK[2];o[3]^=this.FK[3];for(j=0;j<32;j+=4){n=o[1]^o[2]^o[3]^this.CK[j+0];n=this.BYTESUB(n);p[j+0]=o[0]^=this.L2(n);n=o[2]^o[3]^o[0]^this.CK[j+1];n=this.BYTESUB(n);p[j+1]=o[1]^=this.L2(n);n=o[3]^o[0]^o[1]^this.CK[j+2];n=this.BYTESUB(n);p[j+2]=o[2]^=this.L2(n);n=o[0]^o[1]^o[2]^this.CK[j+3];n=this.BYTESUB(n);p[j+3]=o[3]^=this.L2(n)}if(i===1){for(j=0;j<16;j++){n=p[j];p[j]=p[31-j];p[31-j]=n}}return p},BYTESUB:function(b){return(this.SboxTable[b>>>24&255]&255)<<24|(this.SboxTable[b>>>16&255]&255)<<16|(this.SboxTable[b>>>8&255]&255)<<8|(this.SboxTable[b&255]&255)},L2:function(b){return b^this.ROTL1(b,13)^this.ROTL1(b,23)},ROTL1:function(d,c){return d<<c|d>>>(32-c)},T1:function(a){var i=0;var h=new Array(4);var b=intToByte(a);h[0]=this.SboxTable[b[0]&255];h[1]=this.SboxTable[b[1]&255];h[2]=this.SboxTable[b[2]&255];h[3]=this.SboxTable[b[3]&255];var j=byteToInt(h,0);var i=j^(j<<13|(j>>>(32-13)))^(j<<23|(j>>>(32-23)));return i},one_encrypt:function(k,l){var j=new Array(36);j[0]=byteToInt(l,0);j[1]=byteToInt(l,4);j[2]=byteToInt(l,8);j[3]=byteToInt(l,12);for(var h=0;h<32;h++){j[(h+4)]=j[h]^this.T0(j[(h+1)]^j[(h+2)]^j[(h+3)]^k[h])}var i=new Array(4);for(var h=35;h>=32;h--){i[35-h]=j[h]}var g=intArrayToByteArray(i);return g},T0:function(a){var b=intToByte(a);var c=new Array(4);c[0]=this.SboxTable[b[0]&255];c[1]=this.SboxTable[b[1]&255];c[2]=this.SboxTable[b[2]&255];c[3]=this.SboxTable[b[3]&255];var j=byteToInt(c,0);var i=j^(j<<2|(j>>>(32-2)))^(j<<10|(j>>>(32-10)))^(j<<18|(j>>>(32-18)))^(j<<24|(j>>>(32-24)));return i},pkcs7padding:function(j,k){if(j==null){return null}var i=null;if(k==1){var l=j.length;l+=(16-l%16)%16;i=new Array(l);arrayCopy(j,0,i,0,j.length);for(var h=j.length;h<l;h++){i[h]=0}}else{var g=j[j.length-1];i=new Array(j.length-g);arrayCopy(j,0,i,0,j.length-g)}return i},encrypt_ecb:function(i,o){if(i==undefined||i==null||i.length%16!=0){console.log("sm4 key is error!");return null}if(o==undefined||o==null||o.length<=0){console.log("data is error!");return null}var l=this.SM4_SETKEY(i,0);o=this.pkcs7padding(o,1);var n=0,r=o.length,k=new Array();for(;r>0;r-=16){var m=o.slice(n*16,(16*(n+1)));var p=this.one_encrypt(l,m);k=k.concat(p);n++}var q=k;for(var n=0;n<q.length;n++){if(q[n]<0){q[n]=q[n]+256}}return q},decrypt_ecb:function(i,o){if(i==undefined||i==null||i.length%16!=0){console.log("sm4 key is error!");return null}if(o==undefined||o==null||o.length%16!=0){console.log("data is error!");return null}var l=this.SM4_SETKEY(i,1);var n=0;var r=o.length;var k=new Array();for(;r>0;r-=16){var m=o.slice(n*16,(16*(n+1)));var p=this.one_encrypt(l,m);k=k.concat(p);n++}var q=k;for(n=0;n<q.length;n++){if(q[n]<0){q[n]=q[n]+256}}return q},generateKey:function(){return Hex.randomString().toUpperCase()}};(function(a){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=a()}else{if(typeof define==="function"&&define.amd){define([],a)}else{var b;if(typeof window!=="undefined"){b=window}else{if(typeof global!=="undefined"){b=global}else{if(typeof self!=="undefined"){b=self}else{b=this}}}b.Base64=a()}}})(function(){var c,a,b;return function c(j,e,f){function d(p,n){if(!e[p]){if(!j[p]){var o=typeof require=="function"&&require;if(!n&&o){return o(p,!0)}if(g){return g(p,!0)}var i=new Error("Cannot find module '"+p+"'");throw i.code="MODULE_NOT_FOUND",i}var m=e[p]={exports:{}};j[p][0].call(m.exports,function(k){var l=j[p][1][k];return d(l?l:k)},m,m.exports,c,j,e,f)}return e[p].exports}var g=typeof require=="function"&&require;for(var h=0;h<f.length;h++){d(f[h])}return d}({"/":[function(B,w,q){q.byteLength=z;q.toByteArray=k;q.fromByteArray=x;var e=[];var d=[];var A=typeof Uint8Array!=="undefined"?Uint8Array:Array;var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var g=0,m=j.length;g<m;++g){e[g]=j[g];d[j.charCodeAt(g)]=g}d["-".charCodeAt(0)]=62;d["_".charCodeAt(0)]=63;function y(h){var i=h.length;if(i%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return h[i-2]==="="?2:h[i-1]==="="?1:0}function z(h){return h.length*3/4-y(h)}function k(i){var h,r,t,n,l;var s=i.length;n=y(i);l=new A(s*3/4-n);r=n>0?s-4:s;var o=0;for(h=0;h<r;h+=4){t=d[i.charCodeAt(h)]<<18|d[i.charCodeAt(h+1)]<<12|d[i.charCodeAt(h+2)]<<6|d[i.charCodeAt(h+3)];l[o++]=t>>16&255;l[o++]=t>>8&255;l[o++]=t&255}if(n===2){t=d[i.charCodeAt(h)]<<2|d[i.charCodeAt(h+1)]>>4;l[o++]=t&255}else{if(n===1){t=d[i.charCodeAt(h)]<<10|d[i.charCodeAt(h+1)]<<4|d[i.charCodeAt(h+2)]>>2;l[o++]=t>>8&255;l[o++]=t&255}}return l}function f(h){return e[h>>18&63]+e[h>>12&63]+e[h>>6&63]+e[h&63]}function p(r,n,o){var l;var h=[];for(var i=n;i<o;i+=3){l=(r[i]<<16)+(r[i+1]<<8)+r[i+2];h.push(f(l))}return h.join("")}function x(n){var h;var l=n.length;var o=l%3;var s="";var r=[];var u=16383;for(var i=0,t=l-o;i<t;i+=u){r.push(p(n,i,i+u>t?t:i+u))}if(o===1){h=n[l-1];s+=e[h>>2];s+=e[h<<4&63];s+="=="}else{if(o===2){h=(n[l-2]<<8)+n[l-1];s+=e[h>>10];s+=e[h>>4&63];s+=e[h<<2&63];s+="="}}r.push(s);return r.join("")}},{}]},{},[])("/")});function arrayCopy(d,c,f,b,e){var a=e;if(c+e>d.length&&b+e<=f.length){a=d.length-c}else{if(b+e>f.length&&c+e<=d.length){a=f.length-b}else{if(c+e<=d.length&&b+e<=f.length){a=e}else{if(f.length<d.length){a=f.length-b}else{a=d.length-b}}}}for(var g=0;g<a;g++){f[g+b]=d[g+c]}}function longToByte(a){return new Array(0,0,0,0,(a>>24)&255,(a>>16)&255,(a>>8)&255,(a)&255)}function intToByte(a){return new Array((a>>24)&255,(a>>16)&255,(a>>8)&255,(a)&255)}function intArrayToByteArray(d){var a=new Array(d.length*4);for(var c=0;c<d.length;c++){arrayCopy(intToByte(d[c]),0,a,c*4,4)}return a}function byteToInt(a,c){if(c+3<a.length){return((a[c])<<24)|((a[c+1])<<16)|((a[c+2])<<8)|((a[c+3]))}else{if(c+2<a.length){return((a[c+1])<<16)|((a[c+2])<<8)|((a[c+3]))}else{if(c+1<a.length){return((a[c])<<8)|((a[c+1]))}else{return((a[c]))}}}}function byteArrayToIntArray(a){var c=Math.ceil(a.length/4);var d=new Array(c);for(var e=0;e<a.length;e++){a[e]=a[e]&255}for(var e=0;e<d.length;e++){d[e]=byteToInt(a,e*4)}return d}function Hex(){}Hex.encode=function(h,g,c){g=g||0;c=c||h.length;var a=new Array(c*2);var f=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");for(var e=g,d=0;e<c+g;e++,d++){a[d]=f[(h[e]&255)>>4];a[++d]=f[(h[e]&15)]}return a.join("")};Hex.decode=function(b){if(b==null||b==""){return null}if(b.length%2!=0){return null}var c=b.length/2;var d=this.toCharCodeArray(b);var a=new Array(c);for(var e=0;e<c;e++){if(d[2*e]>=48&&d[2*e]<=57){a[e]=((d[2*e]-48)<<4)}else{if(d[2*e]>=65&&d[2*e]<=70){a[e]=((d[2*e]-65+10)<<4)}else{if(d[2*e]>=97&&d[2*e]<=102){a[e]=((d[2*e]-97+10)<<4)}else{return null}}}if(d[2*e+1]>=48&&d[2*e+1]<=57){a[e]=(a[e]|(d[2*e+1]-48))}else{if(d[2*e+1]>=65&&d[2*e+1]<=70){a[e]=(a[e]|(d[2*e+1]-65+10))}else{if(d[2*e+1]>=97&&d[2*e+1]<=102){a[e]=(a[e]|(d[2*e+1]-97+10))}else{return null}}}}return a};Hex.utf8StrToHex=function(a){var b=encodeURIComponent(a);var d=unescape(b);var f=d.length;var c=[];for(var e=0;e<f;e++){c[e]=(d.charCodeAt(e).toString(16))}return c.join("")};Hex.randomString=function(e){e=e||32;var a="0123456789ABCDEFabcdef";var d=a.length;var c="";for(var b=0;b<e;b++){c+=a.charAt(Math.floor(Math.random()*d))}return c},Hex.utf8StrToBytes=function(a){var b=encodeURIComponent(a);var d=unescape(b);var f=d.length;var c=[];for(var e=0;e<f;e++){c[e]=d.charCodeAt(e)}return c};Hex.hexToUtf8Str=function(b){var d=Hex.decode(b);var c=[];for(var a=0;a<d.length;a++){c.push(String.fromCharCode(d[a]))}return decodeURIComponent(escape(c.join("")))};Hex.bytesToUtf8Str=function(b){var d=b;var c=[];for(var a=0;a<d.length;a++){c.push(String.fromCharCode(d[a]))}return decodeURIComponent(escape(c.join("")))};Hex.toCharCodeArray=function(a){var b=new Array(a.length);for(var c=0;c<a.length;c++){b[c]=a.charCodeAt(c)}return b};function SoftEncryption(){}SoftEncryption.getKg4=function(){return new SM4().generateKey()};SoftEncryption.encryptBySM4=function(b,a){var d=new SM4();var c=d.encrypt_ecb(a,b);return c};SoftEncryption.loginSM4Encry=function(e,d,f){var e=Hex.utf8StrToBytes(e);var d=Hex.utf8StrToBytes(d);var g=SoftEncryption.encryptBySM4(e,Hex.decode(f));var c=Base64.fromByteArray(g);var b=SoftEncryption.encryptBySM4(d,Hex.decode(f));var a=Base64.fromByteArray(b);return{username:c,password:a}};SoftEncryption.loginSM2Encry=function(m,k,c){var o=SoftEncryption.getKg4();var m=Hex.utf8StrToBytes(m);var k=Hex.utf8StrToBytes(k);var b=Base64.toByteArray(c);var g=SoftEncryption.encryptBySM4(m,Hex.decode(o));var l=Base64.fromByteArray(g);var h=SoftEncryption.encryptBySM4(k,Hex.decode(o));var e=Base64.fromByteArray(h);var n=new SM2();var f=n.encrypt(b,Hex.decode(o));var j=Hex.encode(f);var a=Base64.fromByteArray(Hex.decode(j));var d=Hex.utf8StrToBytes(a+l+e);var i=new SM3Digest();i.update(d,0,d.length);var q=i.doFinal();var p=Base64.fromByteArray(q);return{kg4:a,username:l,password:e,sign:p}};